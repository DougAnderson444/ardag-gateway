var S1=Object.create,Ps=Object.defineProperty,A1=Object.getOwnPropertyDescriptor,T1=Object.getOwnPropertyNames,C1=Object.getPrototypeOf,I1=Object.prototype.hasOwnProperty,$=(e,t)=>()=>(e&&(t=e(e=0)),t),b=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),H=(e,t)=>{for(var r in t)Ps(e,r,{get:t[r],enumerable:!0})},Od=(e,t,r,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of T1(t))!I1.call(e,i)&&i!==r&&Ps(e,i,{get:()=>t[i],enumerable:!(n=A1(t,i))||n.enumerable});return e},x=(e,t,r)=>(r=e!=null?S1(C1(e)):{},Od(t||!e||!e.__esModule?Ps(r,"default",{value:e,enumerable:!0}):r,e)),Oe=e=>Od(Ps({},"__esModule",{value:!0}),e),Ld=b(e=>{a(),e.byteLength=c,e.toByteArray=y,e.fromByteArray=d;var t=[],r=[],n=typeof Uint8Array<"u"?Uint8Array:Array,i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(o=0,u=i.length;o<u;++o)t[o]=i[o],r[i.charCodeAt(o)]=o;var o,u;r["-".charCodeAt(0)]=62,r["_".charCodeAt(0)]=63;function s(k){var g=k.length;if(g%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var m=k.indexOf("=");m===-1&&(m=g);var B=m===g?0:4-m%4;return[m,B]}function c(k){var g=s(k),m=g[0],B=g[1];return(m+B)*3/4-B}function h(k,g,m){return(g+m)*3/4-m}function y(k){var g,m=s(k),B=m[0],O=m[1],V=new n(h(k,B,O)),le=0,_e=O>0?B-4:B,P;for(P=0;P<_e;P+=4)g=r[k.charCodeAt(P)]<<18|r[k.charCodeAt(P+1)]<<12|r[k.charCodeAt(P+2)]<<6|r[k.charCodeAt(P+3)],V[le++]=g>>16&255,V[le++]=g>>8&255,V[le++]=g&255;return O===2&&(g=r[k.charCodeAt(P)]<<2|r[k.charCodeAt(P+1)]>>4,V[le++]=g&255),O===1&&(g=r[k.charCodeAt(P)]<<10|r[k.charCodeAt(P+1)]<<4|r[k.charCodeAt(P+2)]>>2,V[le++]=g>>8&255,V[le++]=g&255),V}function w(k){return t[k>>18&63]+t[k>>12&63]+t[k>>6&63]+t[k&63]}function S(k,g,m){for(var B,O=[],V=g;V<m;V+=3)B=(k[V]<<16&16711680)+(k[V+1]<<8&65280)+(k[V+2]&255),O.push(w(B));return O.join("")}function d(k){for(var g,m=k.length,B=m%3,O=[],V=16383,le=0,_e=m-B;le<_e;le+=V)O.push(S(k,le,le+V>_e?_e:le+V));return B===1?(g=k[m-1],O.push(t[g>>2]+t[g<<4&63]+"==")):B===2&&(g=(k[m-2]<<8)+k[m-1],O.push(t[g>>10]+t[g>>4&63]+t[g<<2&63]+"=")),O.join("")}}),Rd=b(e=>{a(),e.read=function(t,r,n,i,o){var u,s,c=o*8-i-1,h=(1<<c)-1,y=h>>1,w=-7,S=n?o-1:0,d=n?-1:1,k=t[r+S];for(S+=d,u=k&(1<<-w)-1,k>>=-w,w+=c;w>0;u=u*256+t[r+S],S+=d,w-=8);for(s=u&(1<<-w)-1,u>>=-w,w+=i;w>0;s=s*256+t[r+S],S+=d,w-=8);if(u===0)u=1-y;else{if(u===h)return s?NaN:(k?-1:1)*(1/0);s=s+Math.pow(2,i),u=u-y}return(k?-1:1)*s*Math.pow(2,u-i)},e.write=function(t,r,n,i,o,u){var s,c,h,y=u*8-o-1,w=(1<<y)-1,S=w>>1,d=o===23?Math.pow(2,-24)-Math.pow(2,-77):0,k=i?0:u-1,g=i?1:-1,m=r<0||r===0&&1/r<0?1:0;for(r=Math.abs(r),isNaN(r)||r===1/0?(c=isNaN(r)?1:0,s=w):(s=Math.floor(Math.log(r)/Math.LN2),r*(h=Math.pow(2,-s))<1&&(s--,h*=2),s+S>=1?r+=d/h:r+=d*Math.pow(2,1-S),r*h>=2&&(s++,h/=2),s+S>=w?(c=0,s=w):s+S>=1?(c=(r*h-1)*Math.pow(2,o),s=s+S):(c=r*Math.pow(2,S-1)*Math.pow(2,o),s=0));o>=8;t[n+k]=c&255,k+=g,c/=256,o-=8);for(s=s<<o|c,y+=o;y>0;t[n+k]=s&255,k+=g,s/=256,y-=8);t[n+k-g]|=m*128}}),co=b(e=>{a();var t=Ld(),r=Rd(),n=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;e.Buffer=s,e.SlowBuffer=O,e.INSPECT_MAX_BYTES=50;var i=2147483647;e.kMaxLength=i,s.TYPED_ARRAY_SUPPORT=o(),!s.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function o(){try{let l=new Uint8Array(1),f={foo:function(){return 42}};return Object.setPrototypeOf(f,Uint8Array.prototype),Object.setPrototypeOf(l,f),l.foo()===42}catch{return!1}}Object.defineProperty(s.prototype,"parent",{enumerable:!0,get:function(){if(s.isBuffer(this))return this.buffer}}),Object.defineProperty(s.prototype,"offset",{enumerable:!0,get:function(){if(s.isBuffer(this))return this.byteOffset}});function u(l){if(l>i)throw new RangeError('The value "'+l+'" is invalid for option "size"');let f=new Uint8Array(l);return Object.setPrototypeOf(f,s.prototype),f}function s(l,f,T){if(typeof l=="number"){if(typeof f=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return w(l)}return c(l,f,T)}s.poolSize=8192;function c(l,f,T){if(typeof l=="string")return S(l,f);if(ArrayBuffer.isView(l))return k(l);if(l==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof l);if(vt(l,ArrayBuffer)||l&&vt(l.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(vt(l,SharedArrayBuffer)||l&&vt(l.buffer,SharedArrayBuffer)))return g(l,f,T);if(typeof l=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');let ne=l.valueOf&&l.valueOf();if(ne!=null&&ne!==l)return s.from(ne,f,T);let de=m(l);if(de)return de;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof l[Symbol.toPrimitive]=="function")return s.from(l[Symbol.toPrimitive]("string"),f,T);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof l)}s.from=function(l,f,T){return c(l,f,T)},Object.setPrototypeOf(s.prototype,Uint8Array.prototype),Object.setPrototypeOf(s,Uint8Array);function h(l){if(typeof l!="number")throw new TypeError('"size" argument must be of type number');if(l<0)throw new RangeError('The value "'+l+'" is invalid for option "size"')}function y(l,f,T){return h(l),l<=0?u(l):f!==void 0?typeof T=="string"?u(l).fill(f,T):u(l).fill(f):u(l)}s.alloc=function(l,f,T){return y(l,f,T)};function w(l){return h(l),u(l<0?0:B(l)|0)}s.allocUnsafe=function(l){return w(l)},s.allocUnsafeSlow=function(l){return w(l)};function S(l,f){if((typeof f!="string"||f==="")&&(f="utf8"),!s.isEncoding(f))throw new TypeError("Unknown encoding: "+f);let T=V(l,f)|0,ne=u(T),de=ne.write(l,f);return de!==T&&(ne=ne.slice(0,de)),ne}function d(l){let f=l.length<0?0:B(l.length)|0,T=u(f);for(let ne=0;ne<f;ne+=1)T[ne]=l[ne]&255;return T}function k(l){if(vt(l,Uint8Array)){let f=new Uint8Array(l);return g(f.buffer,f.byteOffset,f.byteLength)}return d(l)}function g(l,f,T){if(f<0||l.byteLength<f)throw new RangeError('"offset" is outside of buffer bounds');if(l.byteLength<f+(T||0))throw new RangeError('"length" is outside of buffer bounds');let ne;return f===void 0&&T===void 0?ne=new Uint8Array(l):T===void 0?ne=new Uint8Array(l,f):ne=new Uint8Array(l,f,T),Object.setPrototypeOf(ne,s.prototype),ne}function m(l){if(s.isBuffer(l)){let f=B(l.length)|0,T=u(f);return T.length===0||l.copy(T,0,0,f),T}if(l.length!==void 0)return typeof l.length!="number"||Pt(l.length)?u(0):d(l);if(l.type==="Buffer"&&Array.isArray(l.data))return d(l.data)}function B(l){if(l>=i)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+i.toString(16)+" bytes");return l|0}function O(l){return+l!=l&&(l=0),s.alloc(+l)}s.isBuffer=function(l){return l!=null&&l._isBuffer===!0&&l!==s.prototype},s.compare=function(l,f){if(vt(l,Uint8Array)&&(l=s.from(l,l.offset,l.byteLength)),vt(f,Uint8Array)&&(f=s.from(f,f.offset,f.byteLength)),!s.isBuffer(l)||!s.isBuffer(f))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(l===f)return 0;let T=l.length,ne=f.length;for(let de=0,me=Math.min(T,ne);de<me;++de)if(l[de]!==f[de]){T=l[de],ne=f[de];break}return T<ne?-1:ne<T?1:0},s.isEncoding=function(l){switch(String(l).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},s.concat=function(l,f){if(!Array.isArray(l))throw new TypeError('"list" argument must be an Array of Buffers');if(l.length===0)return s.alloc(0);let T;if(f===void 0)for(f=0,T=0;T<l.length;++T)f+=l[T].length;let ne=s.allocUnsafe(f),de=0;for(T=0;T<l.length;++T){let me=l[T];if(vt(me,Uint8Array))de+me.length>ne.length?(s.isBuffer(me)||(me=s.from(me)),me.copy(ne,de)):Uint8Array.prototype.set.call(ne,me,de);else if(s.isBuffer(me))me.copy(ne,de);else throw new TypeError('"list" argument must be an Array of Buffers');de+=me.length}return ne};function V(l,f){if(s.isBuffer(l))return l.length;if(ArrayBuffer.isView(l)||vt(l,ArrayBuffer))return l.byteLength;if(typeof l!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof l);let T=l.length,ne=arguments.length>2&&arguments[2]===!0;if(!ne&&T===0)return 0;let de=!1;for(;;)switch(f){case"ascii":case"latin1":case"binary":return T;case"utf8":case"utf-8":return jt(l).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return T*2;case"hex":return T>>>1;case"base64":return Ut(l).length;default:if(de)return ne?-1:jt(l).length;f=(""+f).toLowerCase(),de=!0}}s.byteLength=V;function le(l,f,T){let ne=!1;if((f===void 0||f<0)&&(f=0),f>this.length||((T===void 0||T>this.length)&&(T=this.length),T<=0)||(T>>>=0,f>>>=0,T<=f))return"";for(l||(l="utf8");;)switch(l){case"hex":return ce(this,f,T);case"utf8":case"utf-8":return pt(this,f,T);case"ascii":return Te(this,f,T);case"latin1":case"binary":return U(this,f,T);case"base64":return Ve(this,f,T);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ae(this,f,T);default:if(ne)throw new TypeError("Unknown encoding: "+l);l=(l+"").toLowerCase(),ne=!0}}s.prototype._isBuffer=!0;function _e(l,f,T){let ne=l[f];l[f]=l[T],l[T]=ne}s.prototype.swap16=function(){let l=this.length;if(l%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let f=0;f<l;f+=2)_e(this,f,f+1);return this},s.prototype.swap32=function(){let l=this.length;if(l%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let f=0;f<l;f+=4)_e(this,f,f+3),_e(this,f+1,f+2);return this},s.prototype.swap64=function(){let l=this.length;if(l%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let f=0;f<l;f+=8)_e(this,f,f+7),_e(this,f+1,f+6),_e(this,f+2,f+5),_e(this,f+3,f+4);return this},s.prototype.toString=function(){let l=this.length;return l===0?"":arguments.length===0?pt(this,0,l):le.apply(this,arguments)},s.prototype.toLocaleString=s.prototype.toString,s.prototype.equals=function(l){if(!s.isBuffer(l))throw new TypeError("Argument must be a Buffer");return this===l?!0:s.compare(this,l)===0},s.prototype.inspect=function(){let l="",f=e.INSPECT_MAX_BYTES;return l=this.toString("hex",0,f).replace(/(.{2})/g,"$1 ").trim(),this.length>f&&(l+=" ... "),"<Buffer "+l+">"},n&&(s.prototype[n]=s.prototype.inspect),s.prototype.compare=function(l,f,T,ne,de){if(vt(l,Uint8Array)&&(l=s.from(l,l.offset,l.byteLength)),!s.isBuffer(l))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof l);if(f===void 0&&(f=0),T===void 0&&(T=l?l.length:0),ne===void 0&&(ne=0),de===void 0&&(de=this.length),f<0||T>l.length||ne<0||de>this.length)throw new RangeError("out of range index");if(ne>=de&&f>=T)return 0;if(ne>=de)return-1;if(f>=T)return 1;if(f>>>=0,T>>>=0,ne>>>=0,de>>>=0,this===l)return 0;let me=de-ne,Be=T-f,Qe=Math.min(me,Be),dt=this.slice(ne,de),Ze=l.slice(f,T);for(let Ye=0;Ye<Qe;++Ye)if(dt[Ye]!==Ze[Ye]){me=dt[Ye],Be=Ze[Ye];break}return me<Be?-1:Be<me?1:0};function P(l,f,T,ne,de){if(l.length===0)return-1;if(typeof T=="string"?(ne=T,T=0):T>2147483647?T=2147483647:T<-2147483648&&(T=-2147483648),T=+T,Pt(T)&&(T=de?0:l.length-1),T<0&&(T=l.length+T),T>=l.length){if(de)return-1;T=l.length-1}else if(T<0)if(de)T=0;else return-1;if(typeof f=="string"&&(f=s.from(f,ne)),s.isBuffer(f))return f.length===0?-1:re(l,f,T,ne,de);if(typeof f=="number")return f=f&255,typeof Uint8Array.prototype.indexOf=="function"?de?Uint8Array.prototype.indexOf.call(l,f,T):Uint8Array.prototype.lastIndexOf.call(l,f,T):re(l,[f],T,ne,de);throw new TypeError("val must be string, number or Buffer")}function re(l,f,T,ne,de){let me=1,Be=l.length,Qe=f.length;if(ne!==void 0&&(ne=String(ne).toLowerCase(),ne==="ucs2"||ne==="ucs-2"||ne==="utf16le"||ne==="utf-16le")){if(l.length<2||f.length<2)return-1;me=2,Be/=2,Qe/=2,T/=2}function dt(Ye,ut){return me===1?Ye[ut]:Ye.readUInt16BE(ut*me)}let Ze;if(de){let Ye=-1;for(Ze=T;Ze<Be;Ze++)if(dt(l,Ze)===dt(f,Ye===-1?0:Ze-Ye)){if(Ye===-1&&(Ye=Ze),Ze-Ye+1===Qe)return Ye*me}else Ye!==-1&&(Ze-=Ze-Ye),Ye=-1}else for(T+Qe>Be&&(T=Be-Qe),Ze=T;Ze>=0;Ze--){let Ye=!0;for(let ut=0;ut<Qe;ut++)if(dt(l,Ze+ut)!==dt(f,ut)){Ye=!1;break}if(Ye)return Ze}return-1}s.prototype.includes=function(l,f,T){return this.indexOf(l,f,T)!==-1},s.prototype.indexOf=function(l,f,T){return P(this,l,f,T,!0)},s.prototype.lastIndexOf=function(l,f,T){return P(this,l,f,T,!1)};function R(l,f,T,ne){T=Number(T)||0;let de=l.length-T;ne?(ne=Number(ne),ne>de&&(ne=de)):ne=de;let me=f.length;ne>me/2&&(ne=me/2);let Be;for(Be=0;Be<ne;++Be){let Qe=parseInt(f.substr(Be*2,2),16);if(Pt(Qe))return Be;l[T+Be]=Qe}return Be}function ie(l,f,T,ne){return Nt(jt(f,l.length-T),l,T,ne)}function Se(l,f,T,ne){return Nt(Jt(f),l,T,ne)}function Ne(l,f,T,ne){return Nt(Ut(f),l,T,ne)}function De(l,f,T,ne){return Nt(Gt(f,l.length-T),l,T,ne)}s.prototype.write=function(l,f,T,ne){if(f===void 0)ne="utf8",T=this.length,f=0;else if(T===void 0&&typeof f=="string")ne=f,T=this.length,f=0;else if(isFinite(f))f=f>>>0,isFinite(T)?(T=T>>>0,ne===void 0&&(ne="utf8")):(ne=T,T=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");let de=this.length-f;if((T===void 0||T>de)&&(T=de),l.length>0&&(T<0||f<0)||f>this.length)throw new RangeError("Attempt to write outside buffer bounds");ne||(ne="utf8");let me=!1;for(;;)switch(ne){case"hex":return R(this,l,f,T);case"utf8":case"utf-8":return ie(this,l,f,T);case"ascii":case"latin1":case"binary":return Se(this,l,f,T);case"base64":return Ne(this,l,f,T);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return De(this,l,f,T);default:if(me)throw new TypeError("Unknown encoding: "+ne);ne=(""+ne).toLowerCase(),me=!0}},s.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function Ve(l,f,T){return f===0&&T===l.length?t.fromByteArray(l):t.fromByteArray(l.slice(f,T))}function pt(l,f,T){T=Math.min(l.length,T);let ne=[],de=f;for(;de<T;){let me=l[de],Be=null,Qe=me>239?4:me>223?3:me>191?2:1;if(de+Qe<=T){let dt,Ze,Ye,ut;switch(Qe){case 1:me<128&&(Be=me);break;case 2:dt=l[de+1],(dt&192)===128&&(ut=(me&31)<<6|dt&63,ut>127&&(Be=ut));break;case 3:dt=l[de+1],Ze=l[de+2],(dt&192)===128&&(Ze&192)===128&&(ut=(me&15)<<12|(dt&63)<<6|Ze&63,ut>2047&&(ut<55296||ut>57343)&&(Be=ut));break;case 4:dt=l[de+1],Ze=l[de+2],Ye=l[de+3],(dt&192)===128&&(Ze&192)===128&&(Ye&192)===128&&(ut=(me&15)<<18|(dt&63)<<12|(Ze&63)<<6|Ye&63,ut>65535&&ut<1114112&&(Be=ut))}}Be===null?(Be=65533,Qe=1):Be>65535&&(Be-=65536,ne.push(Be>>>10&1023|55296),Be=56320|Be&1023),ne.push(Be),de+=Qe}return lt(ne)}var gt=4096;function lt(l){let f=l.length;if(f<=gt)return String.fromCharCode.apply(String,l);let T="",ne=0;for(;ne<f;)T+=String.fromCharCode.apply(String,l.slice(ne,ne+=gt));return T}function Te(l,f,T){let ne="";T=Math.min(l.length,T);for(let de=f;de<T;++de)ne+=String.fromCharCode(l[de]&127);return ne}function U(l,f,T){let ne="";T=Math.min(l.length,T);for(let de=f;de<T;++de)ne+=String.fromCharCode(l[de]);return ne}function ce(l,f,T){let ne=l.length;(!f||f<0)&&(f=0),(!T||T<0||T>ne)&&(T=ne);let de="";for(let me=f;me<T;++me)de+=Yt[l[me]];return de}function ae(l,f,T){let ne=l.slice(f,T),de="";for(let me=0;me<ne.length-1;me+=2)de+=String.fromCharCode(ne[me]+ne[me+1]*256);return de}s.prototype.slice=function(l,f){let T=this.length;l=~~l,f=f===void 0?T:~~f,l<0?(l+=T,l<0&&(l=0)):l>T&&(l=T),f<0?(f+=T,f<0&&(f=0)):f>T&&(f=T),f<l&&(f=l);let ne=this.subarray(l,f);return Object.setPrototypeOf(ne,s.prototype),ne};function Ie(l,f,T){if(l%1!==0||l<0)throw new RangeError("offset is not uint");if(l+f>T)throw new RangeError("Trying to access beyond buffer length")}s.prototype.readUintLE=s.prototype.readUIntLE=function(l,f,T){l=l>>>0,f=f>>>0,T||Ie(l,f,this.length);let ne=this[l],de=1,me=0;for(;++me<f&&(de*=256);)ne+=this[l+me]*de;return ne},s.prototype.readUintBE=s.prototype.readUIntBE=function(l,f,T){l=l>>>0,f=f>>>0,T||Ie(l,f,this.length);let ne=this[l+--f],de=1;for(;f>0&&(de*=256);)ne+=this[l+--f]*de;return ne},s.prototype.readUint8=s.prototype.readUInt8=function(l,f){return l=l>>>0,f||Ie(l,1,this.length),this[l]},s.prototype.readUint16LE=s.prototype.readUInt16LE=function(l,f){return l=l>>>0,f||Ie(l,2,this.length),this[l]|this[l+1]<<8},s.prototype.readUint16BE=s.prototype.readUInt16BE=function(l,f){return l=l>>>0,f||Ie(l,2,this.length),this[l]<<8|this[l+1]},s.prototype.readUint32LE=s.prototype.readUInt32LE=function(l,f){return l=l>>>0,f||Ie(l,4,this.length),(this[l]|this[l+1]<<8|this[l+2]<<16)+this[l+3]*16777216},s.prototype.readUint32BE=s.prototype.readUInt32BE=function(l,f){return l=l>>>0,f||Ie(l,4,this.length),this[l]*16777216+(this[l+1]<<16|this[l+2]<<8|this[l+3])},s.prototype.readBigUInt64LE=kt(function(l){l=l>>>0,At(l,"offset");let f=this[l],T=this[l+7];(f===void 0||T===void 0)&&Bt(l,this.length-8);let ne=f+this[++l]*2**8+this[++l]*2**16+this[++l]*2**24,de=this[++l]+this[++l]*2**8+this[++l]*2**16+T*2**24;return BigInt(ne)+(BigInt(de)<<BigInt(32))}),s.prototype.readBigUInt64BE=kt(function(l){l=l>>>0,At(l,"offset");let f=this[l],T=this[l+7];(f===void 0||T===void 0)&&Bt(l,this.length-8);let ne=f*2**24+this[++l]*2**16+this[++l]*2**8+this[++l],de=this[++l]*2**24+this[++l]*2**16+this[++l]*2**8+T;return(BigInt(ne)<<BigInt(32))+BigInt(de)}),s.prototype.readIntLE=function(l,f,T){l=l>>>0,f=f>>>0,T||Ie(l,f,this.length);let ne=this[l],de=1,me=0;for(;++me<f&&(de*=256);)ne+=this[l+me]*de;return de*=128,ne>=de&&(ne-=Math.pow(2,8*f)),ne},s.prototype.readIntBE=function(l,f,T){l=l>>>0,f=f>>>0,T||Ie(l,f,this.length);let ne=f,de=1,me=this[l+--ne];for(;ne>0&&(de*=256);)me+=this[l+--ne]*de;return de*=128,me>=de&&(me-=Math.pow(2,8*f)),me},s.prototype.readInt8=function(l,f){return l=l>>>0,f||Ie(l,1,this.length),this[l]&128?(255-this[l]+1)*-1:this[l]},s.prototype.readInt16LE=function(l,f){l=l>>>0,f||Ie(l,2,this.length);let T=this[l]|this[l+1]<<8;return T&32768?T|4294901760:T},s.prototype.readInt16BE=function(l,f){l=l>>>0,f||Ie(l,2,this.length);let T=this[l+1]|this[l]<<8;return T&32768?T|4294901760:T},s.prototype.readInt32LE=function(l,f){return l=l>>>0,f||Ie(l,4,this.length),this[l]|this[l+1]<<8|this[l+2]<<16|this[l+3]<<24},s.prototype.readInt32BE=function(l,f){return l=l>>>0,f||Ie(l,4,this.length),this[l]<<24|this[l+1]<<16|this[l+2]<<8|this[l+3]},s.prototype.readBigInt64LE=kt(function(l){l=l>>>0,At(l,"offset");let f=this[l],T=this[l+7];(f===void 0||T===void 0)&&Bt(l,this.length-8);let ne=this[l+4]+this[l+5]*2**8+this[l+6]*2**16+(T<<24);return(BigInt(ne)<<BigInt(32))+BigInt(f+this[++l]*2**8+this[++l]*2**16+this[++l]*2**24)}),s.prototype.readBigInt64BE=kt(function(l){l=l>>>0,At(l,"offset");let f=this[l],T=this[l+7];(f===void 0||T===void 0)&&Bt(l,this.length-8);let ne=(f<<24)+this[++l]*2**16+this[++l]*2**8+this[++l];return(BigInt(ne)<<BigInt(32))+BigInt(this[++l]*2**24+this[++l]*2**16+this[++l]*2**8+T)}),s.prototype.readFloatLE=function(l,f){return l=l>>>0,f||Ie(l,4,this.length),r.read(this,l,!0,23,4)},s.prototype.readFloatBE=function(l,f){return l=l>>>0,f||Ie(l,4,this.length),r.read(this,l,!1,23,4)},s.prototype.readDoubleLE=function(l,f){return l=l>>>0,f||Ie(l,8,this.length),r.read(this,l,!0,52,8)},s.prototype.readDoubleBE=function(l,f){return l=l>>>0,f||Ie(l,8,this.length),r.read(this,l,!1,52,8)};function Re(l,f,T,ne,de,me){if(!s.isBuffer(l))throw new TypeError('"buffer" argument must be a Buffer instance');if(f>de||f<me)throw new RangeError('"value" argument is out of bounds');if(T+ne>l.length)throw new RangeError("Index out of range")}s.prototype.writeUintLE=s.prototype.writeUIntLE=function(l,f,T,ne){if(l=+l,f=f>>>0,T=T>>>0,!ne){let Be=Math.pow(2,8*T)-1;Re(this,l,f,T,Be,0)}let de=1,me=0;for(this[f]=l&255;++me<T&&(de*=256);)this[f+me]=l/de&255;return f+T},s.prototype.writeUintBE=s.prototype.writeUIntBE=function(l,f,T,ne){if(l=+l,f=f>>>0,T=T>>>0,!ne){let Be=Math.pow(2,8*T)-1;Re(this,l,f,T,Be,0)}let de=T-1,me=1;for(this[f+de]=l&255;--de>=0&&(me*=256);)this[f+de]=l/me&255;return f+T},s.prototype.writeUint8=s.prototype.writeUInt8=function(l,f,T){return l=+l,f=f>>>0,T||Re(this,l,f,1,255,0),this[f]=l&255,f+1},s.prototype.writeUint16LE=s.prototype.writeUInt16LE=function(l,f,T){return l=+l,f=f>>>0,T||Re(this,l,f,2,65535,0),this[f]=l&255,this[f+1]=l>>>8,f+2},s.prototype.writeUint16BE=s.prototype.writeUInt16BE=function(l,f,T){return l=+l,f=f>>>0,T||Re(this,l,f,2,65535,0),this[f]=l>>>8,this[f+1]=l&255,f+2},s.prototype.writeUint32LE=s.prototype.writeUInt32LE=function(l,f,T){return l=+l,f=f>>>0,T||Re(this,l,f,4,4294967295,0),this[f+3]=l>>>24,this[f+2]=l>>>16,this[f+1]=l>>>8,this[f]=l&255,f+4},s.prototype.writeUint32BE=s.prototype.writeUInt32BE=function(l,f,T){return l=+l,f=f>>>0,T||Re(this,l,f,4,4294967295,0),this[f]=l>>>24,this[f+1]=l>>>16,this[f+2]=l>>>8,this[f+3]=l&255,f+4};function Ue(l,f,T,ne,de){Lt(f,ne,de,l,T,7);let me=Number(f&BigInt(4294967295));l[T++]=me,me=me>>8,l[T++]=me,me=me>>8,l[T++]=me,me=me>>8,l[T++]=me;let Be=Number(f>>BigInt(32)&BigInt(4294967295));return l[T++]=Be,Be=Be>>8,l[T++]=Be,Be=Be>>8,l[T++]=Be,Be=Be>>8,l[T++]=Be,T}function Je(l,f,T,ne,de){Lt(f,ne,de,l,T,7);let me=Number(f&BigInt(4294967295));l[T+7]=me,me=me>>8,l[T+6]=me,me=me>>8,l[T+5]=me,me=me>>8,l[T+4]=me;let Be=Number(f>>BigInt(32)&BigInt(4294967295));return l[T+3]=Be,Be=Be>>8,l[T+2]=Be,Be=Be>>8,l[T+1]=Be,Be=Be>>8,l[T]=Be,T+8}s.prototype.writeBigUInt64LE=kt(function(l,f=0){return Ue(this,l,f,BigInt(0),BigInt("0xffffffffffffffff"))}),s.prototype.writeBigUInt64BE=kt(function(l,f=0){return Je(this,l,f,BigInt(0),BigInt("0xffffffffffffffff"))}),s.prototype.writeIntLE=function(l,f,T,ne){if(l=+l,f=f>>>0,!ne){let Qe=Math.pow(2,8*T-1);Re(this,l,f,T,Qe-1,-Qe)}let de=0,me=1,Be=0;for(this[f]=l&255;++de<T&&(me*=256);)l<0&&Be===0&&this[f+de-1]!==0&&(Be=1),this[f+de]=(l/me>>0)-Be&255;return f+T},s.prototype.writeIntBE=function(l,f,T,ne){if(l=+l,f=f>>>0,!ne){let Qe=Math.pow(2,8*T-1);Re(this,l,f,T,Qe-1,-Qe)}let de=T-1,me=1,Be=0;for(this[f+de]=l&255;--de>=0&&(me*=256);)l<0&&Be===0&&this[f+de+1]!==0&&(Be=1),this[f+de]=(l/me>>0)-Be&255;return f+T},s.prototype.writeInt8=function(l,f,T){return l=+l,f=f>>>0,T||Re(this,l,f,1,127,-128),l<0&&(l=255+l+1),this[f]=l&255,f+1},s.prototype.writeInt16LE=function(l,f,T){return l=+l,f=f>>>0,T||Re(this,l,f,2,32767,-32768),this[f]=l&255,this[f+1]=l>>>8,f+2},s.prototype.writeInt16BE=function(l,f,T){return l=+l,f=f>>>0,T||Re(this,l,f,2,32767,-32768),this[f]=l>>>8,this[f+1]=l&255,f+2},s.prototype.writeInt32LE=function(l,f,T){return l=+l,f=f>>>0,T||Re(this,l,f,4,2147483647,-2147483648),this[f]=l&255,this[f+1]=l>>>8,this[f+2]=l>>>16,this[f+3]=l>>>24,f+4},s.prototype.writeInt32BE=function(l,f,T){return l=+l,f=f>>>0,T||Re(this,l,f,4,2147483647,-2147483648),l<0&&(l=4294967295+l+1),this[f]=l>>>24,this[f+1]=l>>>16,this[f+2]=l>>>8,this[f+3]=l&255,f+4},s.prototype.writeBigInt64LE=kt(function(l,f=0){return Ue(this,l,f,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),s.prototype.writeBigInt64BE=kt(function(l,f=0){return Je(this,l,f,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function Xe(l,f,T,ne,de,me){if(T+ne>l.length)throw new RangeError("Index out of range");if(T<0)throw new RangeError("Index out of range")}function $e(l,f,T,ne,de){return f=+f,T=T>>>0,de||Xe(l,f,T,4),r.write(l,f,T,ne,23,4),T+4}s.prototype.writeFloatLE=function(l,f,T){return $e(this,l,f,!0,T)},s.prototype.writeFloatBE=function(l,f,T){return $e(this,l,f,!1,T)};function et(l,f,T,ne,de){return f=+f,T=T>>>0,de||Xe(l,f,T,8),r.write(l,f,T,ne,52,8),T+8}s.prototype.writeDoubleLE=function(l,f,T){return et(this,l,f,!0,T)},s.prototype.writeDoubleBE=function(l,f,T){return et(this,l,f,!1,T)},s.prototype.copy=function(l,f,T,ne){if(!s.isBuffer(l))throw new TypeError("argument should be a Buffer");if(T||(T=0),!ne&&ne!==0&&(ne=this.length),f>=l.length&&(f=l.length),f||(f=0),ne>0&&ne<T&&(ne=T),ne===T||l.length===0||this.length===0)return 0;if(f<0)throw new RangeError("targetStart out of bounds");if(T<0||T>=this.length)throw new RangeError("Index out of range");if(ne<0)throw new RangeError("sourceEnd out of bounds");ne>this.length&&(ne=this.length),l.length-f<ne-T&&(ne=l.length-f+T);let de=ne-T;return this===l&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(f,T,ne):Uint8Array.prototype.set.call(l,this.subarray(T,ne),f),de},s.prototype.fill=function(l,f,T,ne){if(typeof l=="string"){if(typeof f=="string"?(ne=f,f=0,T=this.length):typeof T=="string"&&(ne=T,T=this.length),ne!==void 0&&typeof ne!="string")throw new TypeError("encoding must be a string");if(typeof ne=="string"&&!s.isEncoding(ne))throw new TypeError("Unknown encoding: "+ne);if(l.length===1){let me=l.charCodeAt(0);(ne==="utf8"&&me<128||ne==="latin1")&&(l=me)}}else typeof l=="number"?l=l&255:typeof l=="boolean"&&(l=Number(l));if(f<0||this.length<f||this.length<T)throw new RangeError("Out of range index");if(T<=f)return this;f=f>>>0,T=T===void 0?this.length:T>>>0,l||(l=0);let de;if(typeof l=="number")for(de=f;de<T;++de)this[de]=l;else{let me=s.isBuffer(l)?l:s.from(l,ne),Be=me.length;if(Be===0)throw new TypeError('The value "'+l+'" is invalid for argument "value"');for(de=0;de<T-f;++de)this[de+f]=me[de%Be]}return this};var Ge={};function _t(l,f,T){Ge[l]=class extends T{constructor(){super(),Object.defineProperty(this,"message",{value:f.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${l}]`,this.stack,delete this.name}get code(){return l}set code(ne){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:ne,writable:!0})}toString(){return`${this.name} [${l}]: ${this.message}`}}}_t("ERR_BUFFER_OUT_OF_BOUNDS",function(l){return l?`${l} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),_t("ERR_INVALID_ARG_TYPE",function(l,f){return`The "${l}" argument must be of type number. Received type ${typeof f}`},TypeError),_t("ERR_OUT_OF_RANGE",function(l,f,T){let ne=`The value of "${l}" is out of range.`,de=T;return Number.isInteger(T)&&Math.abs(T)>2**32?de=St(String(T)):typeof T=="bigint"&&(de=String(T),(T>BigInt(2)**BigInt(32)||T<-(BigInt(2)**BigInt(32)))&&(de=St(de)),de+="n"),ne+=` It must be ${f}. Received ${de}`,ne},RangeError);function St(l){let f="",T=l.length,ne=l[0]==="-"?1:0;for(;T>=ne+4;T-=3)f=`_${l.slice(T-3,T)}${f}`;return`${l.slice(0,T)}${f}`}function Ft(l,f,T){At(f,"offset"),(l[f]===void 0||l[f+T]===void 0)&&Bt(f,l.length-(T+1))}function Lt(l,f,T,ne,de,me){if(l>T||l<f){let Be=typeof f=="bigint"?"n":"",Qe;throw me>3?f===0||f===BigInt(0)?Qe=`>= 0${Be} and < 2${Be} ** ${(me+1)*8}${Be}`:Qe=`>= -(2${Be} ** ${(me+1)*8-1}${Be}) and < 2 ** ${(me+1)*8-1}${Be}`:Qe=`>= ${f}${Be} and <= ${T}${Be}`,new Ge.ERR_OUT_OF_RANGE("value",Qe,l)}Ft(ne,de,me)}function At(l,f){if(typeof l!="number")throw new Ge.ERR_INVALID_ARG_TYPE(f,"number",l)}function Bt(l,f,T){throw Math.floor(l)!==l?(At(l,T),new Ge.ERR_OUT_OF_RANGE(T||"offset","an integer",l)):f<0?new Ge.ERR_BUFFER_OUT_OF_BOUNDS:new Ge.ERR_OUT_OF_RANGE(T||"offset",`>= ${T?1:0} and <= ${f}`,l)}var zt=/[^+/0-9A-Za-z-_]/g;function Ht(l){if(l=l.split("=")[0],l=l.trim().replace(zt,""),l.length<2)return"";for(;l.length%4!==0;)l=l+"=";return l}function jt(l,f){f=f||1/0;let T,ne=l.length,de=null,me=[];for(let Be=0;Be<ne;++Be){if(T=l.charCodeAt(Be),T>55295&&T<57344){if(!de){if(T>56319){(f-=3)>-1&&me.push(239,191,189);continue}else if(Be+1===ne){(f-=3)>-1&&me.push(239,191,189);continue}de=T;continue}if(T<56320){(f-=3)>-1&&me.push(239,191,189),de=T;continue}T=(de-55296<<10|T-56320)+65536}else de&&(f-=3)>-1&&me.push(239,191,189);if(de=null,T<128){if((f-=1)<0)break;me.push(T)}else if(T<2048){if((f-=2)<0)break;me.push(T>>6|192,T&63|128)}else if(T<65536){if((f-=3)<0)break;me.push(T>>12|224,T>>6&63|128,T&63|128)}else if(T<1114112){if((f-=4)<0)break;me.push(T>>18|240,T>>12&63|128,T>>6&63|128,T&63|128)}else throw new Error("Invalid code point")}return me}function Jt(l){let f=[];for(let T=0;T<l.length;++T)f.push(l.charCodeAt(T)&255);return f}function Gt(l,f){let T,ne,de,me=[];for(let Be=0;Be<l.length&&!((f-=2)<0);++Be)T=l.charCodeAt(Be),ne=T>>8,de=T%256,me.push(de),me.push(ne);return me}function Ut(l){return t.toByteArray(Ht(l))}function Nt(l,f,T,ne){let de;for(de=0;de<ne&&!(de+T>=f.length||de>=l.length);++de)f[de+T]=l[de];return de}function vt(l,f){return l instanceof f||l!=null&&l.constructor!=null&&l.constructor.name!=null&&l.constructor.name===f.name}function Pt(l){return l!==l}var Yt=function(){let l="0123456789abcdef",f=new Array(256);for(let T=0;T<16;++T){let ne=T*16;for(let de=0;de<16;++de)f[ne+de]=l[T]+l[de]}return f}();function kt(l){return typeof BigInt>"u"?Zt:l}function Zt(){throw new Error("BigInt not supported")}}),tp=b((e,t)=>{a();var r=t.exports={},n,i;function o(){throw new Error("setTimeout has not been defined")}function u(){throw new Error("clearTimeout has not been defined")}(function(){try{typeof setTimeout=="function"?n=setTimeout:n=o}catch{n=o}try{typeof clearTimeout=="function"?i=clearTimeout:i=u}catch{i=u}})();function s(B){if(n===setTimeout)return setTimeout(B,0);if((n===o||!n)&&setTimeout)return n=setTimeout,setTimeout(B,0);try{return n(B,0)}catch{try{return n.call(null,B,0)}catch{return n.call(this,B,0)}}}function c(B){if(i===clearTimeout)return clearTimeout(B);if((i===u||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(B);try{return i(B)}catch{try{return i.call(null,B)}catch{return i.call(this,B)}}}var h=[],y=!1,w,S=-1;function d(){!y||!w||(y=!1,w.length?h=w.concat(h):S=-1,h.length&&k())}function k(){if(!y){var B=s(d);y=!0;for(var O=h.length;O;){for(w=h,h=[];++S<O;)w&&w[S].run();S=-1,O=h.length}w=null,y=!1,c(B)}}r.nextTick=function(B){var O=new Array(arguments.length-1);if(arguments.length>1)for(var V=1;V<arguments.length;V++)O[V-1]=arguments[V];h.push(new g(B,O)),h.length===1&&!y&&s(k)};function g(B,O){this.fun=B,this.array=O}g.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={};function m(){}r.on=m,r.addListener=m,r.once=m,r.off=m,r.removeListener=m,r.removeAllListeners=m,r.emit=m,r.prependListener=m,r.prependOnceListener=m,r.listeners=function(B){return[]},r.binding=function(B){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(B){throw new Error("process.chdir is not supported")},r.umask=function(){return 0}}),process,global,self,a=$(()=>{co().Buffer,process=tp(),global=typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:{},self=globalThis,globalThis&&globalThis.process&&globalThis.process.env&&(globalThis.process.env.LIBP2P_FORCE_PNET=!1)}),ip=b((e,t)=>{a(),t.exports=u;var r=128,n=127,i=~n,o=Math.pow(2,31);function u(s,c,h){if(Number.MAX_SAFE_INTEGER&&s>Number.MAX_SAFE_INTEGER)throw u.bytes=0,new RangeError("Could not encode varint");c=c||[],h=h||0;for(var y=h;s>=o;)c[h++]=s&255|r,s/=128;for(;s&i;)c[h++]=s&255|r,s>>>=7;return c[h]=s|0,u.bytes=h-y+1,c}}),ap=b((e,t)=>{a(),t.exports=i;var r=128,n=127;function i(o,c){var s=0,c=c||0,h=0,y=c,w,S=o.length;do{if(y>=S||h>49)throw i.bytes=0,new RangeError("Could not decode varint");w=o[y++],s+=h<28?(w&n)<<h:(w&n)*Math.pow(2,h),h+=7}while(w>=r);return i.bytes=y-c,s}}),up=b((e,t)=>{a();var r=Math.pow(2,7),n=Math.pow(2,14),i=Math.pow(2,21),o=Math.pow(2,28),u=Math.pow(2,35),s=Math.pow(2,42),c=Math.pow(2,49),h=Math.pow(2,56),y=Math.pow(2,63);t.exports=function(w){return w<r?1:w<n?2:w<i?3:w<o?4:w<u?5:w<s?6:w<c?7:w<h?8:w<y?9:10}}),ke=b((e,t)=>{a(),t.exports={encode:ip(),decode:ap(),encodingLength:up()}});function my(e,t,r){t=t||[],r=r||0;for(var n=r;e>=r2;)t[r++]=e&255|py,e/=128;for(;e&t2;)t[r++]=e&255|py,e>>>=7;return t[r]=e|0,my.bytes=r-n+1,t}function Pu(e,n){var r=0,n=n||0,i=0,o=n,u,s=e.length;do{if(o>=s)throw Pu.bytes=0,new RangeError("Could not decode varint");u=e[o++],r+=i<28?(u&yy)<<i:(u&yy)*Math.pow(2,i),i+=7}while(u>=i2);return Pu.bytes=o-n,r}var Zv,py,e2,t2,r2,n2,i2,yy,o2,s2,a2,c2,u2,f2,l2,h2,d2,p2,y2,m2,go,gy=$(()=>{a(),Zv=my,py=128,e2=127,t2=~e2,r2=Math.pow(2,31),n2=Pu,i2=128,yy=127,o2=Math.pow(2,7),s2=Math.pow(2,14),a2=Math.pow(2,21),c2=Math.pow(2,28),u2=Math.pow(2,35),f2=Math.pow(2,42),l2=Math.pow(2,49),h2=Math.pow(2,56),d2=Math.pow(2,63),p2=function(e){return e<o2?1:e<s2?2:e<a2?3:e<c2?4:e<u2?5:e<f2?6:e<l2?7:e<h2?8:e<d2?9:10},y2={encode:Zv,decode:n2,encodingLength:p2},m2=y2,go=m2}),wo,hi,di,Xs=$(()=>{a(),gy(),wo=(e,t=0)=>[go.decode(e,t),go.decode.bytes],hi=(e,t,r=0)=>(go.encode(e,t,r),t),di=e=>go.encodingLength(e)}),gn={};H(gn,{coerce:()=>it,empty:()=>wy,equals:()=>Fu,fromHex:()=>w2,fromString:()=>Uu,isBinary:()=>b2,toHex:()=>g2,toString:()=>$u});var wy,g2,w2,Fu,it,b2,Uu,$u,Ar=$(()=>{a(),wy=new Uint8Array(0),g2=e=>e.reduce((t,r)=>t+r.toString(16).padStart(2,"0"),""),w2=e=>{let t=e.match(/../g);return t?new Uint8Array(t.map(r=>parseInt(r,16))):wy},Fu=(e,t)=>{if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let r=0;r<e.byteLength;r++)if(e[r]!==t[r])return!1;return!0},it=e=>{if(e instanceof Uint8Array&&e.constructor.name==="Uint8Array")return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")},b2=e=>e instanceof ArrayBuffer||ArrayBuffer.isView(e),Uu=e=>new TextEncoder().encode(e),$u=e=>new TextDecoder().decode(e)}),be={};H(be,{Digest:()=>wn,create:()=>Tr,decode:()=>G,equals:()=>Mu});var Tr,G,Mu,wn,Ee=$(()=>{a(),Ar(),Xs(),Tr=(e,t)=>{let r=t.byteLength,n=di(e),i=n+di(r),o=new Uint8Array(i+r);return hi(e,o,0),hi(r,o,n),o.set(t,i),new wn(e,r,t,o)},G=e=>{let t=it(e),[r,n]=wo(t),[i,o]=wo(t.subarray(n)),u=t.subarray(n+o);if(u.byteLength!==i)throw new Error("Incorrect length");return new wn(r,i,u,t)},Mu=(e,t)=>e===t?!0:e.code===t.code&&e.size===t.size&&Fu(e.bytes,t.bytes),wn=class{constructor(e,t,r,n){this.code=e,this.size=t,this.digest=r,this.bytes=n}}});function E2(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<e.length;i++){var o=e.charAt(i),u=o.charCodeAt(0);if(r[u]!==255)throw new TypeError(o+" is ambiguous");r[u]=i}var s=e.length,c=e.charAt(0),h=Math.log(s)/Math.log(256),y=Math.log(256)/Math.log(s);function w(k){if(k instanceof Uint8Array||(ArrayBuffer.isView(k)?k=new Uint8Array(k.buffer,k.byteOffset,k.byteLength):Array.isArray(k)&&(k=Uint8Array.from(k))),!(k instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(k.length===0)return"";for(var g=0,m=0,B=0,O=k.length;B!==O&&k[B]===0;)B++,g++;for(var V=(O-B)*y+1>>>0,le=new Uint8Array(V);B!==O;){for(var _e=k[B],P=0,re=V-1;(_e!==0||P<m)&&re!==-1;re--,P++)_e+=256*le[re]>>>0,le[re]=_e%s>>>0,_e=_e/s>>>0;if(_e!==0)throw new Error("Non-zero carry");m=P,B++}for(var R=V-m;R!==V&&le[R]===0;)R++;for(var ie=c.repeat(g);R<V;++R)ie+=e.charAt(le[R]);return ie}function S(k){if(typeof k!="string")throw new TypeError("Expected String");if(k.length===0)return new Uint8Array;var g=0;if(k[g]!==" "){for(var m=0,B=0;k[g]===c;)m++,g++;for(var O=(k.length-g)*h+1>>>0,V=new Uint8Array(O);k[g];){var le=r[k.charCodeAt(g)];if(le===255)return;for(var _e=0,P=O-1;(le!==0||_e<B)&&P!==-1;P--,_e++)le+=s*V[P]>>>0,V[P]=le%256>>>0,le=le/256>>>0;if(le!==0)throw new Error("Non-zero carry");B=_e,g++}if(k[g]!==" "){for(var re=O-B;re!==O&&V[re]===0;)re++;for(var R=new Uint8Array(m+(O-re)),ie=m;re!==O;)R[ie++]=V[re++];return R}}}function d(k){var g=S(k);if(g)return g;throw new Error(`Non-${t} character`)}return{encode:w,decodeUnsafe:S,decode:d}}var x2,v2,by,Ey=$(()=>{a(),x2=E2,v2=x2,by=v2}),ju,zu,qu,xy,Vu,pi,Cr,_2,D2,ee,Et=$(()=>{a(),Ey(),Ar(),ju=class{constructor(e,t,r){this.name=e,this.prefix=t,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},zu=class{constructor(e,t,r){if(this.name=e,this.prefix=t,t.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=r}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return xy(this,e)}},qu=class{constructor(e){this.decoders=e}or(e){return xy(this,e)}decode(e){let t=e[0],r=this.decoders[t];if(r)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}},xy=(e,t)=>new qu({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}}),Vu=class{constructor(e,t,r,n){this.name=e,this.prefix=t,this.baseEncode=r,this.baseDecode=n,this.encoder=new ju(e,t,r),this.decoder=new zu(e,t,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}},pi=({name:e,prefix:t,encode:r,decode:n})=>new Vu(e,t,r,n),Cr=({prefix:e,name:t,alphabet:r})=>{let{encode:n,decode:i}=by(r,t);return pi({prefix:e,name:t,encode:n,decode:o=>it(i(o))})},_2=(e,t,r,n)=>{let i={};for(let y=0;y<t.length;++y)i[t[y]]=y;let o=e.length;for(;e[o-1]==="=";)--o;let u=new Uint8Array(o*r/8|0),s=0,c=0,h=0;for(let y=0;y<o;++y){let w=i[e[y]];if(w===void 0)throw new SyntaxError(`Non-${n} character`);c=c<<r|w,s+=r,s>=8&&(s-=8,u[h++]=255&c>>s)}if(s>=r||255&c<<8-s)throw new SyntaxError("Unexpected end of data");return u},D2=(e,t,r)=>{let n=t[t.length-1]==="=",i=(1<<r)-1,o="",u=0,s=0;for(let c=0;c<e.length;++c)for(s=s<<8|e[c],u+=8;u>r;)u-=r,o+=t[i&s>>u];if(u&&(o+=t[i&s<<r-u]),n)for(;o.length*r&7;)o+="=";return o},ee=({name:e,prefix:t,bitsPerChar:r,alphabet:n})=>pi({prefix:t,name:e,encode(i){return D2(i,n,r)},decode(i){return _2(i,n,r,e)}})}),bo={};H(bo,{base58btc:()=>z,base58flickr:()=>S2});var z,S2,Le=$(()=>{a(),Et(),z=Cr({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),S2=Cr({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"})}),Zs={};H(Zs,{base32:()=>C,base32hex:()=>C2,base32hexpad:()=>O2,base32hexpadupper:()=>B2,base32hexupper:()=>I2,base32pad:()=>Ku,base32padupper:()=>T2,base32upper:()=>A2,base32z:()=>k2});var C,A2,Ku,T2,C2,I2,O2,B2,k2,xe=$(()=>{a(),Et(),C=ee({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),A2=ee({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Ku=ee({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),T2=ee({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),C2=ee({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),I2=ee({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),O2=ee({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),B2=ee({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),k2=ee({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5})}),Wu={};H(Wu,{CID:()=>E});var E,L2,R2,N2,Eo,P2,vy,_y,ea,ta,F2,U2,$2,q=$(()=>{a(),Xs(),Ee(),Le(),xe(),Ar(),E=class{constructor(e,t,r,n){this.code=t,this.version=e,this.multihash=r,this.bytes=n,this.byteOffset=n.byteOffset,this.byteLength=n.byteLength,this.asCID=this,this._baseCache=new Map,Object.defineProperties(this,{byteOffset:ta,byteLength:ta,code:ea,version:ea,multihash:ea,bytes:ea,_baseCache:ta,asCID:ta})}toV0(){switch(this.version){case 0:return this;default:{let{code:e,multihash:t}=this;if(e!==Eo)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==P2)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return E.createV0(t)}}}toV1(){switch(this.version){case 0:{let{code:e,digest:t}=this.multihash,r=Tr(e,t);return E.createV1(this.code,r)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}equals(e){return e&&this.code===e.code&&this.version===e.version&&Mu(this.multihash,e.multihash)}toString(e){let{bytes:t,version:r,_baseCache:n}=this;switch(r){case 0:return R2(t,n,e||z.encoder);default:return N2(t,n,e||C.encoder)}}toJSON(){return{code:this.code,version:this.version,hash:this.multihash.bytes}}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return"CID("+this.toString()+")"}static isCID(e){return U2(/^0\.0/,$2),!!(e&&(e[_y]||e.asCID===e))}get toBaseEncodedString(){throw new Error("Deprecated, use .toString()")}get codec(){throw new Error('"codec" property is deprecated, use integer "code" property instead')}get buffer(){throw new Error("Deprecated .buffer property, use .bytes to get Uint8Array instead")}get multibaseName(){throw new Error('"multibaseName" property is deprecated')}get prefix(){throw new Error('"prefix" property is deprecated')}static asCID(e){if(e instanceof E)return e;if(e!=null&&e.asCID===e){let{version:t,code:r,multihash:n,bytes:i}=e;return new E(t,r,n,i||vy(t,r,n.bytes))}else if(e!=null&&e[_y]===!0){let{version:t,multihash:r,code:n}=e,i=G(r);return E.create(t,n,i)}else return null}static create(e,t,r){if(typeof t!="number")throw new Error("String codecs are no longer supported");switch(e){case 0:{if(t!==Eo)throw new Error(`Version 0 CID must use dag-pb (code: ${Eo}) block encoding`);return new E(e,t,r,r.bytes)}case 1:{let n=vy(e,t,r.bytes);return new E(e,t,r,n)}default:throw new Error("Invalid version")}}static createV0(e){return E.create(0,Eo,e)}static createV1(e,t){return E.create(1,e,t)}static decode(e){let[t,r]=E.decodeFirst(e);if(r.length)throw new Error("Incorrect length");return t}static decodeFirst(e){let t=E.inspectBytes(e),r=t.size-t.multihashSize,n=it(e.subarray(r,r+t.multihashSize));if(n.byteLength!==t.multihashSize)throw new Error("Incorrect length");let i=n.subarray(t.multihashSize-t.digestSize),o=new wn(t.multihashCode,t.digestSize,i,n);return[t.version===0?E.createV0(o):E.createV1(t.codec,o),e.subarray(t.size)]}static inspectBytes(e){let t=0,r=()=>{let[y,w]=wo(e.subarray(t));return t+=w,y},n=r(),i=Eo;if(n===18?(n=0,t=0):n===1&&(i=r()),n!==0&&n!==1)throw new RangeError(`Invalid CID version ${n}`);let o=t,u=r(),s=r(),c=t+s,h=c-o;return{version:n,codec:i,multihashCode:u,digestSize:s,multihashSize:h,size:c}}static parse(e,t){let[r,n]=L2(e,t),i=E.decode(n);return i._baseCache.set(r,e),i}},L2=(e,t)=>{switch(e[0]){case"Q":{let r=t||z;return[z.prefix,r.decode(`${z.prefix}${e}`)]}case z.prefix:{let r=t||z;return[z.prefix,r.decode(e)]}case C.prefix:{let r=t||C;return[C.prefix,r.decode(e)]}default:{if(t==null)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[e[0],t.decode(e)]}}},R2=(e,t,r)=>{let{prefix:n}=r;if(n!==z.prefix)throw Error(`Cannot string encode V0 in ${r.name} encoding`);let i=t.get(n);if(i==null){let o=r.encode(e).slice(1);return t.set(n,o),o}else return i},N2=(e,t,r)=>{let{prefix:n}=r,i=t.get(n);if(i==null){let o=r.encode(e);return t.set(n,o),o}else return i},Eo=112,P2=18,vy=(e,t,r)=>{let n=di(e),i=n+di(t),o=new Uint8Array(i+r.byteLength);return hi(e,o,0),hi(t,o,n),o.set(r,i),o},_y=Symbol.for("@ipld/js-cid/CID"),ea={writable:!1,configurable:!1,enumerable:!0},ta={writable:!1,enumerable:!1,configurable:!1},F2="0.0.0-dev",U2=(e,t)=>{if(e.test(F2))console.warn(t);else throw new Error(t)},$2=`CID.isCID(v) is deprecated and will be removed in the next major release.
Following code pattern:

if (CID.isCID(value)) {
  doSomethingWithCID(value)
}

Is replaced with:

const cid = CID.asCID(value)
if (cid) {
  // Make sure to use cid instead of value
  doSomethingWithCID(cid)
}
`}),ef,Zu,tf=$(()=>{a(),Ee(),ef=({name:e,code:t,encode:r})=>new Zu(e,t,r),Zu=class{constructor(e,t,r){this.name=e,this.code=t,this.encode=r}digest(e){if(e instanceof Uint8Array){let t=this.encode(e);return t instanceof Uint8Array?Tr(this.code,t):t.then(r=>Tr(this.code,r))}else throw Error("Unknown type, must be binary type")}}}),Ei=$(()=>{a(),q(),Xs(),Ar(),tf(),Ee()}),st={};H(st,{code:()=>ot,decode:()=>u8,encode:()=>c8,name:()=>jy});var jy,ot,c8,u8,ir=$(()=>{a(),Ar(),jy="raw",ot=85,c8=e=>it(e),u8=e=>it(e)}),rf={};H(rf,{sha256:()=>Mt,sha512:()=>f8});var zy,Mt,f8,xi=$(()=>{a(),tf(),zy=e=>async t=>new Uint8Array(await crypto.subtle.digest(e,t)),Mt=ef({name:"sha2-256",code:18,encode:zy("SHA-256")}),f8=ef({name:"sha2-512",code:19,encode:zy("SHA-512")})}),Hy=b((e,t)=>{a();var r=1e3,n=r*60,i=n*60,o=i*24,u=o*7,s=o*365.25;t.exports=function(S,d){d=d||{};var k=typeof S;if(k==="string"&&S.length>0)return c(S);if(k==="number"&&isFinite(S))return d.long?y(S):h(S);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(S))};function c(S){if(S=String(S),!(S.length>100)){var d=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(S);if(d){var k=parseFloat(d[1]),g=(d[2]||"ms").toLowerCase();switch(g){case"years":case"year":case"yrs":case"yr":case"y":return k*s;case"weeks":case"week":case"w":return k*u;case"days":case"day":case"d":return k*o;case"hours":case"hour":case"hrs":case"hr":case"h":return k*i;case"minutes":case"minute":case"mins":case"min":case"m":return k*n;case"seconds":case"second":case"secs":case"sec":case"s":return k*r;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return k;default:return}}}}function h(S){var d=Math.abs(S);return d>=o?Math.round(S/o)+"d":d>=i?Math.round(S/i)+"h":d>=n?Math.round(S/n)+"m":d>=r?Math.round(S/r)+"s":S+"ms"}function y(S){var d=Math.abs(S);return d>=o?w(S,d,o,"day"):d>=i?w(S,d,i,"hour"):d>=n?w(S,d,n,"minute"):d>=r?w(S,d,r,"second"):S+" ms"}function w(S,d,k,g){var m=d>=k*1.5;return Math.round(S/k)+" "+g+(m?"s":"")}}),Jy=b((e,t)=>{a();function r(n){o.debug=o,o.default=o,o.coerce=w,o.disable=c,o.enable=s,o.enabled=h,o.humanize=Hy(),o.destroy=S,Object.keys(n).forEach(d=>{o[d]=n[d]}),o.names=[],o.skips=[],o.formatters={};function i(d){let k=0;for(let g=0;g<d.length;g++)k=(k<<5)-k+d.charCodeAt(g),k|=0;return o.colors[Math.abs(k)%o.colors.length]}o.selectColor=i;function o(d){let k,g=null,m,B;function O(...V){if(!O.enabled)return;let le=O,_e=Number(new Date),P=_e-(k||_e);le.diff=P,le.prev=k,le.curr=_e,k=_e,V[0]=o.coerce(V[0]),typeof V[0]!="string"&&V.unshift("%O");let re=0;V[0]=V[0].replace(/%([a-zA-Z%])/g,(R,ie)=>{if(R==="%%")return"%";re++;let Se=o.formatters[ie];if(typeof Se=="function"){let Ne=V[re];R=Se.call(le,Ne),V.splice(re,1),re--}return R}),o.formatArgs.call(le,V),(le.log||o.log).apply(le,V)}return O.namespace=d,O.useColors=o.useColors(),O.color=o.selectColor(d),O.extend=u,O.destroy=o.destroy,Object.defineProperty(O,"enabled",{enumerable:!0,configurable:!1,get:()=>g!==null?g:(m!==o.namespaces&&(m=o.namespaces,B=o.enabled(d)),B),set:V=>{g=V}}),typeof o.init=="function"&&o.init(O),O}function u(d,k){let g=o(this.namespace+(typeof k>"u"?":":k)+d);return g.log=this.log,g}function s(d){o.save(d),o.namespaces=d,o.names=[],o.skips=[];let k,g=(typeof d=="string"?d:"").split(/[\s,]+/),m=g.length;for(k=0;k<m;k++)!g[k]||(d=g[k].replace(/\*/g,".*?"),d[0]==="-"?o.skips.push(new RegExp("^"+d.slice(1)+"$")):o.names.push(new RegExp("^"+d+"$")))}function c(){let d=[...o.names.map(y),...o.skips.map(y).map(k=>"-"+k)].join(",");return o.enable(""),d}function h(d){if(d[d.length-1]==="*")return!0;let k,g;for(k=0,g=o.skips.length;k<g;k++)if(o.skips[k].test(d))return!1;for(k=0,g=o.names.length;k<g;k++)if(o.names[k].test(d))return!0;return!1}function y(d){return d.toString().substring(2,d.toString().length-2).replace(/\.\*\?$/,"*")}function w(d){return d instanceof Error?d.stack||d.message:d}function S(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return o.enable(o.load()),o}t.exports=r}),at=b((e,t)=>{a(),e.formatArgs=n,e.save=i,e.load=o,e.useColors=r,e.storage=u(),e.destroy=(()=>{let c=!1;return()=>{c||(c=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),e.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function r(){return typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function n(c){if(c[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+c[0]+(this.useColors?"%c ":" ")+"+"+t.exports.humanize(this.diff),!this.useColors)return;let h="color: "+this.color;c.splice(1,0,h,"color: inherit");let y=0,w=0;c[0].replace(/%[a-zA-Z%]/g,S=>{S!=="%%"&&(y++,S==="%c"&&(w=y))}),c.splice(w,0,h)}e.log=console.debug||console.log||(()=>{});function i(c){try{c?e.storage.setItem("debug",c):e.storage.removeItem("debug")}catch{}}function o(){let c;try{c=e.storage.getItem("debug")}catch{}return!c&&typeof process<"u"&&"env"in process&&(c=process.env.DEBUG),c}function u(){try{return localStorage}catch{}}t.exports=Jy()(e);var{formatters:s}=t.exports;s.j=function(c){try{return JSON.stringify(c)}catch(h){return"[UnexpectedJSONParseError]: "+h.message}}}),ve=b((e,t)=>{a();function r(i,o){for(let u in o)Object.defineProperty(i,u,{value:o[u],enumerable:!0,configurable:!0});return i}function n(i,o,u){if(!i||typeof i=="string")throw new TypeError("Please pass an Error to err-code");u||(u={}),typeof o=="object"&&(u=o,o=""),o&&(u.code=o);try{return r(i,u)}catch{u.message=i.message,u.stack=i.stack;let s=function(){};return s.prototype=Object.create(Object.getPrototypeOf(i)),r(new s,u)}}t.exports=n}),af={};H(af,{identity:()=>C8});var C8,Xy=$(()=>{a(),Et(),Ar(),C8=pi({prefix:"\0",name:"identity",encode:e=>$u(e),decode:e=>Uu(e)})}),cf={};H(cf,{base2:()=>I8});var I8,Zy=$(()=>{a(),Et(),I8=ee({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1})}),uf={};H(uf,{base8:()=>O8});var O8,em=$(()=>{a(),Et(),O8=ee({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3})}),ff={};H(ff,{base10:()=>B8});var B8,tm=$(()=>{a(),Et(),B8=Cr({prefix:"9",name:"base10",alphabet:"0123456789"})}),lf={};H(lf,{base16:()=>k8,base16upper:()=>L8});var k8,L8,rm=$(()=>{a(),Et(),k8=ee({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),L8=ee({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4})}),hf={};H(hf,{base36:()=>R8,base36upper:()=>N8});var R8,N8,nm=$(()=>{a(),Et(),R8=Cr({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),N8=Cr({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"})}),df={};H(df,{base64:()=>So,base64pad:()=>P8,base64url:()=>da,base64urlpad:()=>F8});var So,P8,da,F8,Ao=$(()=>{a(),Et(),So=ee({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),P8=ee({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),da=ee({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),F8=ee({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6})}),pf={};H(pf,{base256emoji:()=>z8});function M8(e){return e.reduce((t,r)=>(t+=U8[r],t),"")}function j8(e){let t=[];for(let r of e){let n=$8[r.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${r}`);t.push(n)}return new Uint8Array(t)}var im,U8,$8,z8,om=$(()=>{a(),Et(),im=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),U8=im.reduce((e,t,r)=>(e[r]=t,e),[]),$8=im.reduce((e,t,r)=>(e[t.codePointAt(0)]=r,e),[]),z8=pi({prefix:"\u{1F680}",name:"base256emoji",encode:M8,decode:j8})}),yf={};H(yf,{identity:()=>Si});var sm,q8,am,V8,Si,pa=$(()=>{a(),Ar(),Ee(),sm=0,q8="identity",am=it,V8=e=>Tr(sm,am(e)),Si={code:sm,name:q8,encode:am,digest:V8}}),ya={};H(ya,{code:()=>mf,decode:()=>J8,encode:()=>G8,name:()=>H8});var K8,W8,H8,mf,G8,J8,gf=$(()=>{a(),K8=new TextEncoder,W8=new TextDecoder,H8="json",mf=512,G8=e=>K8.encode(JSON.stringify(e)),J8=e=>JSON.parse(W8.decode(e))}),_n,cm,um,To=$(()=>{a(),Xy(),Zy(),em(),tm(),rm(),xe(),nm(),Le(),Ao(),om(),xi(),pa(),ir(),gf(),Ei(),_n={...af,...cf,...uf,...ff,...lf,...Zs,...hf,...bo,...df,...pf},cm={...rf,...yf},um={raw:st,json:ya}});function ma(e=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?globalThis.Buffer.allocUnsafe(e):new Uint8Array(e)}var wf=$(()=>{a()});function lm(e,t,r,n){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:r},decoder:{decode:n}}}var fm,bf,Q8,ga,Ef=$(()=>{a(),To(),wf(),fm=lm("utf8","u",e=>{let t=new TextDecoder("utf8");return"u"+t.decode(e)},e=>new TextEncoder().encode(e.substring(1))),bf=lm("ascii","a",e=>{let t="a";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t},e=>{e=e.substring(1);let t=ma(e.length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}),Q8={utf8:fm,"utf-8":fm,hex:_n.base16,latin1:bf,ascii:bf,binary:bf,..._n},ga=Q8}),Co={};H(Co,{toString:()=>A});function A(e,t="utf8"){let r=ga[t];if(!r)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(e.buffer,e.byteOffset,e.byteLength).toString("utf8"):r.encoder.encode(e).substring(1)}var W=$(()=>{a(),Ef()}),hm={};H(hm,{fromString:()=>N});function N(e,t="utf8"){let r=ga[t];if(!r)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(e,"utf8"):r.decoder.decode(`${r.prefix}${e}`)}var we=$(()=>{a(),Ef()}),xf=b((e,t)=>{a();var r=async n=>{let i=0;for await(let o of n)i++;return i};t.exports=r}),Im=b((e,t)=>{a(),t.exports=r;function r(n,i){for(var o=new Array(arguments.length-1),u=0,s=2,c=!0;s<arguments.length;)o[u++]=arguments[s++];return new Promise(function(h,y){o[u]=function(w){if(c)if(c=!1,w)y(w);else{for(var S=new Array(arguments.length-1),d=0;d<S.length;)S[d++]=arguments[d];h.apply(null,S)}};try{n.apply(i||null,o)}catch(w){c&&(c=!1,y(w))}})}}),Lm=b(e=>{a();var t=e;t.length=function(u){var s=u.length;if(!s)return 0;for(var c=0;--s%4>1&&u.charAt(s)==="=";)++c;return Math.ceil(u.length*3)/4-c};var r=new Array(64),n=new Array(123);for(i=0;i<64;)n[r[i]=i<26?i+65:i<52?i+71:i<62?i-4:i-59|43]=i++;var i;t.encode=function(u,s,c){for(var h=null,y=[],w=0,S=0,d;s<c;){var k=u[s++];switch(S){case 0:y[w++]=r[k>>2],d=(k&3)<<4,S=1;break;case 1:y[w++]=r[d|k>>4],d=(k&15)<<2,S=2;break;case 2:y[w++]=r[d|k>>6],y[w++]=r[k&63],S=0;break}w>8191&&((h||(h=[])).push(String.fromCharCode.apply(String,y)),w=0)}return S&&(y[w++]=r[d],y[w++]=61,S===1&&(y[w++]=61)),h?(w&&h.push(String.fromCharCode.apply(String,y.slice(0,w))),h.join("")):String.fromCharCode.apply(String,y.slice(0,w))};var o="invalid encoding";t.decode=function(u,s,c){for(var h=c,y=0,w,S=0;S<u.length;){var d=u.charCodeAt(S++);if(d===61&&y>1)break;if((d=n[d])===void 0)throw Error(o);switch(y){case 0:w=d,y=1;break;case 1:s[c++]=w<<2|(d&48)>>4,w=d,y=2;break;case 2:s[c++]=(w&15)<<4|(d&60)>>2,w=d,y=3;break;case 3:s[c++]=(w&3)<<6|d,y=0;break}}if(y===1)throw Error(o);return c-h},t.test=function(u){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(u)}}),Nm=b((e,t)=>{a(),t.exports=r;function r(){this._listeners={}}r.prototype.on=function(n,i,o){return(this._listeners[n]||(this._listeners[n]=[])).push({fn:i,ctx:o||this}),this},r.prototype.off=function(n,i){if(n===void 0)this._listeners={};else if(i===void 0)this._listeners[n]=[];else for(var o=this._listeners[n],u=0;u<o.length;)o[u].fn===i?o.splice(u,1):++u;return this},r.prototype.emit=function(n){var i=this._listeners[n];if(i){for(var o=[],u=1;u<arguments.length;)o.push(arguments[u++]);for(u=0;u<i.length;)i[u].fn.apply(i[u++].ctx,o)}return this}}),zm=b((e,t)=>{a(),t.exports=r(r);function r(s){return typeof Float32Array<"u"?function(){var c=new Float32Array([-0]),h=new Uint8Array(c.buffer),y=h[3]===128;function w(g,m,B){c[0]=g,m[B]=h[0],m[B+1]=h[1],m[B+2]=h[2],m[B+3]=h[3]}function S(g,m,B){c[0]=g,m[B]=h[3],m[B+1]=h[2],m[B+2]=h[1],m[B+3]=h[0]}s.writeFloatLE=y?w:S,s.writeFloatBE=y?S:w;function d(g,m){return h[0]=g[m],h[1]=g[m+1],h[2]=g[m+2],h[3]=g[m+3],c[0]}function k(g,m){return h[3]=g[m],h[2]=g[m+1],h[1]=g[m+2],h[0]=g[m+3],c[0]}s.readFloatLE=y?d:k,s.readFloatBE=y?k:d}():function(){function c(y,w,S,d){var k=w<0?1:0;if(k&&(w=-w),w===0)y(1/w>0?0:2147483648,S,d);else if(isNaN(w))y(2143289344,S,d);else if(w>34028234663852886e22)y((k<<31|2139095040)>>>0,S,d);else if(w<11754943508222875e-54)y((k<<31|Math.round(w/1401298464324817e-60))>>>0,S,d);else{var g=Math.floor(Math.log(w)/Math.LN2),m=Math.round(w*Math.pow(2,-g)*8388608)&8388607;y((k<<31|g+127<<23|m)>>>0,S,d)}}s.writeFloatLE=c.bind(null,n),s.writeFloatBE=c.bind(null,i);function h(y,w,S){var d=y(w,S),k=(d>>31)*2+1,g=d>>>23&255,m=d&8388607;return g===255?m?NaN:k*(1/0):g===0?k*1401298464324817e-60*m:k*Math.pow(2,g-150)*(m+8388608)}s.readFloatLE=h.bind(null,o),s.readFloatBE=h.bind(null,u)}(),typeof Float64Array<"u"?function(){var c=new Float64Array([-0]),h=new Uint8Array(c.buffer),y=h[7]===128;function w(g,m,B){c[0]=g,m[B]=h[0],m[B+1]=h[1],m[B+2]=h[2],m[B+3]=h[3],m[B+4]=h[4],m[B+5]=h[5],m[B+6]=h[6],m[B+7]=h[7]}function S(g,m,B){c[0]=g,m[B]=h[7],m[B+1]=h[6],m[B+2]=h[5],m[B+3]=h[4],m[B+4]=h[3],m[B+5]=h[2],m[B+6]=h[1],m[B+7]=h[0]}s.writeDoubleLE=y?w:S,s.writeDoubleBE=y?S:w;function d(g,m){return h[0]=g[m],h[1]=g[m+1],h[2]=g[m+2],h[3]=g[m+3],h[4]=g[m+4],h[5]=g[m+5],h[6]=g[m+6],h[7]=g[m+7],c[0]}function k(g,m){return h[7]=g[m],h[6]=g[m+1],h[5]=g[m+2],h[4]=g[m+3],h[3]=g[m+4],h[2]=g[m+5],h[1]=g[m+6],h[0]=g[m+7],c[0]}s.readDoubleLE=y?d:k,s.readDoubleBE=y?k:d}():function(){function c(y,w,S,d,k,g){var m=d<0?1:0;if(m&&(d=-d),d===0)y(0,k,g+w),y(1/d>0?0:2147483648,k,g+S);else if(isNaN(d))y(0,k,g+w),y(2146959360,k,g+S);else if(d>17976931348623157e292)y(0,k,g+w),y((m<<31|2146435072)>>>0,k,g+S);else{var B;if(d<22250738585072014e-324)B=d/5e-324,y(B>>>0,k,g+w),y((m<<31|B/4294967296)>>>0,k,g+S);else{var O=Math.floor(Math.log(d)/Math.LN2);O===1024&&(O=1023),B=d*Math.pow(2,-O),y(B*4503599627370496>>>0,k,g+w),y((m<<31|O+1023<<20|B*1048576&1048575)>>>0,k,g+S)}}}s.writeDoubleLE=c.bind(null,n,0,4),s.writeDoubleBE=c.bind(null,i,4,0);function h(y,w,S,d,k){var g=y(d,k+w),m=y(d,k+S),B=(m>>31)*2+1,O=m>>>20&2047,V=4294967296*(m&1048575)+g;return O===2047?V?NaN:B*(1/0):O===0?B*5e-324*V:B*Math.pow(2,O-1075)*(V+4503599627370496)}s.readDoubleLE=h.bind(null,o,0,4),s.readDoubleBE=h.bind(null,u,4,0)}(),s}function n(s,c,h){c[h]=s&255,c[h+1]=s>>>8&255,c[h+2]=s>>>16&255,c[h+3]=s>>>24}function i(s,c,h){c[h]=s>>>24,c[h+1]=s>>>16&255,c[h+2]=s>>>8&255,c[h+3]=s&255}function o(s,c){return(s[c]|s[c+1]<<8|s[c+2]<<16|s[c+3]<<24)>>>0}function u(s,c){return(s[c]<<24|s[c+1]<<16|s[c+2]<<8|s[c+3])>>>0}}),qm=b((exports,module)=>{a(),module.exports=inquire;function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(e){}return null}}),Km=b(e=>{a();var t=e;t.length=function(r){for(var n=0,i=0,o=0;o<r.length;++o)i=r.charCodeAt(o),i<128?n+=1:i<2048?n+=2:(i&64512)===55296&&(r.charCodeAt(o+1)&64512)===56320?(++o,n+=4):n+=3;return n},t.read=function(r,n,i){var o=i-n;if(o<1)return"";for(var u=null,s=[],c=0,h;n<i;)h=r[n++],h<128?s[c++]=h:h>191&&h<224?s[c++]=(h&31)<<6|r[n++]&63:h>239&&h<365?(h=((h&7)<<18|(r[n++]&63)<<12|(r[n++]&63)<<6|r[n++]&63)-65536,s[c++]=55296+(h>>10),s[c++]=56320+(h&1023)):s[c++]=(h&15)<<12|(r[n++]&63)<<6|r[n++]&63,c>8191&&((u||(u=[])).push(String.fromCharCode.apply(String,s)),c=0);return u?(c&&u.push(String.fromCharCode.apply(String,s.slice(0,c))),u.join("")):String.fromCharCode.apply(String,s.slice(0,c))},t.write=function(r,n,i){for(var o=i,u,s,c=0;c<r.length;++c)u=r.charCodeAt(c),u<128?n[i++]=u:u<2048?(n[i++]=u>>6|192,n[i++]=u&63|128):(u&64512)===55296&&((s=r.charCodeAt(c+1))&64512)===56320?(u=65536+((u&1023)<<10)+(s&1023),++c,n[i++]=u>>18|240,n[i++]=u>>12&63|128,n[i++]=u>>6&63|128,n[i++]=u&63|128):(n[i++]=u>>12|224,n[i++]=u>>6&63|128,n[i++]=u&63|128);return i-o}}),Hm=b((e,t)=>{a(),t.exports=r;function r(n,i,o){var u=o||8192,s=u>>>1,c=null,h=u;return function(y){if(y<1||y>s)return n(y);h+y>u&&(c=n(u),h=0);var w=i.call(c,h,h+=y);return h&7&&(h=(h|7)+1),w}}}),Jm=b((e,t)=>{a(),t.exports=n;var r=Pr();function n(s,c){this.lo=s>>>0,this.hi=c>>>0}var i=n.zero=new n(0,0);i.toNumber=function(){return 0},i.zzEncode=i.zzDecode=function(){return this},i.length=function(){return 1};var o=n.zeroHash="\0\0\0\0\0\0\0\0";n.fromNumber=function(s){if(s===0)return i;var c=s<0;c&&(s=-s);var h=s>>>0,y=(s-h)/4294967296>>>0;return c&&(y=~y>>>0,h=~h>>>0,++h>4294967295&&(h=0,++y>4294967295&&(y=0))),new n(h,y)},n.from=function(s){if(typeof s=="number")return n.fromNumber(s);if(r.isString(s))if(r.Long)s=r.Long.fromString(s);else return n.fromNumber(parseInt(s,10));return s.low||s.high?new n(s.low>>>0,s.high>>>0):i},n.prototype.toNumber=function(s){if(!s&&this.hi>>>31){var c=~this.lo+1>>>0,h=~this.hi>>>0;return c||(h=h+1>>>0),-(c+h*4294967296)}return this.lo+this.hi*4294967296},n.prototype.toLong=function(s){return r.Long?new r.Long(this.lo|0,this.hi|0,Boolean(s)):{low:this.lo|0,high:this.hi|0,unsigned:Boolean(s)}};var u=String.prototype.charCodeAt;n.fromHash=function(s){return s===o?i:new n((u.call(s,0)|u.call(s,1)<<8|u.call(s,2)<<16|u.call(s,3)<<24)>>>0,(u.call(s,4)|u.call(s,5)<<8|u.call(s,6)<<16|u.call(s,7)<<24)>>>0)},n.prototype.toHash=function(){return String.fromCharCode(this.lo&255,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,this.hi&255,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},n.prototype.zzEncode=function(){var s=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^s)>>>0,this.lo=(this.lo<<1^s)>>>0,this},n.prototype.zzDecode=function(){var s=-(this.lo&1);return this.lo=((this.lo>>>1|this.hi<<31)^s)>>>0,this.hi=(this.hi>>>1^s)>>>0,this},n.prototype.length=function(){var s=this.lo,c=(this.lo>>>28|this.hi<<4)>>>0,h=this.hi>>>24;return h===0?c===0?s<16384?s<128?1:2:s<2097152?3:4:c<16384?c<128?5:6:c<2097152?7:8:h<128?9:10}}),Pr=b(e=>{a();var t=e;t.asPromise=Im(),t.base64=Lm(),t.EventEmitter=Nm(),t.float=zm(),t.inquire=qm(),t.utf8=Km(),t.pool=Hm(),t.LongBits=Jm(),t.isNode=Boolean(typeof global<"u"&&global&&global.process&&global.process.versions&&global.process.versions.node),t.global=t.isNode&&global||typeof window<"u"&&window||typeof self<"u"&&self||e,t.emptyArray=Object.freeze?Object.freeze([]):[],t.emptyObject=Object.freeze?Object.freeze({}):{},t.isInteger=Number.isInteger||function(i){return typeof i=="number"&&isFinite(i)&&Math.floor(i)===i},t.isString=function(i){return typeof i=="string"||i instanceof String},t.isObject=function(i){return i&&typeof i=="object"},t.isset=t.isSet=function(i,o){var u=i[o];return u!=null&&i.hasOwnProperty(o)?typeof u!="object"||(Array.isArray(u)?u.length:Object.keys(u).length)>0:!1},t.Buffer=function(){try{var i=t.inquire("buffer").Buffer;return i.prototype.utf8Write?i:null}catch{return null}}(),t._Buffer_from=null,t._Buffer_allocUnsafe=null,t.newBuffer=function(i){return typeof i=="number"?t.Buffer?t._Buffer_allocUnsafe(i):new t.Array(i):t.Buffer?t._Buffer_from(i):typeof Uint8Array>"u"?i:new Uint8Array(i)},t.Array=typeof Uint8Array<"u"?Uint8Array:Array,t.Long=t.global.dcodeIO&&t.global.dcodeIO.Long||t.global.Long||t.inquire("long"),t.key2Re=/^true|false|0|1$/,t.key32Re=/^-?(?:0|[1-9][0-9]*)$/,t.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,t.longToHash=function(i){return i?t.LongBits.from(i).toHash():t.LongBits.zeroHash},t.longFromHash=function(i,o){var u=t.LongBits.fromHash(i);return t.Long?t.Long.fromBits(u.lo,u.hi,o):u.toNumber(Boolean(o))};function r(i,o,u){for(var s=Object.keys(o),c=0;c<s.length;++c)(i[s[c]]===void 0||!u)&&(i[s[c]]=o[s[c]]);return i}t.merge=r,t.lcFirst=function(i){return i.charAt(0).toLowerCase()+i.substring(1)};function n(i){function o(u,s){if(!(this instanceof o))return new o(u,s);Object.defineProperty(this,"message",{get:function(){return u}}),Error.captureStackTrace?Error.captureStackTrace(this,o):Object.defineProperty(this,"stack",{value:new Error().stack||""}),s&&r(this,s)}return o.prototype=Object.create(Error.prototype,{constructor:{value:o,writable:!0,enumerable:!1,configurable:!0},name:{get(){return i},set:void 0,enumerable:!1,configurable:!0},toString:{value(){return this.name+": "+this.message},writable:!0,enumerable:!1,configurable:!0}}),o}t.newError=n,t.ProtocolError=n("ProtocolError"),t.oneOfGetter=function(i){for(var o={},u=0;u<i.length;++u)o[i[u]]=1;return function(){for(var s=Object.keys(this),c=s.length-1;c>-1;--c)if(o[s[c]]===1&&this[s[c]]!==void 0&&this[s[c]]!==null)return s[c]}},t.oneOfSetter=function(i){return function(o){for(var u=0;u<i.length;++u)i[u]!==o&&delete this[i[u]]}},t.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},t._configure=function(){var i=t.Buffer;if(!i){t._Buffer_from=t._Buffer_allocUnsafe=null;return}t._Buffer_from=i.from!==Uint8Array.from&&i.from||function(o,u){return new i(o,u)},t._Buffer_allocUnsafe=i.allocUnsafe||function(o){return new i(o)}}}),Bf=b((e,t)=>{a(),t.exports=y;var r=Pr(),n,i=r.LongBits,o=r.base64,u=r.utf8;function s(O,V,le){this.fn=O,this.len=V,this.next=void 0,this.val=le}function c(){}function h(O){this.head=O.head,this.tail=O.tail,this.len=O.len,this.next=O.states}function y(){this.len=0,this.head=new s(c,0,0),this.tail=this.head,this.states=null}var w=function(){return r.Buffer?function(){return(y.create=function(){return new n})()}:function(){return new y}};y.create=w(),y.alloc=function(O){return new r.Array(O)},r.Array!==Array&&(y.alloc=r.pool(y.alloc,r.Array.prototype.subarray)),y.prototype._push=function(O,V,le){return this.tail=this.tail.next=new s(O,V,le),this.len+=V,this};function S(O,V,le){V[le]=O&255}function d(O,V,le){for(;O>127;)V[le++]=O&127|128,O>>>=7;V[le]=O}function k(O,V){this.len=O,this.next=void 0,this.val=V}k.prototype=Object.create(s.prototype),k.prototype.fn=d,y.prototype.uint32=function(O){return this.len+=(this.tail=this.tail.next=new k((O=O>>>0)<128?1:O<16384?2:O<2097152?3:O<268435456?4:5,O)).len,this},y.prototype.int32=function(O){return O<0?this._push(g,10,i.fromNumber(O)):this.uint32(O)},y.prototype.sint32=function(O){return this.uint32((O<<1^O>>31)>>>0)};function g(O,V,le){for(;O.hi;)V[le++]=O.lo&127|128,O.lo=(O.lo>>>7|O.hi<<25)>>>0,O.hi>>>=7;for(;O.lo>127;)V[le++]=O.lo&127|128,O.lo=O.lo>>>7;V[le++]=O.lo}y.prototype.uint64=function(O){var V=i.from(O);return this._push(g,V.length(),V)},y.prototype.int64=y.prototype.uint64,y.prototype.sint64=function(O){var V=i.from(O).zzEncode();return this._push(g,V.length(),V)},y.prototype.bool=function(O){return this._push(S,1,O?1:0)};function m(O,V,le){V[le]=O&255,V[le+1]=O>>>8&255,V[le+2]=O>>>16&255,V[le+3]=O>>>24}y.prototype.fixed32=function(O){return this._push(m,4,O>>>0)},y.prototype.sfixed32=y.prototype.fixed32,y.prototype.fixed64=function(O){var V=i.from(O);return this._push(m,4,V.lo)._push(m,4,V.hi)},y.prototype.sfixed64=y.prototype.fixed64,y.prototype.float=function(O){return this._push(r.float.writeFloatLE,4,O)},y.prototype.double=function(O){return this._push(r.float.writeDoubleLE,8,O)};var B=r.Array.prototype.set?function(O,V,le){V.set(O,le)}:function(O,V,le){for(var _e=0;_e<O.length;++_e)V[le+_e]=O[_e]};y.prototype.bytes=function(O){var V=O.length>>>0;if(!V)return this._push(S,1,0);if(r.isString(O)){var le=y.alloc(V=o.length(O));o.decode(O,le,0),O=le}return this.uint32(V)._push(B,V,O)},y.prototype.string=function(O){var V=u.length(O);return V?this.uint32(V)._push(u.write,V,O):this._push(S,1,0)},y.prototype.fork=function(){return this.states=new h(this),this.head=this.tail=new s(c,0,0),this.len=0,this},y.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new s(c,0,0),this.len=0),this},y.prototype.ldelim=function(){var O=this.head,V=this.tail,le=this.len;return this.reset().uint32(le),le&&(this.tail.next=O.next,this.tail=V,this.len+=le),this},y.prototype.finish=function(){for(var O=this.head.next,V=this.constructor.alloc(this.len),le=0;O;)O.fn(O.val,V,le),le+=O.len,O=O.next;return V},y._configure=function(O){n=O,y.create=w(),n._configure()}}),ig=b((e,t)=>{a(),t.exports=i;var r=Bf();(i.prototype=Object.create(r.prototype)).constructor=i;var n=Pr();function i(){r.call(this)}i._configure=function(){i.alloc=n._Buffer_allocUnsafe,i.writeBytesBuffer=n.Buffer&&n.Buffer.prototype instanceof Uint8Array&&n.Buffer.prototype.set.name==="set"?function(u,s,c){s.set(u,c)}:function(u,s,c){if(u.copy)u.copy(s,c,0,u.length);else for(var h=0;h<u.length;)s[c++]=u[h++]}},i.prototype.bytes=function(u){n.isString(u)&&(u=n._Buffer_from(u,"base64"));var s=u.length>>>0;return this.uint32(s),s&&this._push(i.writeBytesBuffer,s,u),this};function o(u,s,c){u.length<40?n.utf8.write(u,s,c):s.utf8Write?s.utf8Write(u,c):s.write(u,c)}i.prototype.string=function(u){var s=n.Buffer.byteLength(u);return this.uint32(s),s&&this._push(o,s,u),this},i._configure()}),Rf=b((e,t)=>{a(),t.exports=s;var r=Pr(),n,i=r.LongBits,o=r.utf8;function u(d,k){return RangeError("index out of range: "+d.pos+" + "+(k||1)+" > "+d.len)}function s(d){this.buf=d,this.pos=0,this.len=d.length}var c=typeof Uint8Array<"u"?function(d){if(d instanceof Uint8Array||Array.isArray(d))return new s(d);throw Error("illegal buffer")}:function(d){if(Array.isArray(d))return new s(d);throw Error("illegal buffer")},h=function(){return r.Buffer?function(d){return(s.create=function(k){return r.Buffer.isBuffer(k)?new n(k):c(k)})(d)}:c};s.create=h(),s.prototype._slice=r.Array.prototype.subarray||r.Array.prototype.slice,s.prototype.uint32=function(){var d=4294967295;return function(){if(d=(this.buf[this.pos]&127)>>>0,this.buf[this.pos++]<128||(d=(d|(this.buf[this.pos]&127)<<7)>>>0,this.buf[this.pos++]<128)||(d=(d|(this.buf[this.pos]&127)<<14)>>>0,this.buf[this.pos++]<128)||(d=(d|(this.buf[this.pos]&127)<<21)>>>0,this.buf[this.pos++]<128)||(d=(d|(this.buf[this.pos]&15)<<28)>>>0,this.buf[this.pos++]<128))return d;if((this.pos+=5)>this.len)throw this.pos=this.len,u(this,10);return d}}(),s.prototype.int32=function(){return this.uint32()|0},s.prototype.sint32=function(){var d=this.uint32();return d>>>1^-(d&1)|0};function y(){var d=new i(0,0),k=0;if(this.len-this.pos>4){for(;k<4;++k)if(d.lo=(d.lo|(this.buf[this.pos]&127)<<k*7)>>>0,this.buf[this.pos++]<128)return d;if(d.lo=(d.lo|(this.buf[this.pos]&127)<<28)>>>0,d.hi=(d.hi|(this.buf[this.pos]&127)>>4)>>>0,this.buf[this.pos++]<128)return d;k=0}else{for(;k<3;++k){if(this.pos>=this.len)throw u(this);if(d.lo=(d.lo|(this.buf[this.pos]&127)<<k*7)>>>0,this.buf[this.pos++]<128)return d}return d.lo=(d.lo|(this.buf[this.pos++]&127)<<k*7)>>>0,d}if(this.len-this.pos>4){for(;k<5;++k)if(d.hi=(d.hi|(this.buf[this.pos]&127)<<k*7+3)>>>0,this.buf[this.pos++]<128)return d}else for(;k<5;++k){if(this.pos>=this.len)throw u(this);if(d.hi=(d.hi|(this.buf[this.pos]&127)<<k*7+3)>>>0,this.buf[this.pos++]<128)return d}throw Error("invalid varint encoding")}s.prototype.bool=function(){return this.uint32()!==0};function w(d,k){return(d[k-4]|d[k-3]<<8|d[k-2]<<16|d[k-1]<<24)>>>0}s.prototype.fixed32=function(){if(this.pos+4>this.len)throw u(this,4);return w(this.buf,this.pos+=4)},s.prototype.sfixed32=function(){if(this.pos+4>this.len)throw u(this,4);return w(this.buf,this.pos+=4)|0};function S(){if(this.pos+8>this.len)throw u(this,8);return new i(w(this.buf,this.pos+=4),w(this.buf,this.pos+=4))}s.prototype.float=function(){if(this.pos+4>this.len)throw u(this,4);var d=r.float.readFloatLE(this.buf,this.pos);return this.pos+=4,d},s.prototype.double=function(){if(this.pos+8>this.len)throw u(this,4);var d=r.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,d},s.prototype.bytes=function(){var d=this.uint32(),k=this.pos,g=this.pos+d;if(g>this.len)throw u(this,d);return this.pos+=d,Array.isArray(this.buf)?this.buf.slice(k,g):k===g?new this.buf.constructor(0):this._slice.call(this.buf,k,g)},s.prototype.string=function(){var d=this.bytes();return o.read(d,0,d.length)},s.prototype.skip=function(d){if(typeof d=="number"){if(this.pos+d>this.len)throw u(this,d);this.pos+=d}else do if(this.pos>=this.len)throw u(this);while(this.buf[this.pos++]&128);return this},s.prototype.skipType=function(d){switch(d){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;(d=this.uint32()&7)!==4;)this.skipType(d);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+d+" at offset "+this.pos)}return this},s._configure=function(d){n=d,s.create=h(),n._configure();var k=r.Long?"toLong":"toNumber";r.merge(s.prototype,{int64:function(){return y.call(this)[k](!1)},uint64:function(){return y.call(this)[k](!0)},sint64:function(){return y.call(this).zzDecode()[k](!1)},fixed64:function(){return S.call(this)[k](!0)},sfixed64:function(){return S.call(this)[k](!1)}})}}),dg=b((e,t)=>{a(),t.exports=i;var r=Rf();(i.prototype=Object.create(r.prototype)).constructor=i;var n=Pr();function i(o){r.call(this,o)}i._configure=function(){n.Buffer&&(i.prototype._slice=n.Buffer.prototype.slice)},i.prototype.string=function(){var o=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+o,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+o,this.len))},i._configure()}),yg=b((e,t)=>{a(),t.exports=n;var r=Pr();(n.prototype=Object.create(r.EventEmitter.prototype)).constructor=n;function n(i,o,u){if(typeof i!="function")throw TypeError("rpcImpl must be a function");r.EventEmitter.call(this),this.rpcImpl=i,this.requestDelimited=Boolean(o),this.responseDelimited=Boolean(u)}n.prototype.rpcCall=function i(o,u,s,c,h){if(!c)throw TypeError("request must be specified");var y=this;if(!h)return r.asPromise(i,y,o,u,s,c);if(!y.rpcImpl){setTimeout(function(){h(Error("already ended"))},0);return}try{return y.rpcImpl(o,u[y.requestDelimited?"encodeDelimited":"encode"](c).finish(),function(w,S){if(w)return y.emit("error",w,o),h(w);if(S===null){y.end(!0);return}if(!(S instanceof s))try{S=s[y.responseDelimited?"decodeDelimited":"decode"](S)}catch(d){return y.emit("error",d,o),h(d)}return y.emit("data",S,o),h(null,S)})}catch(w){y.emit("error",w,o),setTimeout(function(){h(w)},0);return}},n.prototype.end=function(i){return this.rpcImpl&&(i||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}}),gg=b(e=>{a();var t=e;t.Service=yg()}),bg=b((e,t)=>{a(),t.exports={}}),vg=b(e=>{a();var t=e;t.build="minimal",t.Writer=Bf(),t.BufferWriter=ig(),t.Reader=Rf(),t.BufferReader=dg(),t.util=Pr(),t.rpc=gg(),t.roots=bg(),t.configure=r;function r(){t.util._configure(),t.Writer._configure(t.BufferWriter),t.Reader._configure(t.BufferReader)}r()}),Ur=b((e,t)=>{a(),t.exports=vg()}),Tg=b((e,t)=>{a(),Object.defineProperty(e,"__esModule",{value:!0}),r.BASE=2166136261;function r(n,i=r.BASE){let o=n.length;for(let u=0;u<o;u++)i^=n.charCodeAt(u),i+=(i<<1)+(i<<4)+(i<<7)+(i<<8)+(i<<24);return i>>>0}e.default=r,t.exports=r}),$f={};H($f,{concat:()=>Y});function Y(e,t){t||(t=e.reduce((i,o)=>i+o.length,0));let r=ma(t),n=0;for(let i of e)r.set(i,n),n+=i.length;return r}var $r=$(()=>{a(),wf()}),Hg=b((e,t)=>{a();var r="[a-fA-F\\d:]",n=w=>w&&w.includeBoundaries?`(?:(?<=\\s|^)(?=${r})|(?<=${r})(?=\\s|$))`:"",i="(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)){3}",o="[a-fA-F\\d]{1,4}",u=`
(?:
(?:${o}:){7}(?:${o}|:)|                                    // 1:2:3:4:5:6:7::  1:2:3:4:5:6:7:8
(?:${o}:){6}(?:${i}|:${o}|:)|                             // 1:2:3:4:5:6::    1:2:3:4:5:6::8   1:2:3:4:5:6::8  1:2:3:4:5:6::1.2.3.4
(?:${o}:){5}(?::${i}|(?::${o}){1,2}|:)|                   // 1:2:3:4:5::      1:2:3:4:5::7:8   1:2:3:4:5::8    1:2:3:4:5::7:1.2.3.4
(?:${o}:){4}(?:(?::${o}){0,1}:${i}|(?::${o}){1,3}|:)| // 1:2:3:4::        1:2:3:4::6:7:8   1:2:3:4::8      1:2:3:4::6:7:1.2.3.4
(?:${o}:){3}(?:(?::${o}){0,2}:${i}|(?::${o}){1,4}|:)| // 1:2:3::          1:2:3::5:6:7:8   1:2:3::8        1:2:3::5:6:7:1.2.3.4
(?:${o}:){2}(?:(?::${o}){0,3}:${i}|(?::${o}){1,5}|:)| // 1:2::            1:2::4:5:6:7:8   1:2::8          1:2::4:5:6:7:1.2.3.4
(?:${o}:){1}(?:(?::${o}){0,4}:${i}|(?::${o}){1,6}|:)| // 1::              1::3:4:5:6:7:8   1::8            1::3:4:5:6:7:1.2.3.4
(?::(?:(?::${o}){0,5}:${i}|(?::${o}){1,7}|:))             // ::2:3:4:5:6:7:8  ::2:3:4:5:6:7:8  ::8             ::1.2.3.4
)(?:%[0-9a-zA-Z]{1,})?                                             // %eth0            %1
`.replace(/\s*\/\/.*$/gm,"").replace(/\n/g,"").trim(),s=new RegExp(`(?:^${i}$)|(?:^${u}$)`),c=new RegExp(`^${i}$`),h=new RegExp(`^${u}$`),y=w=>w&&w.exact?s:new RegExp(`(?:${n(w)}${i}${n(w)})|(?:${n(w)}${u}${n(w)})`,"g");y.v4=w=>w&&w.exact?c:new RegExp(`${n(w)}${i}${n(w)}`,"g"),y.v6=w=>w&&w.exact?h:new RegExp(`${n(w)}${u}${n(w)}`,"g"),t.exports=y}),Jg=b((e,t)=>{a();var r=Hg(),n=i=>r({exact:!0}).test(i);n.v4=i=>r.v4({exact:!0}).test(i),n.v6=i=>r.v6({exact:!0}).test(i),n.version=i=>n(i)?n.v4(i)?4:6:void 0,t.exports=n}),ew=b((e,t)=>{a();var r=Jg(),{toString:n}=(W(),Oe(Co)),i=r,o=r.v4,u=r.v6,s=function(h,y,w){w=~~w;let S;if(o(h))S=y||new Uint8Array(w+4),h.split(/\./g).map(function(d){S[w++]=parseInt(d,10)&255});else if(u(h)){let d=h.split(":",8),k;for(k=0;k<d.length;k++){let g=o(d[k]),m;g&&(m=s(d[k]),d[k]=n(m.slice(0,2),"base16")),m&&++k<8&&d.splice(k,0,n(m.slice(2,4),"base16"))}if(d[0]==="")for(;d.length<8;)d.unshift("0");else if(d[d.length-1]==="")for(;d.length<8;)d.push("0");else if(d.length<8){for(k=0;k<d.length&&d[k]!=="";k++);let g=[k,"1"];for(k=9-d.length;k>0;k--)g.push("0");d.splice.apply(d,g)}for(S=y||new Uint8Array(w+16),k=0;k<d.length;k++){let g=parseInt(d[k],16);S[w++]=g>>8&255,S[w++]=g&255}}if(!S)throw Error("Invalid ip address: "+h);return S},c=function(h,y,w){y=~~y,w=w||h.length-y;let S=[],d,k=new DataView(h.buffer);if(w===4){for(let g=0;g<w;g++)S.push(h[y+g]);d=S.join(".")}else if(w===16){for(let g=0;g<w;g+=2)S.push(k.getUint16(y+g).toString(16));d=S.join(":"),d=d.replace(/(^|:)0(:0)*:0(:|$)/,"$1::$3"),d=d.replace(/:{3,4}/,"::")}return d};t.exports={isIP:i,isV4:o,isV6:u,toBytes:s,toString:c}}),Na=b((e,t)=>{a();function r(o){if(typeof o=="number"){if(r.codes[o])return r.codes[o];throw new Error("no protocol with code: "+o)}else if(typeof o=="string"){if(r.names[o])return r.names[o];throw new Error("no protocol with name: "+o)}throw new Error("invalid protocol id type: "+o)}var n=-1;r.lengthPrefixedVarSize=n,r.V=n,r.table=[[4,32,"ip4"],[6,16,"tcp"],[33,16,"dccp"],[41,128,"ip6"],[42,n,"ip6zone"],[53,n,"dns","resolvable"],[54,n,"dns4","resolvable"],[55,n,"dns6","resolvable"],[56,n,"dnsaddr","resolvable"],[132,16,"sctp"],[273,16,"udp"],[275,0,"p2p-webrtc-star"],[276,0,"p2p-webrtc-direct"],[277,0,"p2p-stardust"],[290,0,"p2p-circuit"],[301,0,"udt"],[302,0,"utp"],[400,n,"unix",!1,"path"],[421,n,"ipfs"],[421,n,"p2p"],[443,0,"https"],[444,96,"onion"],[445,296,"onion3"],[446,n,"garlic64"],[460,0,"quic"],[477,0,"ws"],[478,0,"wss"],[479,0,"p2p-websocket-star"],[480,0,"http"],[777,n,"memory"]],r.names={},r.codes={},r.table.map(o=>{let u=i.apply(null,o);return r.codes[u.code]=u,r.names[u.name]=u,null}),r.object=i;function i(o,u,s,c,h){return{code:o,size:u,name:s,resolvable:Boolean(c),path:Boolean(h)}}t.exports=r}),fw=b((e,t)=>{a();var r=ew(),n=Na(),{CID:i}=(q(),Oe(Wu)),{base32:o}=(xe(),Oe(Zs)),{base58btc:u}=(Le(),Oe(bo)),s=(Ee(),Oe(be)),c=ke(),{toString:h}=(W(),Oe(Co)),{fromString:y}=(we(),Oe(hm)),{concat:w}=($r(),Oe($f));t.exports=S;function S(R,ie){return ie instanceof Uint8Array?S.toString(R,ie):S.toBytes(R,ie)}S.toString=function(R,ie){switch(n(R).code){case 4:case 41:return k(ie);case 6:case 273:case 33:case 132:return m(ie).toString();case 53:case 54:case 55:case 56:case 400:case 777:return O(ie);case 421:return le(ie);case 444:return re(ie);case 445:return re(ie);default:return h(ie,"base16")}},S.toBytes=function(R,ie){switch(n(R).code){case 4:return d(ie);case 41:return d(ie);case 6:case 273:case 33:case 132:return g(parseInt(ie,10));case 53:case 54:case 55:case 56:case 400:case 777:return B(ie);case 421:return V(ie);case 444:return _e(ie);case 445:return P(ie);default:return y(ie,"base16")}};function d(R){if(!r.isIP(R))throw new Error("invalid ip address");return r.toBytes(R)}function k(R){let ie=r.toString(R);if(!ie||!r.isIP(ie))throw new Error("invalid ip address");return ie}function g(R){let ie=new ArrayBuffer(2);return new DataView(ie).setUint16(0,R),new Uint8Array(ie)}function m(R){return new DataView(R.buffer).getUint16(R.byteOffset)}function B(R){let ie=y(R),Se=Uint8Array.from(c.encode(ie.length));return w([Se,ie],Se.length+ie.length)}function O(R){let ie=c.decode(R);if(R=R.slice(c.decode.bytes),R.length!==ie)throw new Error("inconsistent lengths");return h(R)}function V(R){let ie;R[0]==="Q"||R[0]==="1"?ie=s.decode(u.decode(`z${R}`)).bytes:ie=i.parse(R).multihash.bytes;let Se=Uint8Array.from(c.encode(ie.length));return w([Se,ie],Se.length+ie.length)}function le(R){let ie=c.decode(R),Se=R.slice(c.decode.bytes);if(Se.length!==ie)throw new Error("inconsistent lengths");return h(Se,"base58btc")}function _e(R){let ie=R.split(":");if(ie.length!==2)throw new Error("failed to parse onion addr: "+ie+" does not contain a port number");if(ie[0].length!==16)throw new Error("failed to parse onion addr: "+ie[0]+" not a Tor onion address.");let Se=o.decode("b"+ie[0]),Ne=parseInt(ie[1],10);if(Ne<1||Ne>65536)throw new Error("Port number is not in range(1, 65536)");let De=g(Ne);return w([Se,De],Se.length+De.length)}function P(R){let ie=R.split(":");if(ie.length!==2)throw new Error("failed to parse onion addr: "+ie+" does not contain a port number");if(ie[0].length!==56)throw new Error("failed to parse onion addr: "+ie[0]+" not a Tor onion3 address.");let Se=o.decode("b"+ie[0]),Ne=parseInt(ie[1],10);if(Ne<1||Ne>65536)throw new Error("Port number is not in range(1, 65536)");let De=g(Ne);return w([Se,De],Se.length+De.length)}function re(R){let ie=R.slice(0,R.length-2),Se=R.slice(R.length-2),Ne=h(ie,"base32"),De=m(Se);return Ne+":"+De}}),vw=b((e,t)=>{a();var r=fw(),n=Na(),i=ke(),{concat:o}=($r(),Oe($f)),{toString:u}=(W(),Oe(Co));t.exports={stringToStringTuples:s,stringTuplesToString:c,tuplesToStringTuples:y,stringTuplesToTuples:h,bytesToTuples:d,tuplesToBytes:w,bytesToString:k,stringToBytes:g,fromString:m,fromBytes:B,validateBytes:O,isValidBytes:V,cleanPath:le,ParseError:_e,protoFromTuple:P,sizeForAddr:S};function s(re){let R=[],ie=re.split("/").slice(1);if(ie.length===1&&ie[0]==="")return[];for(let Se=0;Se<ie.length;Se++){let Ne=ie[Se],De=n(Ne);if(De.size===0){R.push([Ne]);continue}if(Se++,Se>=ie.length)throw _e("invalid address: "+re);if(De.path){R.push([Ne,le(ie.slice(Se).join("/"))]);break}R.push([Ne,ie[Se]])}return R}function c(re){let R=[];return re.map(ie=>{let Se=P(ie);return R.push(Se.name),ie.length>1&&R.push(ie[1]),null}),le(R.join("/"))}function h(re){return re.map(R=>{Array.isArray(R)||(R=[R]);let ie=P(R);return R.length>1?[ie.code,r.toBytes(ie.code,R[1])]:[ie.code]})}function y(re){return re.map(R=>{let ie=P(R);return R[1]?[ie.code,r.toString(ie.code,R[1])]:[ie.code]})}function w(re){return B(o(re.map(R=>{let ie=P(R),Se=Uint8Array.from(i.encode(ie.code));return R.length>1&&(Se=o([Se,R[1]])),Se})))}function S(re,R){return re.size>0?re.size/8:re.size===0?0:i.decode(R)+i.decode.bytes}function d(re){let R=[],ie=0;for(;ie<re.length;){let Se=i.decode(re,ie),Ne=i.decode.bytes,De=n(Se),Ve=S(De,re.slice(ie+Ne));if(Ve===0){R.push([Se]),ie+=Ne;continue}let pt=re.slice(ie+Ne,ie+Ne+Ve);if(ie+=Ve+Ne,ie>re.length)throw _e("Invalid address Uint8Array: "+u(re,"base16"));R.push([Se,pt])}return R}function k(re){let R=d(re),ie=y(R);return c(ie)}function g(re){re=le(re);let R=s(re),ie=h(R);return w(ie)}function m(re){return g(re)}function B(re){let R=O(re);if(R)throw R;return Uint8Array.from(re)}function O(re){try{d(re)}catch(R){return R}}function V(re){return O(re)===void 0}function le(re){return"/"+re.trim().split("/").filter(R=>R).join("/")}function _e(re){return new Error("Error parsing address: "+re)}function P(re){return n(re[0])}}),_w={};H(_w,{equals:()=>zo});function zo(e,t){if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let r=0;r<e.byteLength;r++)if(e[r]!==t[r])return!1;return!0}var Ma=$(()=>{a()}),Tw=b((e,t)=>{a();var r=vw(),n=Na(),i=ke(),{CID:o}=(q(),Oe(Wu)),{base58btc:u}=(Le(),Oe(bo)),s=ve(),c=Symbol.for("nodejs.util.inspect.custom"),{toString:h}=(W(),Oe(Co)),{equals:y}=(Ma(),Oe(_w)),w=new Map,S=Symbol.for("@multiformats/js-multiaddr/multiaddr"),d=class{constructor(g){if(g==null&&(g=""),Object.defineProperty(this,S,{value:!0}),g instanceof Uint8Array)this.bytes=r.fromBytes(g);else if(typeof g=="string"){if(g.length>0&&g.charAt(0)!=="/")throw new Error(`multiaddr "${g}" must start with a "/"`);this.bytes=r.fromString(g)}else if(d.isMultiaddr(g))this.bytes=r.fromBytes(g.bytes);else throw new Error("addr must be a string, Buffer, or another Multiaddr")}toString(){return r.bytesToString(this.bytes)}toJSON(){return this.toString()}toOptions(){let g={},m=this.toString().split("/");return g.family=m[1]==="ip4"?4:6,g.host=m[2],g.transport=m[3],g.port=parseInt(m[4]),g}protos(){return this.protoCodes().map(g=>Object.assign({},n(g)))}protoCodes(){let g=[],m=this.bytes,B=0;for(;B<m.length;){let O=i.decode(m,B),V=i.decode.bytes,le=n(O);B+=r.sizeForAddr(le,m.slice(B+V))+V,g.push(O)}return g}protoNames(){return this.protos().map(g=>g.name)}tuples(){return r.bytesToTuples(this.bytes)}stringTuples(){let g=r.bytesToTuples(this.bytes);return r.tuplesToStringTuples(g)}encapsulate(g){return g=new d(g),new d(this.toString()+g.toString())}decapsulate(g){let m=g.toString(),B=this.toString(),O=B.lastIndexOf(m);if(O<0)throw new Error("Address "+this+" does not contain subaddress: "+g);return new d(B.slice(0,O))}decapsulateCode(g){let m=this.tuples();for(let B=m.length-1;B>=0;B--)if(m[B][0]===g)return new d(r.tuplesToBytes(m.slice(0,B)));return this}getPeerId(){try{let g=this.stringTuples().filter(m=>m[0]===n.names.ipfs.code).pop();if(g&&g[1]){let m=g[1];return m[0]==="Q"||m[0]==="1"?h(u.decode(`z${m}`),"base58btc"):h(o.parse(m).multihash.bytes,"base58btc")}return null}catch{return null}}getPath(){let g=null;try{g=this.stringTuples().filter(m=>!!n(m[0]).path)[0][1],g||(g=null)}catch{g=null}return g}equals(g){return y(this.bytes,g.bytes)}async resolve(){let g=this.protos().find(B=>B.resolvable);if(!g)return[this];let m=w.get(g.name);if(!m)throw s(new Error(`no available resolver for ${g.name}`),"ERR_NO_AVAILABLE_RESOLVER");return(await m(this)).map(B=>new d(B))}nodeAddress(){let g=this.protoCodes(),m=this.protoNames(),B=this.toString().split("/").slice(1);if(B.length<4)throw new Error('multiaddr must have a valid format: "/{ip4, ip6, dns4, dns6}/{address}/{tcp, udp}/{port}".');if(g[0]!==4&&g[0]!==41&&g[0]!==54&&g[0]!==55)throw new Error(`no protocol with name: "'${m[0]}'". Must have a valid family name: "{ip4, ip6, dns4, dns6}".`);if(B[2]!=="tcp"&&B[2]!=="udp")throw new Error(`no protocol with name: "'${m[1]}'". Must have a valid transport protocol: "{tcp, udp}".`);return{family:g[0]===41||g[0]===55?6:4,address:B[1],port:parseInt(B[3])}}isThinWaistAddress(g){let m=(g||this).protos();return!(m.length!==2||m[0].code!==4&&m[0].code!==41||m[1].code!==6&&m[1].code!==273)}static fromNodeAddress(g,m){if(!g)throw new Error("requires node address object");if(!m)throw new Error("requires transport protocol");let B;switch(g.family){case 4:B="ip4";break;case 6:B="ip6";break;default:throw Error(`Invalid addr family. Got '${g.family}' instead of 4 or 6`)}return new d("/"+[B,g.address,m,g.port].join("/"))}static isName(g){return d.isMultiaddr(g)?g.protos().some(m=>m.resolvable):!1}static isMultiaddr(g){return g instanceof d||Boolean(g&&g[S])}[c](){return"<Multiaddr "+h(this.bytes,"base16")+" - "+r.bytesToString(this.bytes)+">"}inspect(){return"<Multiaddr "+h(this.bytes,"base16")+" - "+r.bytesToString(this.bytes)+">"}};d.protocols=n,d.resolvers=w;function k(g){return new d(g)}t.exports={Multiaddr:d,multiaddr:k,protocols:n,resolvers:w}}),Fw=b((e,t)=>{a(),t.exports=u,t.exports.format=s,t.exports.parse=c;var r=/\B(?=(\d{3})+(?!\d))/g,n=/(?:\.0*|(\.[^0]+)0+)$/,i={b:1,kb:1<<10,mb:1<<20,gb:1<<30,tb:Math.pow(1024,4),pb:Math.pow(1024,5)},o=/^((-|\+)?(\d+(?:\.\d+)?)) *(kb|mb|gb|tb|pb)$/i;function u(h,y){return typeof h=="string"?c(h):typeof h=="number"?s(h,y):null}function s(h,y){if(!Number.isFinite(h))return null;var w=Math.abs(h),S=y&&y.thousandsSeparator||"",d=y&&y.unitSeparator||"",k=y&&y.decimalPlaces!==void 0?y.decimalPlaces:2,g=Boolean(y&&y.fixedDecimals),m=y&&y.unit||"";(!m||!i[m.toLowerCase()])&&(w>=i.pb?m="PB":w>=i.tb?m="TB":w>=i.gb?m="GB":w>=i.mb?m="MB":w>=i.kb?m="KB":m="B");var B=h/i[m.toLowerCase()],O=B.toFixed(k);return g||(O=O.replace(n,"$1")),S&&(O=O.split(".").map(function(V,le){return le===0?V.replace(r,S):V}).join(".")),O+d+m}function c(h){if(typeof h=="number"&&!isNaN(h))return h;if(typeof h!="string")return null;var y=o.exec(h),w,S="b";return y?(w=parseFloat(y[1]),S=y[4].toLowerCase()):(w=parseInt(h,10),S="b"),isNaN(w)?null:Math.floor(i[S]*w)}}),$w=b((e,t)=>{a(),t.exports=r=>{if(Object.prototype.toString.call(r)!=="[object Object]")return!1;let n=Object.getPrototypeOf(r);return n===null||n===Object.prototype}}),Kw=b((e,t)=>{a();var r=$w(),{hasOwnProperty:n}=Object.prototype,{propertyIsEnumerable:i}=Object,o=(g,m,B)=>Object.defineProperty(g,m,{value:B,writable:!0,enumerable:!0,configurable:!0}),u=e,s={concatArrays:!1,ignoreUndefined:!1},c=g=>{let m=[];for(let B in g)n.call(g,B)&&m.push(B);if(Object.getOwnPropertySymbols){let B=Object.getOwnPropertySymbols(g);for(let O of B)i.call(g,O)&&m.push(O)}return m};function h(g){return Array.isArray(g)?y(g):r(g)?w(g):g}function y(g){let m=g.slice(0,0);return c(g).forEach(B=>{o(m,B,h(g[B]))}),m}function w(g){let m=Object.getPrototypeOf(g)===null?Object.create(null):{};return c(g).forEach(B=>{o(m,B,h(g[B]))}),m}var S=(g,m,B,O)=>(B.forEach(V=>{typeof m[V]>"u"&&O.ignoreUndefined||(V in g&&g[V]!==Object.getPrototypeOf(g)?o(g,V,k(g[V],m[V],O)):o(g,V,h(m[V])))}),g),d=(g,m,B)=>{let O=g.slice(0,0),V=0;return[g,m].forEach(le=>{let _e=[];for(let P=0;P<le.length;P++)!n.call(le,P)||(_e.push(String(P)),le===g?o(O,V++,le[P]):o(O,V++,h(le[P])));O=S(O,le,c(le).filter(P=>!_e.includes(P)),B)}),O};function k(g,m,B){return B.concatArrays&&Array.isArray(g)&&Array.isArray(m)?d(g,m,B):!r(m)||!r(g)?h(m):S(g,m,c(m),B)}t.exports=function(...g){let m=k(h(s),this!==u&&this||{},s),B={_:{}};for(let O of g)if(O!==void 0){if(!r(O))throw new TypeError("`"+O+"` is not an Option Object");B=k(B,{_:O},m)}return B._}}),tb=b((e,t)=>{a();var r=Object.prototype.hasOwnProperty,n="~";function i(){}Object.create&&(i.prototype=Object.create(null),new i().__proto__||(n=!1));function o(h,y,w){this.fn=h,this.context=y,this.once=w||!1}function u(h,y,w,S,d){if(typeof w!="function")throw new TypeError("The listener must be a function");var k=new o(w,S||h,d),g=n?n+y:y;return h._events[g]?h._events[g].fn?h._events[g]=[h._events[g],k]:h._events[g].push(k):(h._events[g]=k,h._eventsCount++),h}function s(h,y){--h._eventsCount===0?h._events=new i:delete h._events[y]}function c(){this._events=new i,this._eventsCount=0}c.prototype.eventNames=function(){var h=[],y,w;if(this._eventsCount===0)return h;for(w in y=this._events)r.call(y,w)&&h.push(n?w.slice(1):w);return Object.getOwnPropertySymbols?h.concat(Object.getOwnPropertySymbols(y)):h},c.prototype.listeners=function(h){var y=n?n+h:h,w=this._events[y];if(!w)return[];if(w.fn)return[w.fn];for(var S=0,d=w.length,k=new Array(d);S<d;S++)k[S]=w[S].fn;return k},c.prototype.listenerCount=function(h){var y=n?n+h:h,w=this._events[y];return w?w.fn?1:w.length:0},c.prototype.emit=function(h,y,w,S,d,k){var g=n?n+h:h;if(!this._events[g])return!1;var m=this._events[g],B=arguments.length,O,V;if(m.fn){switch(m.once&&this.removeListener(h,m.fn,void 0,!0),B){case 1:return m.fn.call(m.context),!0;case 2:return m.fn.call(m.context,y),!0;case 3:return m.fn.call(m.context,y,w),!0;case 4:return m.fn.call(m.context,y,w,S),!0;case 5:return m.fn.call(m.context,y,w,S,d),!0;case 6:return m.fn.call(m.context,y,w,S,d,k),!0}for(V=1,O=new Array(B-1);V<B;V++)O[V-1]=arguments[V];m.fn.apply(m.context,O)}else{var le=m.length,_e;for(V=0;V<le;V++)switch(m[V].once&&this.removeListener(h,m[V].fn,void 0,!0),B){case 1:m[V].fn.call(m[V].context);break;case 2:m[V].fn.call(m[V].context,y);break;case 3:m[V].fn.call(m[V].context,y,w);break;case 4:m[V].fn.call(m[V].context,y,w,S);break;default:if(!O)for(_e=1,O=new Array(B-1);_e<B;_e++)O[_e-1]=arguments[_e];m[V].fn.apply(m[V].context,O)}}return!0},c.prototype.on=function(h,y,w){return u(this,h,y,w,!1)},c.prototype.once=function(h,y,w){return u(this,h,y,w,!0)},c.prototype.removeListener=function(h,y,w,S){var d=n?n+h:h;if(!this._events[d])return this;if(!y)return s(this,d),this;var k=this._events[d];if(k.fn)k.fn===y&&(!S||k.once)&&(!w||k.context===w)&&s(this,d);else{for(var g=0,m=[],B=k.length;g<B;g++)(k[g].fn!==y||S&&!k[g].once||w&&k[g].context!==w)&&m.push(k[g]);m.length?this._events[d]=m.length===1?m[0]:m:s(this,d)}return this},c.prototype.removeAllListeners=function(h){var y;return h?(y=n?n+h:h,this._events[y]&&s(this,y)):(this._events=new i,this._eventsCount=0),this},c.prototype.off=c.prototype.removeListener,c.prototype.addListener=c.prototype.on,c.prefixed=n,c.EventEmitter=c,typeof t<"u"&&(t.exports=c)}),Rn=b((e,t)=>{a();var r=async function*(n,i){for await(let o of n)await i(o)&&(yield o)};t.exports=r}),Nn=b((e,t)=>{a();var r=async n=>{for await(let i of n);};t.exports=r}),Al=b((e,t)=>{a();var r=async n=>{for await(let i of n)return i};t.exports=r}),ji=b((e,t)=>{a();var r=async function*(n,i){for await(let o of n)yield i(o)};t.exports=r}),Vb=b((e,t)=>{a();async function*r(n,i=1){let o=[];i<1&&(i=1);for await(let u of n)for(o.push(u);o.length>=i;)yield o.slice(0,i),o=o.slice(i);for(;o.length;)yield o.slice(0,i),o=o.slice(i)}t.exports=r}),Wb=b((e,t)=>{a();var r=Vb();async function*n(i,o=1){for await(let u of r(i,o)){let s=u.map(c=>c().then(h=>({ok:!0,value:h}),h=>({ok:!1,err:h})));for(let c=0;c<s.length;c++){let h=await s[c];if(h.ok)yield h.value;else throw h.err}}}t.exports=n}),Jb=b((e,t)=>{a(),t.exports=class{constructor(r){if(!(r>0)||(r-1&r)!==0)throw new Error("Max size for a FixedFIFO should be a power of two");this.buffer=new Array(r),this.mask=r-1,this.top=0,this.btm=0,this.next=null}push(r){return this.buffer[this.top]!==void 0?!1:(this.buffer[this.top]=r,this.top=this.top+1&this.mask,!0)}shift(){let r=this.buffer[this.btm];if(r!==void 0)return this.buffer[this.btm]=void 0,this.btm=this.btm+1&this.mask,r}peek(){return this.buffer[this.btm]}isEmpty(){return this.buffer[this.btm]===void 0}}}),Xb=b((e,t)=>{a();var r=Jb();t.exports=class{constructor(n){this.hwm=n||16,this.head=new r(this.hwm),this.tail=this.head}push(n){if(!this.head.push(n)){let i=this.head;this.head=i.next=new r(2*this.head.buffer.length),this.head.push(n)}}shift(){let n=this.tail.shift();if(n===void 0&&this.tail.next){let i=this.tail.next;return this.tail.next=null,this.tail=i,this.tail.shift()}return n}peek(){return this.tail.peek()}isEmpty(){return this.head.isEmpty()}}}),e0=b((e,t)=>{a();var r=Xb();t.exports=n=>{n=n||{};let i;typeof n=="function"?(i=n,n={}):i=n.onEnd;let o=new r,u,s,c,h=()=>{if(!o.isEmpty()){if(n.writev){let O,V=[];for(;!o.isEmpty();){if(O=o.shift(),O.error)throw O.error;V.push(O.value)}return{done:O.done,value:V}}let B=o.shift();if(B.error)throw B.error;return B}return c?{done:!0}:new Promise((B,O)=>{s=V=>(s=null,V.error?O(V.error):n.writev&&!V.done?B({done:V.done,value:[V.value]}):B(V),u)})},y=B=>s?s(B):(o.push(B),u),w=B=>(o=new r,s?s({error:B}):(o.push({error:B}),u)),S=B=>c?u:y({done:!1,value:B}),d=B=>c?u:(c=!0,B?w(B):y({done:!0})),k=()=>(o=new r,d(),{done:!0}),g=B=>(d(B),{done:!0});if(u={[Symbol.asyncIterator](){return this},next:h,return:k,throw:g,push:S,end:d},!i)return u;let m=u;return u={[Symbol.asyncIterator](){return this},next(){return m.next()},throw(B){return m.throw(B),i&&(i(B),i=null),{done:!0}},return(){return m.return(),i&&(i(),i=null),{done:!0}},push:S,end(B){return m.end(B),i&&(i(B),i=null),u}},u}}),cc=b((e,t)=>{a();var r=e0(),n=async function*(...i){let o=r();setTimeout(async()=>{try{await Promise.all(i.map(async u=>{for await(let s of u)o.push(s)})),o.end()}catch(u){o.end(u)}},0),yield*o};t.exports=n}),is=b((e,t)=>{a();var r=async n=>{let i=[];for await(let o of n)i.push(o);return i};t.exports=r}),os=b((e,t)=>{a();var r=async function*(n,i){let o=0;if(!(i<1)){for await(let u of n)if(yield u,o++,o===i)return}};t.exports=r}),x0=b((e,t)=>{a();var r=is(),n=async function*(i,o){yield*(await r(i)).sort(o)};t.exports=n}),_0=b(e=>{a(),e.supports=function(...t){let r=t.reduce((n,i)=>Object.assign(n,i),{});return Object.assign(r,{snapshots:r.snapshots||!1,permanence:r.permanence||!1,seek:r.seek||!1,clear:r.clear||!1,getMany:r.getMany||!1,keyIterator:r.keyIterator||!1,valueIterator:r.valueIterator||!1,iteratorNextv:r.iteratorNextv||!1,iteratorAll:r.iteratorAll||!1,status:r.status||!1,createIfMissing:r.createIfMissing||!1,errorIfExists:r.errorIfExists||!1,deferredOpen:r.deferredOpen||!1,promises:r.promises||!1,streams:r.streams||!1,encodings:Object.assign({},r.encodings),events:Object.assign({},r.events),additionalMethods:Object.assign({},r.additionalMethods)})}}),Ot=b((e,t)=>{a(),t.exports=class extends Error{constructor(r,n){super(r||""),typeof n=="object"&&n!==null&&(n.code&&(this.code=String(n.code)),n.expected&&(this.expected=!0),n.transient&&(this.transient=!0),n.cause&&(this.cause=n.cause)),Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}}}),Ql=b((e,t)=>{a();var r=null;t.exports=function(){return r===null&&(r={textEncoder:new TextEncoder,textDecoder:new TextDecoder}),r}}),Zl=b(e=>{a();var t=Ot(),r=new Set(["buffer","view","utf8"]),n=class{constructor(i){if(this.encode=i.encode||this.encode,this.decode=i.decode||this.decode,this.name=i.name||this.name,this.format=i.format||this.format,typeof this.encode!="function")throw new TypeError("The 'encode' property must be a function");if(typeof this.decode!="function")throw new TypeError("The 'decode' property must be a function");if(this.encode=this.encode.bind(this),this.decode=this.decode.bind(this),typeof this.name!="string"||this.name==="")throw new TypeError("The 'name' property must be a string");if(typeof this.format!="string"||!r.has(this.format))throw new TypeError("The 'format' property must be one of 'buffer', 'view', 'utf8'");i.createViewTranscoder&&(this.createViewTranscoder=i.createViewTranscoder),i.createBufferTranscoder&&(this.createBufferTranscoder=i.createBufferTranscoder),i.createUTF8Transcoder&&(this.createUTF8Transcoder=i.createUTF8Transcoder)}get commonName(){return this.name.split("+")[0]}createBufferTranscoder(){throw new t(`Encoding '${this.name}' cannot be transcoded to 'buffer'`,{code:"LEVEL_ENCODING_NOT_SUPPORTED"})}createViewTranscoder(){throw new t(`Encoding '${this.name}' cannot be transcoded to 'view'`,{code:"LEVEL_ENCODING_NOT_SUPPORTED"})}createUTF8Transcoder(){throw new t(`Encoding '${this.name}' cannot be transcoded to 'utf8'`,{code:"LEVEL_ENCODING_NOT_SUPPORTED"})}};e.Encoding=n}),nh=b(e=>{a();var{Buffer:t}=co()||{},{Encoding:r}=Zl(),n=Ql(),i=class extends r{constructor(s){super({...s,format:"buffer"})}createViewTranscoder(){return new o({encode:this.encode,decode:s=>this.decode(t.from(s.buffer,s.byteOffset,s.byteLength)),name:`${this.name}+view`})}createBufferTranscoder(){return this}},o=class extends r{constructor(s){super({...s,format:"view"})}createBufferTranscoder(){return new i({encode:s=>{let c=this.encode(s);return t.from(c.buffer,c.byteOffset,c.byteLength)},decode:this.decode,name:`${this.name}+buffer`})}createViewTranscoder(){return this}},u=class extends r{constructor(s){super({...s,format:"utf8"})}createBufferTranscoder(){return new i({encode:s=>t.from(this.encode(s),"utf8"),decode:s=>this.decode(s.toString("utf8")),name:`${this.name}+buffer`})}createViewTranscoder(){let{textEncoder:s,textDecoder:c}=n();return new o({encode:h=>s.encode(this.encode(h)),decode:h=>this.decode(c.decode(h)),name:`${this.name}+view`})}createUTF8Transcoder(){return this}};e.BufferFormat=i,e.ViewFormat=o,e.UTF8Format=u}),O0=b(e=>{a();var{Buffer:t}=co()||{Buffer:{isBuffer:()=>!1}},{textEncoder:r,textDecoder:n}=Ql()(),{BufferFormat:i,ViewFormat:o,UTF8Format:u}=nh(),s=c=>c;e.utf8=new u({encode:function(c){return t.isBuffer(c)?c.toString("utf8"):ArrayBuffer.isView(c)?n.decode(c):String(c)},decode:s,name:"utf8",createViewTranscoder(){return new o({encode:function(c){return ArrayBuffer.isView(c)?c:r.encode(c)},decode:function(c){return n.decode(c)},name:`${this.name}+view`})},createBufferTranscoder(){return new i({encode:function(c){return t.isBuffer(c)?c:ArrayBuffer.isView(c)?t.from(c.buffer,c.byteOffset,c.byteLength):t.from(String(c),"utf8")},decode:function(c){return c.toString("utf8")},name:`${this.name}+buffer`})}}),e.json=new u({encode:JSON.stringify,decode:JSON.parse,name:"json"}),e.buffer=new i({encode:function(c){return t.isBuffer(c)?c:ArrayBuffer.isView(c)?t.from(c.buffer,c.byteOffset,c.byteLength):t.from(String(c),"utf8")},decode:s,name:"buffer",createViewTranscoder(){return new o({encode:function(c){return ArrayBuffer.isView(c)?c:t.from(String(c),"utf8")},decode:function(c){return t.from(c.buffer,c.byteOffset,c.byteLength)},name:`${this.name}+view`})}}),e.view=new o({encode:function(c){return ArrayBuffer.isView(c)?c:r.encode(c)},decode:s,name:"view",createBufferTranscoder(){return new i({encode:function(c){return t.isBuffer(c)?c:ArrayBuffer.isView(c)?t.from(c.buffer,c.byteOffset,c.byteLength):t.from(String(c),"utf8")},decode:s,name:`${this.name}+buffer`})}}),e.hex=new i({encode:function(c){return t.isBuffer(c)?c:t.from(String(c),"hex")},decode:function(c){return c.toString("hex")},name:"hex"}),e.base64=new i({encode:function(c){return t.isBuffer(c)?c:t.from(String(c),"base64")},decode:function(c){return c.toString("base64")},name:"base64"})}),L0=b(e=>{a();var t=Ot(),r=O0(),{Encoding:n}=Zl(),{BufferFormat:i,ViewFormat:o,UTF8Format:u}=nh(),s=Symbol("formats"),c=Symbol("encodings"),h=new Set(["buffer","view","utf8"]),y=class{constructor(m){if(Array.isArray(m)){if(!m.every(B=>h.has(B)))throw new TypeError("Format must be one of 'buffer', 'view', 'utf8'")}else throw new TypeError("The first argument 'formats' must be an array");this[c]=new Map,this[s]=new Set(m);for(let B in r)try{this.encoding(B)}catch(O){if(O.code!=="LEVEL_ENCODING_NOT_SUPPORTED")throw O}}encodings(){return Array.from(new Set(this[c].values()))}encoding(m){let B=this[c].get(m);if(B===void 0){if(typeof m=="string"&&m!==""){if(B=k[m],!B)throw new t(`Encoding '${m}' is not found`,{code:"LEVEL_ENCODING_NOT_FOUND"})}else{if(typeof m!="object"||m===null)throw new TypeError("First argument 'encoding' must be a string or object");B=w(m)}let{name:O,format:V}=B;if(!this[s].has(V))if(this[s].has("view"))B=B.createViewTranscoder();else if(this[s].has("buffer"))B=B.createBufferTranscoder();else if(this[s].has("utf8"))B=B.createUTF8Transcoder();else throw new t(`Encoding '${O}' cannot be transcoded`,{code:"LEVEL_ENCODING_NOT_SUPPORTED"});for(let le of[m,O,B.name,B.commonName])this[c].set(le,B)}return B}};e.Transcoder=y;function w(m){if(m instanceof n)return m;let B="type"in m&&typeof m.type=="string"?m.type:void 0,O=m.name||B||`anonymous-${g++}`;switch(S(m)){case"view":return new o({...m,name:O});case"utf8":return new u({...m,name:O});case"buffer":return new i({...m,name:O});default:throw new TypeError("Format must be one of 'buffer', 'view', 'utf8'")}}function S(m){return"format"in m&&m.format!==void 0?m.format:"buffer"in m&&typeof m.buffer=="boolean"?m.buffer?"buffer":"utf8":"code"in m&&Number.isInteger(m.code)?"view":"buffer"}var d={binary:r.buffer,"utf-8":r.utf8},k={...r,...d},g=0}),V0=b((e,t)=>{a();var r=typeof Reflect=="object"?Reflect:null,n=r&&typeof r.apply=="function"?r.apply:function(P,re,R){return Function.prototype.apply.call(P,re,R)},i;r&&typeof r.ownKeys=="function"?i=r.ownKeys:Object.getOwnPropertySymbols?i=function(P){return Object.getOwnPropertyNames(P).concat(Object.getOwnPropertySymbols(P))}:i=function(P){return Object.getOwnPropertyNames(P)};function o(P){console&&console.warn&&console.warn(P)}var u=Number.isNaN||function(P){return P!==P};function s(){s.init.call(this)}t.exports=s,t.exports.once=V,s.EventEmitter=s,s.prototype._events=void 0,s.prototype._eventsCount=0,s.prototype._maxListeners=void 0;var c=10;function h(P){if(typeof P!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof P)}Object.defineProperty(s,"defaultMaxListeners",{enumerable:!0,get:function(){return c},set:function(P){if(typeof P!="number"||P<0||u(P))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+P+".");c=P}}),s.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},s.prototype.setMaxListeners=function(P){if(typeof P!="number"||P<0||u(P))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+P+".");return this._maxListeners=P,this};function y(P){return P._maxListeners===void 0?s.defaultMaxListeners:P._maxListeners}s.prototype.getMaxListeners=function(){return y(this)},s.prototype.emit=function(P){for(var re=[],R=1;R<arguments.length;R++)re.push(arguments[R]);var ie=P==="error",Se=this._events;if(Se!==void 0)ie=ie&&Se.error===void 0;else if(!ie)return!1;if(ie){var Ne;if(re.length>0&&(Ne=re[0]),Ne instanceof Error)throw Ne;var De=new Error("Unhandled error."+(Ne?" ("+Ne.message+")":""));throw De.context=Ne,De}var Ve=Se[P];if(Ve===void 0)return!1;if(typeof Ve=="function")n(Ve,this,re);else for(var pt=Ve.length,gt=m(Ve,pt),R=0;R<pt;++R)n(gt[R],this,re);return!0};function w(P,re,R,ie){var Se,Ne,De;if(h(R),Ne=P._events,Ne===void 0?(Ne=P._events=Object.create(null),P._eventsCount=0):(Ne.newListener!==void 0&&(P.emit("newListener",re,R.listener?R.listener:R),Ne=P._events),De=Ne[re]),De===void 0)De=Ne[re]=R,++P._eventsCount;else if(typeof De=="function"?De=Ne[re]=ie?[R,De]:[De,R]:ie?De.unshift(R):De.push(R),Se=y(P),Se>0&&De.length>Se&&!De.warned){De.warned=!0;var Ve=new Error("Possible EventEmitter memory leak detected. "+De.length+" "+String(re)+" listeners added. Use emitter.setMaxListeners() to increase limit");Ve.name="MaxListenersExceededWarning",Ve.emitter=P,Ve.type=re,Ve.count=De.length,o(Ve)}return P}s.prototype.addListener=function(P,re){return w(this,P,re,!1)},s.prototype.on=s.prototype.addListener,s.prototype.prependListener=function(P,re){return w(this,P,re,!0)};function S(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function d(P,re,R){var ie={fired:!1,wrapFn:void 0,target:P,type:re,listener:R},Se=S.bind(ie);return Se.listener=R,ie.wrapFn=Se,Se}s.prototype.once=function(P,re){return h(re),this.on(P,d(this,P,re)),this},s.prototype.prependOnceListener=function(P,re){return h(re),this.prependListener(P,d(this,P,re)),this},s.prototype.removeListener=function(P,re){var R,ie,Se,Ne,De;if(h(re),ie=this._events,ie===void 0)return this;if(R=ie[P],R===void 0)return this;if(R===re||R.listener===re)--this._eventsCount===0?this._events=Object.create(null):(delete ie[P],ie.removeListener&&this.emit("removeListener",P,R.listener||re));else if(typeof R!="function"){for(Se=-1,Ne=R.length-1;Ne>=0;Ne--)if(R[Ne]===re||R[Ne].listener===re){De=R[Ne].listener,Se=Ne;break}if(Se<0)return this;Se===0?R.shift():B(R,Se),R.length===1&&(ie[P]=R[0]),ie.removeListener!==void 0&&this.emit("removeListener",P,De||re)}return this},s.prototype.off=s.prototype.removeListener,s.prototype.removeAllListeners=function(P){var re,R,ie;if(R=this._events,R===void 0)return this;if(R.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):R[P]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete R[P]),this;if(arguments.length===0){var Se=Object.keys(R),Ne;for(ie=0;ie<Se.length;++ie)Ne=Se[ie],Ne!=="removeListener"&&this.removeAllListeners(Ne);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(re=R[P],typeof re=="function")this.removeListener(P,re);else if(re!==void 0)for(ie=re.length-1;ie>=0;ie--)this.removeListener(P,re[ie]);return this};function k(P,re,R){var ie=P._events;if(ie===void 0)return[];var Se=ie[re];return Se===void 0?[]:typeof Se=="function"?R?[Se.listener||Se]:[Se]:R?O(Se):m(Se,Se.length)}s.prototype.listeners=function(P){return k(this,P,!0)},s.prototype.rawListeners=function(P){return k(this,P,!1)},s.listenerCount=function(P,re){return typeof P.listenerCount=="function"?P.listenerCount(re):g.call(P,re)},s.prototype.listenerCount=g;function g(P){var re=this._events;if(re!==void 0){var R=re[P];if(typeof R=="function")return 1;if(R!==void 0)return R.length}return 0}s.prototype.eventNames=function(){return this._eventsCount>0?i(this._events):[]};function m(P,re){for(var R=new Array(re),ie=0;ie<re;++ie)R[ie]=P[ie];return R}function B(P,re){for(;re+1<P.length;re++)P[re]=P[re+1];P.pop()}function O(P){for(var re=new Array(P.length),R=0;R<re.length;++R)re[R]=P[R].listener||P[R];return re}function V(P,re){return new Promise(function(R,ie){function Se(De){P.removeListener(re,Ne),ie(De)}function Ne(){typeof P.removeListener=="function"&&P.removeListener("error",Se),R([].slice.call(arguments))}_e(P,re,Ne,{once:!0}),re!=="error"&&le(P,Se,{once:!0})})}function le(P,re,R){typeof P.on=="function"&&_e(P,"error",re,R)}function _e(P,re,R,ie){if(typeof P.on=="function")ie.once?P.once(re,R):P.on(re,R);else if(typeof P.addEventListener=="function")P.addEventListener(re,function Se(Ne){ie.once&&P.removeEventListener(re,Se),R(Ne)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof P)}}),W0=b((e,t)=>{a(),t.exports=typeof queueMicrotask=="function"?queueMicrotask:r=>Promise.resolve().then(r)}),fs=b(e=>{a();var t=W0();e.fromCallback=function(r,n){if(r===void 0){var i=new Promise(function(o,u){r=function(s,c){s?u(s):o(c)}});r[n!==void 0?n:"promise"]=i}else if(typeof r!="function")throw new TypeError("Callback must be a function");return r},e.fromPromise=function(r,n){if(n===void 0)return r;r.then(function(i){t(()=>n(null,i))}).catch(function(i){t(()=>n(i))})}}),Ec=b(e=>{a(),e.getCallback=function(t,r){return typeof t=="function"?t:r},e.getOptions=function(t,r){return typeof t=="object"&&t!==null?t:r!==void 0?r:{}}}),rn=b(e=>{a();var{fromCallback:t}=fs(),r=Ot(),{getOptions:n,getCallback:i}=Ec(),o=Symbol("promise"),u=Symbol("callback"),s=Symbol("working"),c=Symbol("handleOne"),h=Symbol("handleMany"),y=Symbol("autoClose"),w=Symbol("finishWork"),S=Symbol("returnMany"),d=Symbol("closing"),k=Symbol("handleClose"),g=Symbol("closed"),m=Symbol("closeCallbacks"),B=Symbol("keyEncoding"),O=Symbol("valueEncoding"),V=Symbol("abortOnClose"),le=Symbol("legacy"),_e=Symbol("keys"),P=Symbol("values"),re=Symbol("limit"),R=Symbol("count"),ie=Object.freeze({}),Se=()=>{},Ne=!1,De=class{constructor(Te,U,ce){if(typeof Te!="object"||Te===null){let ae=Te===null?"null":typeof Te;throw new TypeError(`The first argument must be an abstract-level database, received ${ae}`)}if(typeof U!="object"||U===null)throw new TypeError("The second argument must be an options object");this[g]=!1,this[m]=[],this[s]=!1,this[d]=!1,this[y]=!1,this[u]=null,this[c]=this[c].bind(this),this[h]=this[h].bind(this),this[k]=this[k].bind(this),this[B]=U[B],this[O]=U[O],this[le]=ce,this[re]=Number.isInteger(U.limit)&&U.limit>=0?U.limit:1/0,this[R]=0,this[V]=!!U.abortOnClose,this.db=Te,this.db.attachResource(this),this.nextTick=Te.nextTick}get count(){return this[R]}get limit(){return this[re]}next(Te){let U;if(Te===void 0)U=new Promise((ce,ae)=>{Te=(Ie,Re,Ue)=>{Ie?ae(Ie):this[le]?Re===void 0&&Ue===void 0?ce():ce([Re,Ue]):ce(Re)}});else if(typeof Te!="function")throw new TypeError("Callback must be a function");return this[d]?this.nextTick(Te,new r("Iterator is not open: cannot call next() after close()",{code:"LEVEL_ITERATOR_NOT_OPEN"})):this[s]?this.nextTick(Te,new r("Iterator is busy: cannot call next() until previous call has completed",{code:"LEVEL_ITERATOR_BUSY"})):(this[s]=!0,this[u]=Te,this[R]>=this[re]?this.nextTick(this[c],null):this._next(this[c])),U}_next(Te){this.nextTick(Te)}nextv(Te,U,ce){return ce=i(U,ce),ce=t(ce,o),U=n(U,ie),Number.isInteger(Te)?(this[d]?this.nextTick(ce,new r("Iterator is not open: cannot call nextv() after close()",{code:"LEVEL_ITERATOR_NOT_OPEN"})):this[s]?this.nextTick(ce,new r("Iterator is busy: cannot call nextv() until previous call has completed",{code:"LEVEL_ITERATOR_BUSY"})):(Te<1&&(Te=1),this[re]<1/0&&(Te=Math.min(Te,this[re]-this[R])),this[s]=!0,this[u]=ce,Te<=0?this.nextTick(this[h],null,[]):this._nextv(Te,U,this[h])),ce[o]):(this.nextTick(ce,new TypeError("The first argument 'size' must be an integer")),ce[o])}_nextv(Te,U,ce){let ae=[],Ie=(Re,Ue,Je)=>{if(Re)return ce(Re);if(this[le]?Ue===void 0&&Je===void 0:Ue===void 0)return ce(null,ae);ae.push(this[le]?[Ue,Je]:Ue),ae.length===Te?ce(null,ae):this._next(Ie)};this._next(Ie)}all(Te,U){return U=i(Te,U),U=t(U,o),Te=n(Te,ie),this[d]?this.nextTick(U,new r("Iterator is not open: cannot call all() after close()",{code:"LEVEL_ITERATOR_NOT_OPEN"})):this[s]?this.nextTick(U,new r("Iterator is busy: cannot call all() until previous call has completed",{code:"LEVEL_ITERATOR_BUSY"})):(this[s]=!0,this[u]=U,this[y]=!0,this[R]>=this[re]?this.nextTick(this[h],null,[]):this._all(Te,this[h])),U[o]}_all(Te,U){let ce=this[R],ae=[],Ie=()=>{let Ue=this[re]<1/0?Math.min(1e3,this[re]-ce):1e3;Ue<=0?this.nextTick(U,null,ae):this._nextv(Ue,ie,Re)},Re=(Ue,Je)=>{Ue?U(Ue):Je.length===0?U(null,ae):(ae.push.apply(ae,Je),ce+=Je.length,Ie())};Ie()}[w](){let Te=this[u];return this[V]&&Te===null?Se:(this[s]=!1,this[u]=null,this[d]&&this._close(this[k]),Te)}[S](Te,U,ce){this[y]?this.close(Te.bind(null,U,ce)):Te(U,ce)}seek(Te,U){if(U=n(U,ie),!this[d]){if(this[s])throw new r("Iterator is busy: cannot call seek() until next() has completed",{code:"LEVEL_ITERATOR_BUSY"});{let ce=this.db.keyEncoding(U.keyEncoding||this[B]),ae=ce.format;U.keyEncoding!==ae&&(U={...U,keyEncoding:ae});let Ie=this.db.prefixKey(ce.encode(Te),ae);this._seek(Ie,U)}}}_seek(Te,U){throw new r("Iterator does not support seek()",{code:"LEVEL_NOT_SUPPORTED"})}close(Te){return Te=t(Te,o),this[g]?this.nextTick(Te):this[d]?this[m].push(Te):(this[d]=!0,this[m].push(Te),this[s]?this[V]&&this[w]()(new r("Aborted on iterator close()",{code:"LEVEL_ITERATOR_NOT_OPEN"})):this._close(this[k])),Te[o]}_close(Te){this.nextTick(Te)}[k](){this[g]=!0,this.db.detachResource(this);let Te=this[m];this[m]=[];for(let U of Te)U()}async*[Symbol.asyncIterator](){try{let Te;for(;(Te=await this.next())!==void 0;)yield Te}finally{this[g]||await this.close()}}},Ve=class extends De{constructor(Te,U){super(Te,U,!0),this[_e]=U.keys!==!1,this[P]=U.values!==!1}[c](Te,U,ce){let ae=this[w]();if(Te)return ae(Te);try{U=this[_e]&&U!==void 0?this[B].decode(U):void 0,ce=this[P]&&ce!==void 0?this[O].decode(ce):void 0}catch(Ie){return ae(new lt("entry",Ie))}U===void 0&&ce===void 0||this[R]++,ae(null,U,ce)}[h](Te,U){let ce=this[w]();if(Te)return this[S](ce,Te);try{for(let ae of U){let Ie=ae[0],Re=ae[1];ae[0]=this[_e]&&Ie!==void 0?this[B].decode(Ie):void 0,ae[1]=this[P]&&Re!==void 0?this[O].decode(Re):void 0}}catch(ae){return this[S](ce,new lt("entries",ae))}this[R]+=U.length,this[S](ce,null,U)}end(Te){return!Ne&&typeof console<"u"&&(Ne=!0,console.warn(new r("The iterator.end() method was renamed to close() and end() is an alias that will be removed in a future version",{code:"LEVEL_LEGACY"}))),this.close(Te)}},pt=class extends De{constructor(Te,U){super(Te,U,!1)}[c](Te,U){let ce=this[w]();if(Te)return ce(Te);try{U=U!==void 0?this[B].decode(U):void 0}catch(ae){return ce(new lt("key",ae))}U!==void 0&&this[R]++,ce(null,U)}[h](Te,U){let ce=this[w]();if(Te)return this[S](ce,Te);try{for(let ae=0;ae<U.length;ae++){let Ie=U[ae];U[ae]=Ie!==void 0?this[B].decode(Ie):void 0}}catch(ae){return this[S](ce,new lt("keys",ae))}this[R]+=U.length,this[S](ce,null,U)}},gt=class extends De{constructor(Te,U){super(Te,U,!1)}[c](Te,U){let ce=this[w]();if(Te)return ce(Te);try{U=U!==void 0?this[O].decode(U):void 0}catch(ae){return ce(new lt("value",ae))}U!==void 0&&this[R]++,ce(null,U)}[h](Te,U){let ce=this[w]();if(Te)return this[S](ce,Te);try{for(let ae=0;ae<U.length;ae++){let Ie=U[ae];U[ae]=Ie!==void 0?this[O].decode(Ie):void 0}}catch(ae){return this[S](ce,new lt("values",ae))}this[R]+=U.length,this[S](ce,null,U)}},lt=class extends r{constructor(Te,U){super(`Iterator could not decode ${Te}`,{code:"LEVEL_DECODE_ERROR",cause:U})}};for(let Te of["_ended property","_nexting property","_end method"])Object.defineProperty(Ve.prototype,Te.split(" ")[0],{get(){throw new r(`The ${Te} has been removed`,{code:"LEVEL_LEGACY"})},set(){throw new r(`The ${Te} has been removed`,{code:"LEVEL_LEGACY"})}});Ve.keyEncoding=B,Ve.valueEncoding=O,e.AbstractIterator=Ve,e.AbstractKeyIterator=pt,e.AbstractValueIterator=gt}),Q0=b(e=>{a();var{AbstractKeyIterator:t,AbstractValueIterator:r}=rn(),n=Symbol("iterator"),i=Symbol("callback"),o=Symbol("handleOne"),u=Symbol("handleMany"),s=class extends t{constructor(h,y){super(h,y),this[n]=h.iterator({...y,keys:!0,values:!1}),this[o]=this[o].bind(this),this[u]=this[u].bind(this)}},c=class extends r{constructor(h,y){super(h,y),this[n]=h.iterator({...y,keys:!1,values:!0}),this[o]=this[o].bind(this),this[u]=this[u].bind(this)}};for(let h of[s,c]){let y=h===s,w=y?S=>S[0]:S=>S[1];h.prototype._next=function(S){this[i]=S,this[n].next(this[o])},h.prototype[o]=function(S,d,k){let g=this[i];S?g(S):g(null,y?d:k)},h.prototype._nextv=function(S,d,k){this[i]=k,this[n].nextv(S,d,this[u])},h.prototype._all=function(S,d){this[i]=d,this[n].all(S,this[u])},h.prototype[u]=function(S,d){let k=this[i];S?k(S):k(null,d.map(w))},h.prototype._seek=function(S,d){this[n].seek(S,d)},h.prototype._close=function(S){this[n].close(S)}}e.DefaultKeyIterator=s,e.DefaultValueIterator=c}),Y0=b(e=>{a();var{AbstractIterator:t,AbstractKeyIterator:r,AbstractValueIterator:n}=rn(),i=Ot(),o=Symbol("nut"),u=Symbol("undefer"),s=Symbol("factory"),c=class extends t{constructor(w,S){super(w,S),this[o]=null,this[s]=()=>w.iterator(S),this.db.defer(()=>this[u]())}},h=class extends r{constructor(w,S){super(w,S),this[o]=null,this[s]=()=>w.keys(S),this.db.defer(()=>this[u]())}},y=class extends n{constructor(w,S){super(w,S),this[o]=null,this[s]=()=>w.values(S),this.db.defer(()=>this[u]())}};for(let w of[c,h,y])w.prototype[u]=function(){this.db.status==="open"&&(this[o]=this[s]())},w.prototype._next=function(S){this[o]!==null?this[o].next(S):this.db.status==="opening"?this.db.defer(()=>this._next(S)):this.nextTick(S,new i("Iterator is not open: cannot call next() after close()",{code:"LEVEL_ITERATOR_NOT_OPEN"}))},w.prototype._nextv=function(S,d,k){this[o]!==null?this[o].nextv(S,d,k):this.db.status==="opening"?this.db.defer(()=>this._nextv(S,d,k)):this.nextTick(k,new i("Iterator is not open: cannot call nextv() after close()",{code:"LEVEL_ITERATOR_NOT_OPEN"}))},w.prototype._all=function(S,d){this[o]!==null?this[o].all(d):this.db.status==="opening"?this.db.defer(()=>this._all(S,d)):this.nextTick(d,new i("Iterator is not open: cannot call all() after close()",{code:"LEVEL_ITERATOR_NOT_OPEN"}))},w.prototype._seek=function(S,d){this[o]!==null?this[o]._seek(S,d):this.db.status==="opening"&&this.db.defer(()=>this._seek(S,d))},w.prototype._close=function(S){this[o]!==null?this[o].close(S):this.db.status==="opening"?this.db.defer(()=>this._close(S)):this.nextTick(S)};e.DeferredIterator=c,e.DeferredKeyIterator=h,e.DeferredValueIterator=y}),Eh=b(e=>{a();var{fromCallback:t}=fs(),r=Ot(),{getCallback:n,getOptions:i}=Ec(),o=Symbol("promise"),u=Symbol("status"),s=Symbol("operations"),c=Symbol("finishClose"),h=Symbol("closeCallbacks"),y=class{constructor(w){if(typeof w!="object"||w===null){let S=w===null?"null":typeof w;throw new TypeError(`The first argument must be an abstract-level database, received ${S}`)}this[s]=[],this[h]=[],this[u]="open",this[c]=this[c].bind(this),this.db=w,this.db.attachResource(this),this.nextTick=w.nextTick}get length(){return this[s].length}put(w,S,d){if(this[u]!=="open")throw new r("Batch is not open: cannot call put() after write() or close()",{code:"LEVEL_BATCH_NOT_OPEN"});let k=this.db._checkKey(w)||this.db._checkValue(S);if(k)throw k;let g=d&&d.sublevel!=null?d.sublevel:this.db,m=d,B=g.keyEncoding(d&&d.keyEncoding),O=g.valueEncoding(d&&d.valueEncoding),V=B.format;d={...d,keyEncoding:V,valueEncoding:O.format},g!==this.db&&(d.sublevel=null);let le=g.prefixKey(B.encode(w),V),_e=O.encode(S);return this._put(le,_e,d),this[s].push({...m,type:"put",key:w,value:S}),this}_put(w,S,d){}del(w,S){if(this[u]!=="open")throw new r("Batch is not open: cannot call del() after write() or close()",{code:"LEVEL_BATCH_NOT_OPEN"});let d=this.db._checkKey(w);if(d)throw d;let k=S&&S.sublevel!=null?S.sublevel:this.db,g=S,m=k.keyEncoding(S&&S.keyEncoding),B=m.format;return S={...S,keyEncoding:B},k!==this.db&&(S.sublevel=null),this._del(k.prefixKey(m.encode(w),B),S),this[s].push({...g,type:"del",key:w}),this}_del(w,S){}clear(){if(this[u]!=="open")throw new r("Batch is not open: cannot call clear() after write() or close()",{code:"LEVEL_BATCH_NOT_OPEN"});return this._clear(),this[s]=[],this}_clear(){}write(w,S){return S=n(w,S),S=t(S,o),w=i(w),this[u]!=="open"?this.nextTick(S,new r("Batch is not open: cannot call write() after write() or close()",{code:"LEVEL_BATCH_NOT_OPEN"})):this.length===0?this.close(S):(this[u]="writing",this._write(w,d=>{this[u]="closing",this[h].push(()=>S(d)),d||this.db.emit("batch",this[s]),this._close(this[c])})),S[o]}_write(w,S){}close(w){return w=t(w,o),this[u]==="closing"?this[h].push(w):this[u]==="closed"?this.nextTick(w):(this[h].push(w),this[u]!=="writing"&&(this[u]="closing",this._close(this[c]))),w[o]}_close(w){this.nextTick(w)}[c](){this[u]="closed",this.db.detachResource(this);let w=this[h];this[h]=[];for(let S of w)S()}};e.AbstractChainedBatch=y}),tE=b(e=>{a();var{AbstractChainedBatch:t}=Eh(),r=Ot(),n=Symbol("encoded"),i=class extends t{constructor(o){super(o),this[n]=[]}_put(o,u,s){this[n].push({...s,type:"put",key:o,value:u})}_del(o,u){this[n].push({...u,type:"del",key:o})}_clear(){this[n]=[]}_write(o,u){this.db.status==="opening"?this.db.defer(()=>this._write(o,u)):this.db.status==="open"?this[n].length===0?this.nextTick(u):this.db._batch(this[n],o,u):this.nextTick(u,new r("Batch is not open: cannot call write() after write() or close()",{code:"LEVEL_BATCH_NOT_OPEN"}))}};e.DefaultChainedBatch=i}),iE=b((e,t)=>{a();var r=Ot(),n=Object.prototype.hasOwnProperty,i=new Set(["lt","lte","gt","gte"]);t.exports=function(o,u){let s={};for(let c in o)if(!!n.call(o,c)&&!(c==="keyEncoding"||c==="valueEncoding")){if(c==="start"||c==="end")throw new r(`The legacy range option '${c}' has been removed`,{code:"LEVEL_LEGACY"});if(c==="encoding")throw new r("The levelup-style 'encoding' alias has been removed, use 'valueEncoding' instead",{code:"LEVEL_LEGACY"});i.has(c)?s[c]=u.encode(o[c]):s[c]=o[c]}return s.reverse=!!s.reverse,s.limit=Number.isInteger(s.limit)&&s.limit>=0?s.limit:-1,s}}),vh=b((e,t)=>{a();var r;t.exports=typeof queueMicrotask=="function"?queueMicrotask.bind(typeof window<"u"?window:global):n=>(r||(r=Promise.resolve())).then(n).catch(i=>setTimeout(()=>{throw i},0))}),uE=b((e,t)=>{a();var r=vh();t.exports=function(n,...i){i.length===0?r(n):r(()=>n(...i))}}),fE=b(e=>{a();var{AbstractIterator:t,AbstractKeyIterator:r,AbstractValueIterator:n}=rn(),i=Symbol("unfix"),o=Symbol("iterator"),u=Symbol("handleOne"),s=Symbol("handleMany"),c=Symbol("callback"),h=class extends t{constructor(S,d,k,g){super(S,d),this[o]=k,this[i]=g,this[u]=this[u].bind(this),this[s]=this[s].bind(this),this[c]=null}[u](S,d,k){let g=this[c];if(S)return g(S);d!==void 0&&(d=this[i](d)),g(S,d,k)}[s](S,d){let k=this[c];if(S)return k(S);for(let g of d){let m=g[0];m!==void 0&&(g[0]=this[i](m))}k(S,d)}},y=class extends r{constructor(S,d,k,g){super(S,d),this[o]=k,this[i]=g,this[u]=this[u].bind(this),this[s]=this[s].bind(this),this[c]=null}[u](S,d){let k=this[c];if(S)return k(S);d!==void 0&&(d=this[i](d)),k(S,d)}[s](S,d){let k=this[c];if(S)return k(S);for(let g=0;g<d.length;g++){let m=d[g];m!==void 0&&(d[g]=this[i](m))}k(S,d)}},w=class extends n{constructor(S,d,k){super(S,d),this[o]=k}};for(let S of[h,y])S.prototype._next=function(d){this[c]=d,this[o].next(this[u])},S.prototype._nextv=function(d,k,g){this[c]=g,this[o].nextv(d,k,this[s])},S.prototype._all=function(d,k){this[c]=k,this[o].all(d,this[s])};for(let S of[w])S.prototype._next=function(d){this[o].next(d)},S.prototype._nextv=function(d,k,g){this[o].nextv(d,k,g)},S.prototype._all=function(d,k){this[o].all(d,k)};for(let S of[h,y,w])S.prototype._seek=function(d,k){this[o].seek(d,k)},S.prototype._close=function(d){this[o].close(d)};e.AbstractSublevelIterator=h,e.AbstractSublevelKeyIterator=y,e.AbstractSublevelValueIterator=w}),pE=b((e,t)=>{a();var r=Ot(),{Buffer:n}=co()||{},{AbstractSublevelIterator:i,AbstractSublevelKeyIterator:o,AbstractSublevelValueIterator:u}=fE(),s=Symbol("prefix"),c=Symbol("upperBound"),h=Symbol("prefixRange"),y=Symbol("parent"),w=Symbol("unfix"),S=new TextEncoder,d={separator:"!"};t.exports=function({AbstractLevel:V}){class le extends V{static defaults(P){if(typeof P=="string")throw new r("The subleveldown string shorthand for { separator } has been removed",{code:"LEVEL_LEGACY"});if(P&&P.open)throw new r("The subleveldown open option has been removed",{code:"LEVEL_LEGACY"});return P==null?d:P.separator?P:{...P,separator:"!"}}constructor(P,re,R){let{separator:ie,manifest:Se,...Ne}=le.defaults(R);re=O(re,ie);let De=ie.charCodeAt(0)+1,Ve=P[y]||P;if(!S.encode(re).every(lt=>lt>De&&lt<127))throw new r(`Prefix must use bytes > ${De} < ${127}`,{code:"LEVEL_INVALID_PREFIX"});super(k(Ve,Se),Ne);let pt=(P.prefix||"")+ie+re+ie,gt=pt.slice(0,-1)+String.fromCharCode(De);this[y]=Ve,this[s]=new m(pt),this[c]=new m(gt),this[w]=new B,this.nextTick=Ve.nextTick}prefixKey(P,re){if(re==="utf8")return this[s].utf8+P;if(P.byteLength===0)return this[s][re];if(re==="view"){let R=this[s].view,ie=new Uint8Array(R.byteLength+P.byteLength);return ie.set(R,0),ie.set(P,R.byteLength),ie}else{let R=this[s].buffer;return n.concat([R,P],R.byteLength+P.byteLength)}}[h](P,re){P.gte!==void 0?P.gte=this.prefixKey(P.gte,re):P.gt!==void 0?P.gt=this.prefixKey(P.gt,re):P.gte=this[s][re],P.lte!==void 0?P.lte=this.prefixKey(P.lte,re):P.lt!==void 0?P.lt=this.prefixKey(P.lt,re):P.lte=this[c][re]}get prefix(){return this[s].utf8}get db(){return this[y]}_open(P,re){this[y].open({passive:!0},re)}_put(P,re,R,ie){this[y].put(P,re,R,ie)}_get(P,re,R){this[y].get(P,re,R)}_getMany(P,re,R){this[y].getMany(P,re,R)}_del(P,re,R){this[y].del(P,re,R)}_batch(P,re,R){this[y].batch(P,re,R)}_clear(P,re){this[h](P,P.keyEncoding),this[y].clear(P,re)}_iterator(P){this[h](P,P.keyEncoding);let re=this[y].iterator(P),R=this[w].get(this[s].utf8.length,P.keyEncoding);return new i(this,P,re,R)}_keys(P){this[h](P,P.keyEncoding);let re=this[y].keys(P),R=this[w].get(this[s].utf8.length,P.keyEncoding);return new o(this,P,re,R)}_values(P){this[h](P,P.keyEncoding);let re=this[y].values(P);return new u(this,P,re)}}return{AbstractSublevel:le}};var k=function(V,le){return{...V.supports,createIfMissing:!1,errorIfExists:!1,events:{},additionalMethods:{},...le,encodings:{utf8:g(V,"utf8"),buffer:g(V,"buffer"),view:g(V,"view")}}},g=function(V,le){return V.supports.encodings[le]?V.keyEncoding(le).name===le:!1},m=class{constructor(V){this.utf8=V,this.view=S.encode(V),this.buffer=n?n.from(this.view.buffer,0,this.view.byteLength):{}}},B=class{constructor(){this.cache=new Map}get(V,le){let _e=this.cache.get(le);return _e===void 0&&(le==="view"?_e=function(P,re){return re.subarray(P)}.bind(null,V):_e=function(P,re){return re.slice(P)}.bind(null,V),this.cache.set(le,_e)),_e}},O=function(V,le){let _e=0,P=V.length;for(;_e<P&&V[_e]===le;)_e++;for(;P>_e&&V[P-1]===le;)P--;return V.slice(_e,P)}}),kh=b(e=>{a();var{supports:t}=_0(),{Transcoder:r}=L0(),{EventEmitter:n}=V0(),{fromCallback:i}=fs(),o=Ot(),{AbstractIterator:u}=rn(),{DefaultKeyIterator:s,DefaultValueIterator:c}=Q0(),{DeferredIterator:h,DeferredKeyIterator:y,DeferredValueIterator:w}=Y0(),{DefaultChainedBatch:S}=tE(),{getCallback:d,getOptions:k}=Ec(),g=iE(),m=Symbol("promise"),B=Symbol("landed"),O=Symbol("resources"),V=Symbol("closeResources"),le=Symbol("operations"),_e=Symbol("undefer"),P=Symbol("deferOpen"),re=Symbol("options"),R=Symbol("status"),ie=Symbol("defaultOptions"),Se=Symbol("transcoder"),Ne=Symbol("keyEncoding"),De=Symbol("valueEncoding"),Ve=()=>{},pt=class extends n{constructor(U,ce){if(super(),typeof U!="object"||U===null)throw new TypeError("The first argument 'manifest' must be an object");ce=k(ce);let{keyEncoding:ae,valueEncoding:Ie,passive:Re,...Ue}=ce;this[O]=new Set,this[le]=[],this[P]=!0,this[re]=Ue,this[R]="opening",this.supports=t(U,{status:!0,promises:!0,clear:!0,getMany:!0,deferredOpen:!0,snapshots:U.snapshots!==!1,permanence:U.permanence!==!1,keyIterator:!0,valueIterator:!0,iteratorNextv:!0,iteratorAll:!0,encodings:U.encodings||{},events:Object.assign({},U.events,{opening:!0,open:!0,closing:!0,closed:!0,put:!0,del:!0,batch:!0,clear:!0})}),this[Se]=new r(Te(this)),this[Ne]=this[Se].encoding(ae||"utf8"),this[De]=this[Se].encoding(Ie||"utf8");for(let Je of this[Se].encodings())this.supports.encodings[Je.commonName]||(this.supports.encodings[Je.commonName]=!0);this[ie]={empty:Object.freeze({}),entry:Object.freeze({keyEncoding:this[Ne].commonName,valueEncoding:this[De].commonName}),key:Object.freeze({keyEncoding:this[Ne].commonName})},this.nextTick(()=>{this[P]&&this.open({passive:!1},Ve)})}get status(){return this[R]}keyEncoding(U){return this[Se].encoding(U!=null?U:this[Ne])}valueEncoding(U){return this[Se].encoding(U!=null?U:this[De])}open(U,ce){ce=d(U,ce),ce=i(ce,m),U={...this[re],...k(U)},U.createIfMissing=U.createIfMissing!==!1,U.errorIfExists=!!U.errorIfExists;let ae=Ie=>{this[R]==="closing"||this[R]==="opening"?this.once(B,Ie?()=>ae(Ie):ae):this[R]!=="open"?ce(new o("Database is not open",{code:"LEVEL_DATABASE_NOT_OPEN",cause:Ie})):ce()};return U.passive?this[R]==="opening"?this.once(B,ae):this.nextTick(ae):this[R]==="closed"||this[P]?(this[P]=!1,this[R]="opening",this.emit("opening"),this._open(U,Ie=>{if(Ie){this[R]="closed",this[V](()=>{this.emit(B),ae(Ie)}),this[_e]();return}this[R]="open",this[_e](),this.emit(B),this[R]==="open"&&this.emit("open"),this[R]==="open"&&this.emit("ready"),ae()})):this[R]==="open"?this.nextTick(ae):this.once(B,()=>this.open(U,ce)),ce[m]}_open(U,ce){this.nextTick(ce)}close(U){U=i(U,m);let ce=ae=>{this[R]==="opening"||this[R]==="closing"?this.once(B,ae?ce(ae):ce):this[R]!=="closed"?U(new o("Database is not closed",{code:"LEVEL_DATABASE_NOT_CLOSED",cause:ae})):U()};if(this[R]==="open"){this[R]="closing",this.emit("closing");let ae=Ie=>{this[R]="open",this[_e](),this.emit(B),ce(Ie)};this[V](()=>{this._close(Ie=>{if(Ie)return ae(Ie);this[R]="closed",this[_e](),this.emit(B),this[R]==="closed"&&this.emit("closed"),ce()})})}else this[R]==="closed"?this.nextTick(ce):this.once(B,()=>this.close(U));return U[m]}[V](U){if(this[O].size===0)return this.nextTick(U);let ce=this[O].size,ae=!0,Ie=()=>{--ce===0&&(ae?this.nextTick(U):U())};for(let Re of this[O])Re.close(Ie);ae=!1,this[O].clear()}_close(U){this.nextTick(U)}get(U,ce,ae){if(ae=d(ce,ae),ae=i(ae,m),ce=k(ce,this[ie].entry),this[R]==="opening")return this.defer(()=>this.get(U,ce,ae)),ae[m];if(lt(this,ae))return ae[m];let Ie=this._checkKey(U);if(Ie)return this.nextTick(ae,Ie),ae[m];let Re=this.keyEncoding(ce.keyEncoding),Ue=this.valueEncoding(ce.valueEncoding),Je=Re.format,Xe=Ue.format;return(ce.keyEncoding!==Je||ce.valueEncoding!==Xe)&&(ce=Object.assign({},ce,{keyEncoding:Je,valueEncoding:Xe})),this._get(this.prefixKey(Re.encode(U),Je),ce,($e,et)=>{if($e)return($e.code==="LEVEL_NOT_FOUND"||$e.notFound||/NotFound/i.test($e))&&($e.code||($e.code="LEVEL_NOT_FOUND"),$e.notFound||($e.notFound=!0),$e.status||($e.status=404)),ae($e);try{et=Ue.decode(et)}catch(Ge){return ae(new o("Could not decode value",{code:"LEVEL_DECODE_ERROR",cause:Ge}))}ae(null,et)}),ae[m]}_get(U,ce,ae){this.nextTick(ae,new Error("NotFound"))}getMany(U,ce,ae){if(ae=d(ce,ae),ae=i(ae,m),ce=k(ce,this[ie].entry),this[R]==="opening")return this.defer(()=>this.getMany(U,ce,ae)),ae[m];if(lt(this,ae))return ae[m];if(!Array.isArray(U))return this.nextTick(ae,new TypeError("The first argument 'keys' must be an array")),ae[m];if(U.length===0)return this.nextTick(ae,null,[]),ae[m];let Ie=this.keyEncoding(ce.keyEncoding),Re=this.valueEncoding(ce.valueEncoding),Ue=Ie.format,Je=Re.format;(ce.keyEncoding!==Ue||ce.valueEncoding!==Je)&&(ce=Object.assign({},ce,{keyEncoding:Ue,valueEncoding:Je}));let Xe=new Array(U.length);for(let $e=0;$e<U.length;$e++){let et=U[$e],Ge=this._checkKey(et);if(Ge)return this.nextTick(ae,Ge),ae[m];Xe[$e]=this.prefixKey(Ie.encode(et),Ue)}return this._getMany(Xe,ce,($e,et)=>{if($e)return ae($e);try{for(let Ge=0;Ge<et.length;Ge++)et[Ge]!==void 0&&(et[Ge]=Re.decode(et[Ge]))}catch(Ge){return ae(new o(`Could not decode one or more of ${et.length} value(s)`,{code:"LEVEL_DECODE_ERROR",cause:Ge}))}ae(null,et)}),ae[m]}_getMany(U,ce,ae){this.nextTick(ae,null,new Array(U.length).fill(void 0))}put(U,ce,ae,Ie){if(Ie=d(ae,Ie),Ie=i(Ie,m),ae=k(ae,this[ie].entry),this[R]==="opening")return this.defer(()=>this.put(U,ce,ae,Ie)),Ie[m];if(lt(this,Ie))return Ie[m];let Re=this._checkKey(U)||this._checkValue(ce);if(Re)return this.nextTick(Ie,Re),Ie[m];let Ue=this.keyEncoding(ae.keyEncoding),Je=this.valueEncoding(ae.valueEncoding),Xe=Ue.format,$e=Je.format;(ae.keyEncoding!==Xe||ae.valueEncoding!==$e)&&(ae=Object.assign({},ae,{keyEncoding:Xe,valueEncoding:$e}));let et=this.prefixKey(Ue.encode(U),Xe),Ge=Je.encode(ce);return this._put(et,Ge,ae,_t=>{if(_t)return Ie(_t);this.emit("put",U,ce),Ie()}),Ie[m]}_put(U,ce,ae,Ie){this.nextTick(Ie)}del(U,ce,ae){if(ae=d(ce,ae),ae=i(ae,m),ce=k(ce,this[ie].key),this[R]==="opening")return this.defer(()=>this.del(U,ce,ae)),ae[m];if(lt(this,ae))return ae[m];let Ie=this._checkKey(U);if(Ie)return this.nextTick(ae,Ie),ae[m];let Re=this.keyEncoding(ce.keyEncoding),Ue=Re.format;return ce.keyEncoding!==Ue&&(ce=Object.assign({},ce,{keyEncoding:Ue})),this._del(this.prefixKey(Re.encode(U),Ue),ce,Je=>{if(Je)return ae(Je);this.emit("del",U),ae()}),ae[m]}_del(U,ce,ae){this.nextTick(ae)}batch(U,ce,ae){if(!arguments.length){if(this[R]==="opening")return new S(this);if(this[R]!=="open")throw new o("Database is not open",{code:"LEVEL_DATABASE_NOT_OPEN"});return this._chainedBatch()}if(typeof U=="function"?ae=U:ae=d(ce,ae),ae=i(ae,m),ce=k(ce,this[ie].empty),this[R]==="opening")return this.defer(()=>this.batch(U,ce,ae)),ae[m];if(lt(this,ae))return ae[m];if(!Array.isArray(U))return this.nextTick(ae,new TypeError("The first argument 'operations' must be an array")),ae[m];if(U.length===0)return this.nextTick(ae),ae[m];let Ie=new Array(U.length),{keyEncoding:Re,valueEncoding:Ue,...Je}=ce;for(let Xe=0;Xe<U.length;Xe++){if(typeof U[Xe]!="object"||U[Xe]===null)return this.nextTick(ae,new TypeError("A batch operation must be an object")),ae[m];let $e=Object.assign({},U[Xe]);if($e.type!=="put"&&$e.type!=="del")return this.nextTick(ae,new TypeError("A batch operation must have a type property that is 'put' or 'del'")),ae[m];let et=this._checkKey($e.key);if(et)return this.nextTick(ae,et),ae[m];let Ge=$e.sublevel!=null?$e.sublevel:this,_t=Ge.keyEncoding($e.keyEncoding||Re),St=_t.format;if($e.key=Ge.prefixKey(_t.encode($e.key),St),$e.keyEncoding=St,$e.type==="put"){let Ft=this._checkValue($e.value);if(Ft)return this.nextTick(ae,Ft),ae[m];let Lt=Ge.valueEncoding($e.valueEncoding||Ue);$e.value=Lt.encode($e.value),$e.valueEncoding=Lt.format}Ge!==this&&($e.sublevel=null),Ie[Xe]=$e}return this._batch(Ie,Je,Xe=>{if(Xe)return ae(Xe);this.emit("batch",U),ae()}),ae[m]}_batch(U,ce,ae){this.nextTick(ae)}sublevel(U,ce){return this._sublevel(U,gt.defaults(ce))}_sublevel(U,ce){return new gt(this,U,ce)}prefixKey(U,ce){return U}clear(U,ce){if(ce=d(U,ce),ce=i(ce,m),U=k(U,this[ie].empty),this[R]==="opening")return this.defer(()=>this.clear(U,ce)),ce[m];if(lt(this,ce))return ce[m];let ae=U,Ie=this.keyEncoding(U.keyEncoding);return U=g(U,Ie),U.keyEncoding=Ie.format,U.limit===0?this.nextTick(ce):this._clear(U,Re=>{if(Re)return ce(Re);this.emit("clear",ae),ce()}),ce[m]}_clear(U,ce){this.nextTick(ce)}iterator(U){let ce=this.keyEncoding(U&&U.keyEncoding),ae=this.valueEncoding(U&&U.valueEncoding);if(U=g(U,ce),U.keys=U.keys!==!1,U.values=U.values!==!1,U[u.keyEncoding]=ce,U[u.valueEncoding]=ae,U.keyEncoding=ce.format,U.valueEncoding=ae.format,this[R]==="opening")return new h(this,U);if(this[R]!=="open")throw new o("Database is not open",{code:"LEVEL_DATABASE_NOT_OPEN"});return this._iterator(U)}_iterator(U){return new u(this,U)}keys(U){let ce=this.keyEncoding(U&&U.keyEncoding),ae=this.valueEncoding(U&&U.valueEncoding);if(U=g(U,ce),U[u.keyEncoding]=ce,U[u.valueEncoding]=ae,U.keyEncoding=ce.format,U.valueEncoding=ae.format,this[R]==="opening")return new y(this,U);if(this[R]!=="open")throw new o("Database is not open",{code:"LEVEL_DATABASE_NOT_OPEN"});return this._keys(U)}_keys(U){return new s(this,U)}values(U){let ce=this.keyEncoding(U&&U.keyEncoding),ae=this.valueEncoding(U&&U.valueEncoding);if(U=g(U,ce),U[u.keyEncoding]=ce,U[u.valueEncoding]=ae,U.keyEncoding=ce.format,U.valueEncoding=ae.format,this[R]==="opening")return new w(this,U);if(this[R]!=="open")throw new o("Database is not open",{code:"LEVEL_DATABASE_NOT_OPEN"});return this._values(U)}_values(U){return new c(this,U)}defer(U){if(typeof U!="function")throw new TypeError("The first argument must be a function");this[le].push(U)}[_e](){if(this[le].length===0)return;let U=this[le];this[le]=[];for(let ce of U)ce()}attachResource(U){if(typeof U!="object"||U===null||typeof U.close!="function")throw new TypeError("The first argument must be a resource object");this[O].add(U)}detachResource(U){this[O].delete(U)}_chainedBatch(){return new S(this)}_checkKey(U){if(U==null)return new o("Key cannot be null or undefined",{code:"LEVEL_INVALID_KEY"})}_checkValue(U){if(U==null)return new o("Value cannot be null or undefined",{code:"LEVEL_INVALID_VALUE"})}};pt.prototype.nextTick=uE();var{AbstractSublevel:gt}=pE()({AbstractLevel:pt});e.AbstractLevel=pt,e.AbstractSublevel=gt;var lt=function(U,ce){return U[R]!=="open"?(U.nextTick(ce,new o("Database is not open",{code:"LEVEL_DATABASE_NOT_OPEN"})),!0):!1},Te=function(U){return Object.keys(U.supports.encodings).filter(ce=>!!U.supports.encodings[ce])}}),Lh=b(e=>{a(),e.AbstractLevel=kh().AbstractLevel,e.AbstractSublevel=kh().AbstractSublevel,e.AbstractIterator=rn().AbstractIterator,e.AbstractKeyIterator=rn().AbstractKeyIterator,e.AbstractValueIterator=rn().AbstractValueIterator,e.AbstractChainedBatch=Eh().AbstractChainedBatch}),wE=b((e,t)=>{a(),t.exports=n;var r=vh();function n(i,o,u){if(typeof o!="number")throw new Error("second argument must be a Number");let s,c,h,y,w,S=!0,d;Array.isArray(i)?(s=[],h=c=i.length):(y=Object.keys(i),s={},h=c=y.length);function k(m){function B(){u&&u(m,s),u=null}S?r(B):B()}function g(m,B,O){if(s[m]=O,B&&(w=!0),--h===0||B)k(B);else if(!w&&d<c){let V;y?(V=y[d],d+=1,i[V](function(le,_e){g(V,le,_e)})):(V=d,d+=1,i[V](function(le,_e){g(V,le,_e)}))}}d=o,h?y?y.some(function(m,B){return i[m](function(O,V){g(m,O,V)}),B===o-1}):i.some(function(m,B){return m(function(O,V){g(B,O,V)}),B===o-1}):k(null),S=!1}}),Rh=b((e,t)=>{a(),t.exports=function(r){let n=r.gte!==void 0?r.gte:r.gt!==void 0?r.gt:void 0,i=r.lte!==void 0?r.lte:r.lt!==void 0?r.lt:void 0,o=r.gte===void 0,u=r.lte===void 0;return n!==void 0&&i!==void 0?IDBKeyRange.bound(n,i,o,u):n!==void 0?IDBKeyRange.lowerBound(n,o):i!==void 0?IDBKeyRange.upperBound(i,u):null}}),Nh=b((e,t)=>{a();var r=new TextEncoder;t.exports=function(n){return n instanceof Uint8Array?n:n instanceof ArrayBuffer?new Uint8Array(n):r.encode(n)}}),SE=b(e=>{a();var{AbstractIterator:t}=Lh(),r=Rh(),n=Nh(),i=Symbol("cache"),o=Symbol("finished"),u=Symbol("options"),s=Symbol("currentOptions"),c=Symbol("position"),h=Symbol("location"),y=Symbol("first"),w={},S=class extends t{constructor(k,g,m){super(k,m),this[i]=[],this[o]=this.limit===0,this[u]=m,this[s]={...m},this[c]=void 0,this[h]=g,this[y]=!0}_nextv(k,g,m){if(this[y]=!1,this[o])return this.nextTick(m,null,[]);if(this[i].length>0)return k=Math.min(k,this[i].length),this.nextTick(m,null,this[i].splice(0,k));this[c]!==void 0&&(this[u].reverse?(this[s].lt=this[c],this[s].lte=void 0):(this[s].gt=this[c],this[s].gte=void 0));let B;try{B=r(this[s])}catch{return this[o]=!0,this.nextTick(m,null,[])}let O=this.db.db.transaction([this[h]],"readonly"),V=O.objectStore(this[h]),le=[];if(this[u].reverse){let _e=!this[u].values&&V.openKeyCursor?"openKeyCursor":"openCursor";V[_e](B,"prev").onsuccess=P=>{let re=P.target.result;if(re){let{key:R,value:ie}=re;this[c]=R,le.push([this[u].keys&&R!==void 0?n(R):void 0,this[u].values&&ie!==void 0?n(ie):void 0]),le.length<k?re.continue():d(O)}else this[o]=!0}}else{let _e,P,re=()=>{if(_e===void 0||P===void 0)return;let R=Math.max(_e.length,P.length);R===0||k===1/0?this[o]=!0:this[c]=_e[R-1],le.length=R;for(let ie=0;ie<R;ie++){let Se=_e[ie],Ne=P[ie];le[ie]=[this[u].keys&&Se!==void 0?n(Se):void 0,this[u].values&&Ne!==void 0?n(Ne):void 0]}d(O)};this[u].keys||k<1/0?V.getAllKeys(B,k<1/0?k:void 0).onsuccess=R=>{_e=R.target.result,re()}:(_e=[],this.nextTick(re)),this[u].values?V.getAll(B,k<1/0?k:void 0).onsuccess=R=>{P=R.target.result,re()}:(P=[],this.nextTick(re))}O.onabort=()=>{m(O.error||new Error("aborted by user")),m=null},O.oncomplete=()=>{m(null,le),m=null}}_next(k){if(this[i].length>0){let[g,m]=this[i].shift();this.nextTick(k,null,g,m)}else if(this[o])this.nextTick(k);else{let g=Math.min(100,this.limit-this.count);this[y]&&(this[y]=!1,g=1),this._nextv(g,w,(m,B)=>{if(m)return k(m);this[i]=B,this._next(k)})}}_all(k,g){this[y]=!1;let m=this[i].splice(0,this[i].length),B=this.limit-this.count-m.length;if(B<=0)return this.nextTick(g,null,m);this._nextv(B,w,(O,V)=>{if(O)return g(O);m.length>0&&(V=m.concat(V)),g(null,V)})}_seek(k,g){this[y]=!0,this[i]=[],this[o]=!1,this[c]=void 0,this[s]={...this[u]};let m;try{m=r(this[u])}catch{this[o]=!0;return}m!==null&&!m.includes(k)?this[o]=!0:this[u].reverse?this[s].lte=k:this[s].gte=k}};e.Iterator=S;function d(k){typeof k.commit=="function"&&k.commit()}}),TE=b((e,t)=>{a(),t.exports=function(r,n,i,o,u){if(o.limit===0)return r.nextTick(u);let s=r.db.transaction([n],"readwrite"),c=s.objectStore(n),h=0;s.oncomplete=function(){u()},s.onabort=function(){u(s.error||new Error("aborted by user"))};let y=c.openKeyCursor?"openKeyCursor":"openCursor",w=o.reverse?"prev":"next";c[y](i,w).onsuccess=function(S){let d=S.target.result;d&&(c.delete(d.key).onsuccess=function(){(o.limit<=0||++h<o.limit)&&d.continue()})}}}),LE=b(e=>{a();var{AbstractLevel:t}=Lh(),r=Ot(),n=wE(),{fromCallback:i}=fs(),{Iterator:o}=SE(),u=Nh(),s=TE(),c=Rh(),h="level-js-",y=Symbol("idb"),w=Symbol("namePrefix"),S=Symbol("location"),d=Symbol("version"),k=Symbol("store"),g=Symbol("onComplete"),m=Symbol("promise"),B=class extends t{constructor(O,V,le){if(typeof V=="function"||typeof le=="function")throw new r("The levelup-style callback argument has been removed",{code:"LEVEL_LEGACY"});let{prefix:_e,version:P,...re}=V||{};if(super({encodings:{view:!0},snapshots:!1,createIfMissing:!1,errorIfExists:!1,seek:!0},re),typeof O!="string")throw new Error("constructor requires a location string argument");this[S]=O,this[w]=_e!=null?_e:h,this[d]=parseInt(P||1,10),this[y]=null}get location(){return this[S]}get namePrefix(){return this[w]}get version(){return this[d]}get db(){return this[y]}get type(){return"browser-level"}_open(O,V){let le=indexedDB.open(this[w]+this[S],this[d]);le.onerror=function(){V(le.error||new Error("unknown error"))},le.onsuccess=()=>{this[y]=le.result,V()},le.onupgradeneeded=_e=>{let P=_e.target.result;P.objectStoreNames.contains(this[S])||P.createObjectStore(this[S])}}[k](O){return this[y].transaction([this[S]],O).objectStore(this[S])}[g](O,V){let le=O.transaction;le.onabort=function(){V(le.error||new Error("aborted by user"))},le.oncomplete=function(){V(null,O.result)}}_get(O,V,le){let _e=this[k]("readonly"),P;try{P=_e.get(O)}catch(re){return this.nextTick(le,re)}this[g](P,function(re,R){if(re)return le(re);if(R===void 0)return le(new r("Entry not found",{code:"LEVEL_NOT_FOUND"}));le(null,u(R))})}_getMany(O,V,le){let _e=this[k]("readonly"),P=O.map(re=>R=>{let ie;try{ie=_e.get(re)}catch(Se){return R(Se)}ie.onsuccess=()=>{let Se=ie.result;R(null,Se===void 0?Se:u(Se))},ie.onerror=Se=>{Se.stopPropagation(),R(ie.error)}});n(P,16,le)}_del(O,V,le){let _e=this[k]("readwrite"),P;try{P=_e.delete(O)}catch(re){return this.nextTick(le,re)}this[g](P,le)}_put(O,V,le,_e){let P=this[k]("readwrite"),re;try{re=P.put(V,O)}catch(R){return this.nextTick(_e,R)}this[g](re,_e)}_iterator(O){return new o(this,this[S],O)}_batch(O,V,le){let _e=this[k]("readwrite"),P=_e.transaction,re=0,R;P.onabort=function(){le(R||P.error||new Error("aborted by user"))},P.oncomplete=function(){le()};function ie(){let Se=O[re++],Ne=Se.key,De;try{De=Se.type==="del"?_e.delete(Ne):_e.put(Se.value,Ne)}catch(Ve){R=Ve,P.abort();return}re<O.length?De.onsuccess=ie:typeof P.commit=="function"&&P.commit()}ie()}_clear(O,V){let le,_e;try{le=c(O)}catch{return this.nextTick(V)}if(O.limit>=0)return s(this,this[S],le,O,V);try{let P=this[k]("readwrite");_e=le?P.delete(le):P.clear()}catch(P){return this.nextTick(V,P)}this[g](_e,V)}_close(O){this[y].close(),this.nextTick(O)}};B.destroy=function(O,V,le){typeof V=="function"&&(le=V,V=h),le=i(le,m);let _e=indexedDB.deleteDatabase(V+O);return _e.onsuccess=function(){le()},_e.onerror=function(P){le(P)},le[m]},e.BrowserLevel=B}),NE=b(e=>{a(),e.Level=LE().BrowserLevel}),VE=b((e,t)=>{a(),t.exports=function(){return Date.now()}}),WE=b((e,t)=>{a();var r=VE(),n=class{constructor(o,u,s){let c=this;this._started=r(),this._rescheduled=0,this._scheduled=u,this._args=s,this._triggered=!1,this._timerWrapper=()=>{c._rescheduled>0?(c._scheduled=c._rescheduled-(r()-c._started),c._schedule(c._scheduled)):(c._triggered=!0,o.apply(null,c._args))},this._timer=setTimeout(this._timerWrapper,u)}reschedule(o){o||(o=this._scheduled);let u=r();u+o-(this._started+this._scheduled)<0?(clearTimeout(this._timer),this._schedule(o)):this._triggered?this._schedule(o):(this._started=u,this._rescheduled=o)}_schedule(o){this._triggered=!1,this._started=r(),this._rescheduled=0,this._scheduled=o,this._timer=setTimeout(this._timerWrapper,o)}clear(){clearTimeout(this._timer)}};function i(){if(typeof arguments[0]!="function")throw new Error("callback needed");if(typeof arguments[1]!="number")throw new Error("timeout needed");let o;if(arguments.length>0){o=new Array(arguments.length-2);for(var u=0;u<o.length;u++)o[u]=arguments[u+2]}return new n(arguments[0],arguments[1],o)}t.exports=i}),JE=b((e,t)=>{a();var{AbortController:r}=globalThis,n=WE(),i=class extends r{constructor(o){super(),this._ms=o,this._timer=n(()=>this.abort(),o),Object.setPrototypeOf(this,i.prototype)}abort(){return this._timer.clear(),super.abort()}clear(){this._timer.clear()}reset(){this._timer.clear(),this._timer=n(()=>this.abort(),this._ms)}};t.exports={TimeoutController:i}}),YE=b((e,t)=>{a();function r(n){let i=new globalThis.AbortController;function o(){i.abort();for(let u of n)!u||!u.removeEventListener||u.removeEventListener("abort",o)}for(let u of n)if(!(!u||!u.addEventListener)){if(u.aborted){o();break}u.addEventListener("abort",o)}return i.signal}t.exports=r,t.exports.anySignal=r}),ox=b((e,t)=>{a();var r=async n=>{let i;for await(let o of n)i=o;return i};t.exports=r}),Sd=b((e,t)=>{a();var r=typeof navigator<"u"&&navigator.product==="ReactNative";function n(){return r?"http://localhost":self.location?self.location.protocol+"//"+self.location.host:""}var i=self.URL,o=n(),u=class{constructor(c="",h=o){this.super=new i(c,h),this.path=this.pathname+this.search,this.auth=this.username&&this.password?this.username+":"+this.password:null,this.query=this.search&&this.search.startsWith("?")?this.search.slice(1):null}get hash(){return this.super.hash}get host(){return this.super.host}get hostname(){return this.super.hostname}get href(){return this.super.href}get origin(){return this.super.origin}get password(){return this.super.password}get pathname(){return this.super.pathname}get port(){return this.super.port}get protocol(){return this.super.protocol}get search(){return this.super.search}get searchParams(){return this.super.searchParams}get username(){return this.super.username}set hash(c){this.super.hash=c}set host(c){this.super.host=c}set hostname(c){this.super.hostname=c}set href(c){this.super.href=c}set password(c){this.super.password=c}set pathname(c){this.super.pathname=c}set port(c){this.super.port=c}set protocol(c){this.super.protocol=c}set search(c){this.super.search=c}set username(c){this.super.username=c}static createObjectURL(c){return i.createObjectURL(c)}static revokeObjectURL(c){i.revokeObjectURL(c)}toJSON(){return this.super.toJSON()}toString(){return this.super.toString()}format(){return this.toString()}};function s(c){if(typeof c=="string")return new i(c).toString();if(!(c instanceof i)){let h=c.username&&c.password?`${c.username}:${c.password}@`:"",y=c.auth?c.auth+"@":"",w=c.port?":"+c.port:"",S=c.protocol?c.protocol+"//":"",d=c.host||"",k=c.hostname||"",g=c.search||(c.query?"?"+c.query:""),m=c.hash||"",B=c.pathname||"",O=c.path||B+g;return`${S}${h||y}${d||k+w}${O}${m}`}}t.exports={URLWithLegacySupport:u,URLSearchParams:self.URLSearchParams,defaultBase:o,format:s}}),Wx=b((e,t)=>{a();var{URLWithLegacySupport:r,format:n}=Sd();t.exports=(i,o={},u={},s)=>{let c=o.protocol?o.protocol.replace(":",""):"http";c=(u[c]||s||c)+":";let h;try{h=new r(i)}catch{h={}}let y=Object.assign({},o,{protocol:c||h.protocol,host:o.host||h.host});return new r(i,n(y)).toString()}}),Gx=b((e,t)=>{a();var{URLWithLegacySupport:r,format:n,URLSearchParams:i,defaultBase:o}=Sd(),u=Wx();t.exports={URL:r,URLSearchParams:i,format:n,relative:u,defaultBase:o}}),n1=b((e,t)=>{a();function r(n){let[i,o]=n[Symbol.asyncIterator]?[n[Symbol.asyncIterator](),Symbol.asyncIterator]:[n[Symbol.iterator](),Symbol.iterator],u=[];return{peek:()=>i.next(),push:s=>{u.push(s)},next:()=>u.length?{done:!1,value:u.shift()}:i.next(),[o](){return this}}}t.exports=r});a();a();a();var vo=x(ke(),1);a();a();a();var _v=["string","number","bigint","symbol"],Dv=["Function","Generator","AsyncGenerator","GeneratorFunction","AsyncGeneratorFunction","AsyncFunction","Observable","Array","Buffer","Object","RegExp","Date","Error","Map","Set","WeakMap","WeakSet","ArrayBuffer","SharedArrayBuffer","DataView","Promise","URL","HTMLElement","Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array","BigInt64Array","BigUint64Array"];function lp(e){if(e===null)return"null";if(e===void 0)return"undefined";if(e===!0||e===!1)return"boolean";let t=typeof e;return _v.includes(t)?t:t==="function"?"Function":Array.isArray(e)?"Array":Sv(e)?"Buffer":Av(e)||"Object"}function Sv(e){return e&&e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer.call(null,e)}function Av(e){let t=Object.prototype.toString.call(e).slice(8,-1);if(Dv.includes(t))return t}a();var p=class{constructor(e,t,r){this.major=e,this.majorEncoded=e<<5,this.name=t,this.terminal=r}toString(){return`Type[${this.major}].${this.name}`}compare(e){return this.major<e.major?-1:this.major>e.major?1:0}};p.uint=new p(0,"uint",!0);p.negint=new p(1,"negint",!0);p.bytes=new p(2,"bytes",!0);p.string=new p(3,"string",!0);p.array=new p(4,"array",!1);p.map=new p(5,"map",!1);p.tag=new p(6,"tag",!1);p.float=new p(7,"float",!0);p.false=new p(7,"false",!0);p.true=new p(7,"true",!0);p.null=new p(7,"null",!0);p.undefined=new p(7,"undefined",!0);p.break=new p(7,"break",!0);var v=class{constructor(e,t,r){this.type=e,this.value=t,this.encodedLength=r,this.encodedBytes=void 0,this.byteValue=void 0}toString(){return`Token[${this.type}].${this.value}`}};a();a();var si=globalThis.process&&!globalThis.process.browser&&globalThis.Buffer&&typeof globalThis.Buffer.isBuffer=="function",Tv=new TextDecoder,Cv=new TextEncoder;function js(e){return si&&globalThis.Buffer.isBuffer(e)}function Su(e){return e instanceof Uint8Array?js(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e:Uint8Array.from(e)}var yp=si?(e,t,r)=>r-t>64?globalThis.Buffer.from(e.subarray(t,r)).toString("utf8"):dp(e,t,r):(e,t,r)=>r-t>64?Tv.decode(e.subarray(t,r)):dp(e,t,r),mp=si?e=>e.length>64?globalThis.Buffer.from(e):hp(e):e=>e.length>64?Cv.encode(e):hp(e),$t=e=>Uint8Array.from(e),ai=si?(e,t,r)=>js(e)?new Uint8Array(e.subarray(t,r)):e.slice(t,r):(e,t,r)=>e.slice(t,r),gp=si?(e,t)=>(e=e.map(r=>r instanceof Uint8Array?r:globalThis.Buffer.from(r)),Su(globalThis.Buffer.concat(e,t))):(e,t)=>{let r=new Uint8Array(t),n=0;for(let i of e)n+i.length>r.length&&(i=i.subarray(0,r.length-n)),r.set(i,n),n+=i.length;return r},wp=si?e=>globalThis.Buffer.allocUnsafe(e):e=>new Uint8Array(e);function bp(e,t){if(js(e)&&js(t))return e.compare(t);for(let r=0;r<e.length;r++)if(e[r]!==t[r])return e[r]<t[r]?-1:1;return 0}function hp(e,t=1/0){let r,n=e.length,i=null,o=[];for(let u=0;u<n;++u){if(r=e.charCodeAt(u),r>55295&&r<57344){if(!i){if(r>56319){(t-=3)>-1&&o.push(239,191,189);continue}else if(u+1===n){(t-=3)>-1&&o.push(239,191,189);continue}i=r;continue}if(r<56320){(t-=3)>-1&&o.push(239,191,189),i=r;continue}r=(i-55296<<10|r-56320)+65536}else i&&(t-=3)>-1&&o.push(239,191,189);if(i=null,r<128){if((t-=1)<0)break;o.push(r)}else if(r<2048){if((t-=2)<0)break;o.push(r>>6|192,r&63|128)}else if(r<65536){if((t-=3)<0)break;o.push(r>>12|224,r>>6&63|128,r&63|128)}else if(r<1114112){if((t-=4)<0)break;o.push(r>>18|240,r>>12&63|128,r>>6&63|128,r&63|128)}else throw new Error("Invalid code point")}return o}function dp(e,t,r){let n=[];for(;t<r;){let i=e[t],o=null,u=i>239?4:i>223?3:i>191?2:1;if(t+u<=r){let s,c,h,y;switch(u){case 1:i<128&&(o=i);break;case 2:s=e[t+1],(s&192)===128&&(y=(i&31)<<6|s&63,y>127&&(o=y));break;case 3:s=e[t+1],c=e[t+2],(s&192)===128&&(c&192)===128&&(y=(i&15)<<12|(s&63)<<6|c&63,y>2047&&(y<55296||y>57343)&&(o=y));break;case 4:s=e[t+1],c=e[t+2],h=e[t+3],(s&192)===128&&(c&192)===128&&(h&192)===128&&(y=(i&15)<<18|(s&63)<<12|(c&63)<<6|h&63,y>65535&&y<1114112&&(o=y))}}o===null?(o=65533,u=1):o>65535&&(o-=65536,n.push(o>>>10&1023|55296),o=56320|o&1023),n.push(o),t+=u}return Iv(n)}var pp=4096;function Iv(e){let t=e.length;if(t<=pp)return String.fromCharCode.apply(String,e);let r="",n=0;for(;n<t;)r+=String.fromCharCode.apply(String,e.slice(n,n+=pp));return r}var Ov=256,uo=class{constructor(e=Ov){this.chunkSize=e,this.cursor=0,this.maxCursor=-1,this.chunks=[],this._initReuseChunk=null}reset(){this.cursor=0,this.maxCursor=-1,this.chunks.length&&(this.chunks=[]),this._initReuseChunk!==null&&(this.chunks.push(this._initReuseChunk),this.maxCursor=this._initReuseChunk.length-1)}push(e){let t=this.chunks[this.chunks.length-1];if(this.cursor+e.length<=this.maxCursor+1){let r=t.length-(this.maxCursor-this.cursor)-1;t.set(e,r)}else{if(t){let r=t.length-(this.maxCursor-this.cursor)-1;r<t.length&&(this.chunks[this.chunks.length-1]=t.subarray(0,r),this.maxCursor=this.cursor-1)}e.length<64&&e.length<this.chunkSize?(t=wp(this.chunkSize),this.chunks.push(t),this.maxCursor+=t.length,this._initReuseChunk===null&&(this._initReuseChunk=t),t.set(e,0)):(this.chunks.push(e),this.maxCursor+=e.length)}this.cursor+=e.length}toBytes(e=!1){let t;if(this.chunks.length===1){let r=this.chunks[0];e&&this.cursor>r.length/2?(t=this.cursor===r.length?r:r.subarray(0,this.cursor),this._initReuseChunk=null,this.chunks=[]):t=ai(r,0,this.cursor)}else t=gp(this.chunks,this.cursor);return e&&this.reset(),t}};a();var I="CBOR decode error:",Au="CBOR encode error:";function rr(e,t,r){if(e.length-t<r)throw new Error(`${I} not enough data for type`)}a();a();var he=[24,256,65536,4294967296,BigInt("18446744073709551616")];function Me(e,t,r){rr(e,t,1);let n=e[t];if(r.strict===!0&&n<he[0])throw new Error(`${I} integer encoded in more bytes than necessary (strict decode)`);return n}function je(e,t,r){rr(e,t,2);let n=e[t]<<8|e[t+1];if(r.strict===!0&&n<he[1])throw new Error(`${I} integer encoded in more bytes than necessary (strict decode)`);return n}function ze(e,t,r){rr(e,t,4);let n=e[t]*16777216+(e[t+1]<<16)+(e[t+2]<<8)+e[t+3];if(r.strict===!0&&n<he[2])throw new Error(`${I} integer encoded in more bytes than necessary (strict decode)`);return n}function qe(e,t,r){rr(e,t,8);let n=e[t]*16777216+(e[t+1]<<16)+(e[t+2]<<8)+e[t+3],i=e[t+4]*16777216+(e[t+5]<<16)+(e[t+6]<<8)+e[t+7],o=(BigInt(n)<<BigInt(32))+BigInt(i);if(r.strict===!0&&o<he[3])throw new Error(`${I} integer encoded in more bytes than necessary (strict decode)`);if(o<=Number.MAX_SAFE_INTEGER)return Number(o);if(r.allowBigInt===!0)return o;throw new Error(`${I} integers outside of the safe integer range are not supported`)}function Ep(e,t,r,n){return new v(p.uint,Me(e,t+1,n),2)}function xp(e,t,r,n){return new v(p.uint,je(e,t+1,n),3)}function vp(e,t,r,n){return new v(p.uint,ze(e,t+1,n),5)}function _p(e,t,r,n){return new v(p.uint,qe(e,t+1,n),9)}function tt(e,t){return ge(e,0,t.value)}function ge(e,t,r){if(r<he[0]){let n=Number(r);e.push([t|n])}else if(r<he[1]){let n=Number(r);e.push([t|24,n])}else if(r<he[2]){let n=Number(r);e.push([t|25,n>>>8,n&255])}else if(r<he[3]){let n=Number(r);e.push([t|26,n>>>24&255,n>>>16&255,n>>>8&255,n&255])}else{let n=BigInt(r);if(n<he[4]){let i=[t|27,0,0,0,0,0,0,0],o=Number(n&BigInt(4294967295)),u=Number(n>>BigInt(32)&BigInt(4294967295));i[8]=o&255,o=o>>8,i[7]=o&255,o=o>>8,i[6]=o&255,o=o>>8,i[5]=o&255,i[4]=u&255,u=u>>8,i[3]=u&255,u=u>>8,i[2]=u&255,u=u>>8,i[1]=u&255,e.push(i)}else throw new Error(`${I} encountered BigInt larger than allowable range`)}}tt.encodedSize=function(e){return ge.encodedSize(e.value)};ge.encodedSize=function(e){return e<he[0]?1:e<he[1]?2:e<he[2]?3:e<he[3]?5:9};tt.compareTokens=function(e,t){return e.value<t.value?-1:e.value>t.value?1:0};a();function Dp(e,t,r,n){return new v(p.negint,-1-Me(e,t+1,n),2)}function Sp(e,t,r,n){return new v(p.negint,-1-je(e,t+1,n),3)}function Ap(e,t,r,n){return new v(p.negint,-1-ze(e,t+1,n),5)}var Tu=BigInt(-1),Tp=BigInt(1);function Cp(e,t,r,n){let i=qe(e,t+1,n);if(typeof i!="bigint"){let o=-1-i;if(o>=Number.MIN_SAFE_INTEGER)return new v(p.negint,o,9)}if(n.allowBigInt!==!0)throw new Error(`${I} integers outside of the safe integer range are not supported`);return new v(p.negint,Tu-BigInt(i),9)}function zs(e,t){let r=t.value,n=typeof r=="bigint"?r*Tu-Tp:r*-1-1;ge(e,t.type.majorEncoded,n)}zs.encodedSize=function(e){let t=e.value,r=typeof t=="bigint"?t*Tu-Tp:t*-1-1;return r<he[0]?1:r<he[1]?2:r<he[2]?3:r<he[3]?5:9};zs.compareTokens=function(e,t){return e.value<t.value?1:e.value>t.value?-1:0};a();function lo(e,t,r,n){rr(e,t,r+n);let i=ai(e,t+r,t+r+n);return new v(p.bytes,i,r+n)}function Ip(e,t,r,n){return lo(e,t,1,r)}function Op(e,t,r,n){return lo(e,t,2,Me(e,t+1,n))}function Bp(e,t,r,n){return lo(e,t,3,je(e,t+1,n))}function kp(e,t,r,n){return lo(e,t,5,ze(e,t+1,n))}function Lp(e,t,r,n){let i=qe(e,t+1,n);if(typeof i=="bigint")throw new Error(`${I} 64-bit integer bytes lengths not supported`);return lo(e,t,9,i)}function qs(e){return e.encodedBytes===void 0&&(e.encodedBytes=e.type===p.string?mp(e.value):e.value),e.encodedBytes}function ci(e,t){let r=qs(t);ge(e,t.type.majorEncoded,r.length),e.push(r)}ci.encodedSize=function(e){let t=qs(e);return ge.encodedSize(t.length)+t.length};ci.compareTokens=function(e,t){return kv(qs(e),qs(t))};function kv(e,t){return e.length<t.length?-1:e.length>t.length?1:bp(e,t)}a();function ho(e,t,r,n,i){let o=r+n;rr(e,t,o);let u=new v(p.string,yp(e,t+r,t+o),o);return i.retainStringBytes===!0&&(u.byteValue=ai(e,t+r,t+o)),u}function Rp(e,t,r,n){return ho(e,t,1,r,n)}function Np(e,t,r,n){return ho(e,t,2,Me(e,t+1,n),n)}function Pp(e,t,r,n){return ho(e,t,3,je(e,t+1,n),n)}function Fp(e,t,r,n){return ho(e,t,5,ze(e,t+1,n),n)}function Up(e,t,r,n){let i=qe(e,t+1,n);if(typeof i=="bigint")throw new Error(`${I} 64-bit integer string lengths not supported`);return ho(e,t,9,i,n)}var $p=ci;a();function ui(e,t,r,n){return new v(p.array,n,r)}function Mp(e,t,r,n){return ui(e,t,1,r)}function jp(e,t,r,n){return ui(e,t,2,Me(e,t+1,n))}function zp(e,t,r,n){return ui(e,t,3,je(e,t+1,n))}function qp(e,t,r,n){return ui(e,t,5,ze(e,t+1,n))}function Vp(e,t,r,n){let i=qe(e,t+1,n);if(typeof i=="bigint")throw new Error(`${I} 64-bit integer array lengths not supported`);return ui(e,t,9,i)}function Kp(e,t,r,n){if(n.allowIndefinite===!1)throw new Error(`${I} indefinite length items not allowed`);return ui(e,t,1,1/0)}function Vs(e,t){ge(e,p.array.majorEncoded,t.value)}Vs.compareTokens=tt.compareTokens;Vs.encodedSize=function(e){return ge.encodedSize(e.value)};a();function fi(e,t,r,n){return new v(p.map,n,r)}function Wp(e,t,r,n){return fi(e,t,1,r)}function Hp(e,t,r,n){return fi(e,t,2,Me(e,t+1,n))}function Gp(e,t,r,n){return fi(e,t,3,je(e,t+1,n))}function Jp(e,t,r,n){return fi(e,t,5,ze(e,t+1,n))}function Qp(e,t,r,n){let i=qe(e,t+1,n);if(typeof i=="bigint")throw new Error(`${I} 64-bit integer map lengths not supported`);return fi(e,t,9,i)}function Yp(e,t,r,n){if(n.allowIndefinite===!1)throw new Error(`${I} indefinite length items not allowed`);return fi(e,t,1,1/0)}function Ks(e,t){ge(e,p.map.majorEncoded,t.value)}Ks.compareTokens=tt.compareTokens;Ks.encodedSize=function(e){return ge.encodedSize(e.value)};a();function Xp(e,t,r,n){return new v(p.tag,r,1)}function Zp(e,t,r,n){return new v(p.tag,Me(e,t+1,n),2)}function ey(e,t,r,n){return new v(p.tag,je(e,t+1,n),3)}function ty(e,t,r,n){return new v(p.tag,ze(e,t+1,n),5)}function ry(e,t,r,n){return new v(p.tag,qe(e,t+1,n),9)}function Ws(e,t){ge(e,p.tag.majorEncoded,t.value)}Ws.compareTokens=tt.compareTokens;Ws.encodedSize=function(e){return ge.encodedSize(e.value)};a();var Uv=20,$v=21,Mv=22,jv=23;function ny(e,t,r,n){if(n.allowUndefined===!1)throw new Error(`${I} undefined values are not supported`);return n.coerceUndefinedToNull===!0?new v(p.null,null,1):new v(p.undefined,void 0,1)}function iy(e,t,r,n){if(n.allowIndefinite===!1)throw new Error(`${I} indefinite length items not allowed`);return new v(p.break,void 0,1)}function Cu(e,t,r){if(r){if(r.allowNaN===!1&&Number.isNaN(e))throw new Error(`${I} NaN values are not supported`);if(r.allowInfinity===!1&&(e===1/0||e===-1/0))throw new Error(`${I} Infinity values are not supported`)}return new v(p.float,e,t)}function oy(e,t,r,n){return Cu(Iu(e,t+1),3,n)}function sy(e,t,r,n){return Cu(Ou(e,t+1),5,n)}function ay(e,t,r,n){return Cu(ly(e,t+1),9,n)}function Hs(e,t,r){let n=t.value;if(n===!1)e.push([p.float.majorEncoded|Uv]);else if(n===!0)e.push([p.float.majorEncoded|$v]);else if(n===null)e.push([p.float.majorEncoded|Mv]);else if(n===void 0)e.push([p.float.majorEncoded|jv]);else{let i,o=!1;(!r||r.float64!==!0)&&(uy(n),i=Iu(wt,1),n===i||Number.isNaN(n)?(wt[0]=249,e.push(wt.slice(0,3)),o=!0):(fy(n),i=Ou(wt,1),n===i&&(wt[0]=250,e.push(wt.slice(0,5)),o=!0))),o||(zv(n),i=ly(wt,1),wt[0]=251,e.push(wt.slice(0,9)))}}Hs.encodedSize=function(e,t){let r=e.value;if(r===!1||r===!0||r===null||r===void 0)return 1;if(!t||t.float64!==!0){uy(r);let n=Iu(wt,1);if(r===n||Number.isNaN(r))return 3;if(fy(r),n=Ou(wt,1),r===n)return 5}return 9};var cy=new ArrayBuffer(9),rt=new DataView(cy,1),wt=new Uint8Array(cy,0);function uy(e){if(e===1/0)rt.setUint16(0,31744,!1);else if(e===-1/0)rt.setUint16(0,64512,!1);else if(Number.isNaN(e))rt.setUint16(0,32256,!1);else{rt.setFloat32(0,e);let t=rt.getUint32(0),r=(t&2139095040)>>23,n=t&8388607;if(r===255)rt.setUint16(0,31744,!1);else if(r===0)rt.setUint16(0,(e&2147483648)>>16|n>>13,!1);else{let i=r-127;i<-24?rt.setUint16(0,0):i<-14?rt.setUint16(0,(t&2147483648)>>16|1<<24+i,!1):rt.setUint16(0,(t&2147483648)>>16|i+15<<10|n>>13,!1)}}}function Iu(e,t){if(e.length-t<2)throw new Error(`${I} not enough data for float16`);let r=(e[t]<<8)+e[t+1];if(r===31744)return 1/0;if(r===64512)return-1/0;if(r===32256)return NaN;let n=r>>10&31,i=r&1023,o;return n===0?o=i*2**-24:n!==31?o=(i+1024)*2**(n-25):o=i===0?1/0:NaN,r&32768?-o:o}function fy(e){rt.setFloat32(0,e,!1)}function Ou(e,t){if(e.length-t<4)throw new Error(`${I} not enough data for float32`);let r=(e.byteOffset||0)+t;return new DataView(e.buffer,r,4).getFloat32(0,!1)}function zv(e){rt.setFloat64(0,e,!1)}function ly(e,t){if(e.length-t<8)throw new Error(`${I} not enough data for float64`);let r=(e.byteOffset||0)+t;return new DataView(e.buffer,r,8).getFloat64(0,!1)}Hs.compareTokens=tt.compareTokens;function F(e,t,r){throw new Error(`${I} encountered invalid minor (${r}) for major ${e[t]>>>5}`)}function Gs(e){return()=>{throw new Error(`${I} ${e}`)}}var _=[];for(let e=0;e<=23;e++)_[e]=F;_[24]=Ep;_[25]=xp;_[26]=vp;_[27]=_p;_[28]=F;_[29]=F;_[30]=F;_[31]=F;for(let e=32;e<=55;e++)_[e]=F;_[56]=Dp;_[57]=Sp;_[58]=Ap;_[59]=Cp;_[60]=F;_[61]=F;_[62]=F;_[63]=F;for(let e=64;e<=87;e++)_[e]=Ip;_[88]=Op;_[89]=Bp;_[90]=kp;_[91]=Lp;_[92]=F;_[93]=F;_[94]=F;_[95]=Gs("indefinite length bytes/strings are not supported");for(let e=96;e<=119;e++)_[e]=Rp;_[120]=Np;_[121]=Pp;_[122]=Fp;_[123]=Up;_[124]=F;_[125]=F;_[126]=F;_[127]=Gs("indefinite length bytes/strings are not supported");for(let e=128;e<=151;e++)_[e]=Mp;_[152]=jp;_[153]=zp;_[154]=qp;_[155]=Vp;_[156]=F;_[157]=F;_[158]=F;_[159]=Kp;for(let e=160;e<=183;e++)_[e]=Wp;_[184]=Hp;_[185]=Gp;_[186]=Jp;_[187]=Qp;_[188]=F;_[189]=F;_[190]=F;_[191]=Yp;for(let e=192;e<=215;e++)_[e]=Xp;_[216]=Zp;_[217]=ey;_[218]=ty;_[219]=ry;_[220]=F;_[221]=F;_[222]=F;_[223]=F;for(let e=224;e<=243;e++)_[e]=Gs("simple values are not supported");_[244]=F;_[245]=F;_[246]=F;_[247]=ny;_[248]=Gs("simple values are not supported");_[249]=oy;_[250]=sy;_[251]=ay;_[252]=F;_[253]=F;_[254]=F;_[255]=iy;var bt=[];for(let e=0;e<24;e++)bt[e]=new v(p.uint,e,1);for(let e=-1;e>=-24;e--)bt[31-e]=new v(p.negint,e,1);bt[64]=new v(p.bytes,new Uint8Array(0),1);bt[96]=new v(p.string,"",1);bt[128]=new v(p.array,0,1);bt[160]=new v(p.map,0,1);bt[244]=new v(p.false,!1,1);bt[245]=new v(p.true,!0,1);bt[246]=new v(p.null,null,1);function Js(e){switch(e.type){case p.false:return $t([244]);case p.true:return $t([245]);case p.null:return $t([246]);case p.bytes:return e.value.length?void 0:$t([64]);case p.string:return e.value===""?$t([96]):void 0;case p.array:return e.value===0?$t([128]):void 0;case p.map:return e.value===0?$t([160]):void 0;case p.uint:return e.value<24?$t([Number(e.value)]):void 0;case p.negint:if(e.value>=-24)return $t([31-Number(e.value)])}}var Vv={float64:!1,mapSorter:Wv,quickEncodeToken:Js};function ku(){let e=[];return e[p.uint.major]=tt,e[p.negint.major]=zs,e[p.bytes.major]=ci,e[p.string.major]=$p,e[p.array.major]=Vs,e[p.map.major]=Ks,e[p.tag.major]=Ws,e[p.float.major]=Hs,e}var hy=ku(),Bu=new uo,li=class{constructor(e,t){this.obj=e,this.parent=t}includes(e){let t=this;do if(t.obj===e)return!0;while(t=t.parent);return!1}static createCheck(e,t){if(e&&e.includes(t))throw new Error(`${Au} object contains circular references`);return new li(t,e)}},Dr={null:new v(p.null,null),undefined:new v(p.undefined,void 0),true:new v(p.true,!0),false:new v(p.false,!1),emptyArray:new v(p.array,0),emptyMap:new v(p.map,0)},Sr={number(e,t,r,n){return!Number.isInteger(e)||!Number.isSafeInteger(e)?new v(p.float,e):e>=0?new v(p.uint,e):new v(p.negint,e)},bigint(e,t,r,n){return e>=BigInt(0)?new v(p.uint,e):new v(p.negint,e)},Uint8Array(e,t,r,n){return new v(p.bytes,e)},string(e,t,r,n){return new v(p.string,e)},boolean(e,t,r,n){return e?Dr.true:Dr.false},null(e,t,r,n){return Dr.null},undefined(e,t,r,n){return Dr.undefined},ArrayBuffer(e,t,r,n){return new v(p.bytes,new Uint8Array(e))},DataView(e,t,r,n){return new v(p.bytes,new Uint8Array(e.buffer,e.byteOffset,e.byteLength))},Array(e,t,r,n){if(!e.length)return r.addBreakTokens===!0?[Dr.emptyArray,new v(p.break)]:Dr.emptyArray;n=li.createCheck(n,e);let i=[],o=0;for(let u of e)i[o++]=po(u,r,n);return r.addBreakTokens?[new v(p.array,e.length),i,new v(p.break)]:[new v(p.array,e.length),i]},Object(e,t,r,n){let i=t!=="Object",o=i?e.keys():Object.keys(e),u=i?e.size:o.length;if(!u)return r.addBreakTokens===!0?[Dr.emptyMap,new v(p.break)]:Dr.emptyMap;n=li.createCheck(n,e);let s=[],c=0;for(let h of o)s[c++]=[po(h,r,n),po(i?e.get(h):e[h],r,n)];return Kv(s,r),r.addBreakTokens?[new v(p.map,u),s,new v(p.break)]:[new v(p.map,u),s]}};Sr.Map=Sr.Object;Sr.Buffer=Sr.Uint8Array;for(let e of"Uint8Clamped Uint16 Uint32 Int8 Int16 Int32 BigUint64 BigInt64 Float32 Float64".split(" "))Sr[`${e}Array`]=Sr.DataView;function po(e,t={},r){let n=lp(e),i=t&&t.typeEncoders&&t.typeEncoders[n]||Sr[n];if(typeof i=="function"){let u=i(e,n,t,r);if(u!=null)return u}let o=Sr[n];if(!o)throw new Error(`${Au} unsupported type: ${n}`);return o(e,n,t,r)}function Kv(e,t){t.mapSorter&&e.sort(t.mapSorter)}function Wv(e,t){let r=Array.isArray(e[0])?e[0][0]:e[0],n=Array.isArray(t[0])?t[0][0]:t[0];if(r.type!==n.type)return r.type.compare(n.type);let i=r.type.major,o=hy[i].compareTokens(r,n);return o===0&&console.warn("WARNING: complex key types used, CBOR key sorting guarantees are gone"),o}function dy(e,t,r,n){if(Array.isArray(t))for(let i of t)dy(e,i,r,n);else r[t.type.major](e,t,n)}function Hv(e,t,r){let n=po(e,r);if(!Array.isArray(n)&&r.quickEncodeToken){let i=r.quickEncodeToken(n);if(i)return i;let o=t[n.type.major];if(o.encodedSize){let u=o.encodedSize(n,r),s=new uo(u);if(o(s,n,r),s.chunks.length!==1)throw new Error(`Unexpected error: pre-calculated length for ${n} was wrong`);return Su(s.chunks[0])}}return Bu.reset(),dy(Bu,n,t,r),Bu.toBytes(!0)}function nr(e,t){return t=Object.assign({},Vv,t),Hv(e,hy,t)}a();var Gv={strict:!1,allowIndefinite:!0,allowUndefined:!0,allowBigInt:!0},Lu=class{constructor(e,t={}){this.pos=0,this.data=e,this.options=t}done(){return this.pos>=this.data.length}next(){let e=this.data[this.pos],t=bt[e];if(t===void 0){let r=_[e];if(!r)throw new Error(`${I} no decoder for major type ${e>>>5} (byte 0x${e.toString(16).padStart(2,"0")})`);let n=e&31;t=r(this.data,this.pos,n,this.options)}return this.pos+=t.encodedLength,t}},yo=Symbol.for("DONE"),Qs=Symbol.for("BREAK");function Jv(e,t,r){let n=[];for(let i=0;i<e.value;i++){let o=mo(t,r);if(o===Qs){if(e.value===1/0)break;throw new Error(`${I} got unexpected break to lengthed array`)}if(o===yo)throw new Error(`${I} found array but not enough entries (got ${i}, expected ${e.value})`);n[i]=o}return n}function Qv(e,t,r){let n=r.useMaps===!0,i=n?void 0:{},o=n?new Map:void 0;for(let u=0;u<e.value;u++){let s=mo(t,r);if(s===Qs){if(e.value===1/0)break;throw new Error(`${I} got unexpected break to lengthed map`)}if(s===yo)throw new Error(`${I} found map but not enough entries (got ${u} [no key], expected ${e.value})`);if(n!==!0&&typeof s!="string")throw new Error(`${I} non-string keys not supported (got ${typeof s})`);let c=mo(t,r);if(c===yo)throw new Error(`${I} found map but not enough entries (got ${u} [no value], expected ${e.value})`);n?o.set(s,c):i[s]=c}return n?o:i}function mo(e,t){if(e.done())return yo;let r=e.next();if(r.type===p.break)return Qs;if(r.type.terminal)return r.value;if(r.type===p.array)return Jv(r,e,t);if(r.type===p.map)return Qv(r,e,t);if(r.type===p.tag){if(t.tags&&typeof t.tags[r.value]=="function"){let n=mo(e,t);return t.tags[r.value](n)}throw new Error(`${I} tag not supported (${r.value})`)}throw new Error("unsupported")}function nt(e,t){if(!(e instanceof Uint8Array))throw new Error(`${I} data to decode must be a Uint8Array`);t=Object.assign({},Gv,t);let r=t.tokenizer||new Lu(e,t),n=mo(r,t);if(n===yo)throw new Error(`${I} did not find any content to decode`);if(n===Qs)throw new Error(`${I} got unexpected break`);if(!r.done())throw new Error(`${I} too many terminals, data makes no sense`);return n}a();var Yv=ku(),Xv={float64:!1,quickEncodeToken:Js};function Nu(e,t=Yv,r=Xv){if(Array.isArray(e)){let n=0;for(let i of e)n+=Nu(i,t,r);return n}else{let n=t[e.type.major];if(n.encodedSize===void 0||typeof n.encodedSize!="function")throw new Error(`Encoder for ${e.type.name} does not have an encodedSize()`);return n.encodedSize(e,r)}}var Ir={};H(Ir,{code:()=>W2,decode:()=>xo,encode:()=>bn,name:()=>K2});a();q();var Dy=42;function M2(e){if(e.asCID!==e)return null;let t=E.asCID(e);if(!t)return null;let r=new Uint8Array(t.bytes.byteLength+1);return r.set(t.bytes,1),[new v(p.tag,Dy),new v(p.bytes,r)]}function j2(){throw new Error("`undefined` is not supported by the IPLD Data Model and cannot be encoded")}function z2(e){if(Number.isNaN(e))throw new Error("`NaN` is not supported by the IPLD Data Model and cannot be encoded");if(e===1/0||e===-1/0)throw new Error("`Infinity` and `-Infinity` is not supported by the IPLD Data Model and cannot be encoded");return null}var q2={float64:!0,typeEncoders:{Object:M2,undefined:j2,number:z2}};function V2(e){if(e[0]!==0)throw new Error("Invalid CID for CBOR tag 42; expected leading 0x00");return E.decode(e.subarray(1))}var Sy={allowIndefinite:!1,coerceUndefinedToNull:!0,allowNaN:!1,allowInfinity:!1,allowBigInt:!0,strict:!0,useMaps:!1,tags:[]};Sy.tags[Dy]=V2;var K2="dag-cbor",W2=113,bn=e=>nr(e,q2),xo=e=>nt(e,Sy),Gu=class{constructor(e,t){this.bytes=e,this.byteOffset=t,this.roots=[],this.headerSize=t}addRoot(e,t){return H2(this,e,t),this}write(e){return G2(this,e),this}close(e){return J2(this,e)}},H2=(e,t,r={})=>{let{resize:n=!1}=r,{bytes:i,headerSize:o,byteOffset:u,roots:s}=e;e.roots.push(t);let c=_o(e);if(c>o)if(c-o+u<i.byteLength)if(n)Ty(e,c);else throw s.pop(),new RangeError(`Header of size ${o} has no capacity for new root ${t}.
  However there is a space in the buffer and you could call addRoot(root, { resize: root }) to resize header to make a space for this root.`);else throw s.pop(),new RangeError(`Buffer has no capacity for a new root ${t}`)},Ju=({cid:e,bytes:t})=>{let r=e.bytes.byteLength+t.byteLength;return vo.default.encodingLength(r)+r},G2=(e,{cid:t,bytes:r})=>{let n=t.bytes.byteLength+r.byteLength,i=vo.default.encode(n);if(e.byteOffset+i.length+n>e.bytes.byteLength)throw new RangeError("Buffer has no capacity for this block");Hu(e,i),Hu(e,t.bytes),Hu(e,r)},J2=(e,t={})=>{let{resize:r=!1}=t,{roots:n,bytes:i,byteOffset:o,headerSize:u}=e,s=bn({version:1,roots:n}),c=vo.default.encode(s.length),h=c.length+s.byteLength;if(u-h===0)return Ay(e,c,s),i.subarray(0,o);if(r)return Ty(e,h),Ay(e,c,s),i.subarray(0,e.byteOffset);throw new RangeError(`Header size was overestimated.
You can use close({ resize: true }) to resize header`)},Ty=(e,t)=>{let{bytes:r,headerSize:n}=e;r.set(r.subarray(n,e.byteOffset),t),e.byteOffset+=t-n,e.headerSize=t},Hu=(e,t)=>{e.bytes.set(t,e.byteOffset),e.byteOffset+=t.length},Ay=({bytes:e},t,r)=>{e.set(t),e.set(r,t.length)},Q2=[new v(p.map,2),new v(p.string,"version"),new v(p.uint,1),new v(p.string,"roots")],Y2=new v(p.tag,42),X2=e=>{let t=[...Q2];t.push(new v(p.array,e.length));for(let n of e)t.push(Y2),t.push(new v(p.bytes,{length:n+1}));let r=Nu(t);return vo.default.encodingLength(r)+r},_o=({roots:e})=>X2(e.map(t=>t.bytes.byteLength)),Cy=(e,t={})=>{let{roots:r=[],byteOffset:n=0,byteLength:i=e.byteLength,headerSize:o=_o({roots:r})}=t,u=new Uint8Array(e,n,i),s=new Gu(u,o);for(let c of r)s.addRoot(c);return s};a();a();a();var Br=x(ke(),1);q();Ee();a();var Or={Null:e=>e===null,Int:e=>Number.isInteger(e),Float:e=>typeof e=="number"&&Number.isFinite(e),String:e=>typeof e=="string",Bool:e=>typeof e=="boolean",Bytes:e=>e instanceof Uint8Array,Link:e=>!Or.Null(e)&&typeof e=="object"&&e.asCID===e,List:e=>Array.isArray(e),Map:e=>!Or.Null(e)&&typeof e=="object"&&e.asCID!==e&&!Or.List(e)&&!Or.Bytes(e)},yi={Int:Or.Int,"CarHeader > version":e=>yi.Int(e),"CarHeader > roots (anon) > valueType (anon)":Or.Link,"CarHeader > roots (anon)":e=>Or.List(e)&&Array.prototype.every.call(e,yi["CarHeader > roots (anon) > valueType (anon)"]),"CarHeader > roots":e=>yi["CarHeader > roots (anon)"](e),CarHeader:e=>{let t=e&&Object.keys(e);return Or.Map(e)&&["version"].every(r=>t.includes(r))&&Object.entries(e).every(([r,n])=>yi["CarHeader > "+r]&&yi["CarHeader > "+r](n))}},Iy=yi.CarHeader,Qu={SHA2_256:18,LENGTH:32,DAG_PB:112},Oy=16+8+8+8;async function ra(e){let t=await e.upTo(8);if(!t.length)throw new Error("Unexpected end of data");let r=Br.default.decode(t);return e.seek(Br.default.decode.bytes),r}async function e8(e){let t=await e.exactly(Oy),r=new DataView(t.buffer,t.byteOffset,t.byteLength),n=0,i={version:2,characteristics:[r.getBigUint64(n,!0),r.getBigUint64(n+=8,!0)],dataOffset:Number(r.getBigUint64(n+=8,!0)),dataSize:Number(r.getBigUint64(n+=8,!0)),indexOffset:Number(r.getBigUint64(n+=8,!0))};return e.seek(Oy),i}async function na(e,t){let r=await ra(e);if(r===0)throw new Error("Invalid CAR header (zero length)");let n=await e.exactly(r);e.seek(r);let i=xo(n);if(!Iy(i))throw new Error("Invalid CAR header format");if(i.version!==1&&i.version!==2||t!==void 0&&i.version!==t)throw new Error(`Invalid CAR version: ${i.version}${t!==void 0?` (expected ${t})`:""}`);let o=Array.isArray(i.roots);if(i.version===1&&!o||i.version===2&&o)throw new Error("Invalid CAR header format");if(i.version===1)return i;let u=await e8(e);e.seek(u.dataOffset-e.pos);let s=await na(e,1);return Object.assign(s,u)}async function t8(e){let t=await e.upTo(8);Br.default.decode(t);let r=Br.default.decode.bytes,n=Br.default.decode(t.subarray(Br.default.decode.bytes)),i=Br.default.decode.bytes,o=r+i+n,u=await e.exactly(o);return e.seek(o),u}async function r8(e){let t=await e.exactly(2);if(t[0]===Qu.SHA2_256&&t[1]===Qu.LENGTH){let u=await e.exactly(34);e.seek(34);let s=G(u);return E.create(0,Qu.DAG_PB,s)}let r=await ra(e);if(r!==1)throw new Error(`Unexpected CID version (${r})`);let n=await ra(e),i=await t8(e),o=G(i);return E.create(r,n,o)}async function By(e){let t=e.pos,r=await ra(e);if(r===0)throw new Error("Invalid CAR section (zero length)");r+=e.pos-t;let n=await r8(e),i=r-Number(e.pos-t);return{cid:n,length:r,blockLength:i}}async function n8(e){let{cid:t,blockLength:r}=await By(e),n=await e.exactly(r);return e.seek(r),{bytes:n,cid:t}}async function i8(e){let t=e.pos,{cid:r,length:n,blockLength:i}=await By(e),o={cid:r,length:n,blockLength:i,offset:t,blockOffset:e.pos};return e.seek(o.blockLength),o}function mi(e){let t=(async()=>{let r=await na(e);if(r.version===2){let n=e.pos-r.dataOffset;e=s8(e,r.dataSize-n)}return r})();return{header:()=>t,async*blocks(){for(await t;(await e.upTo(8)).length>0;)yield await n8(e)},async*blocksIndex(){for(await t;(await e.upTo(8)).length>0;)yield await i8(e)}}}function kr(e){let t=0;return{async upTo(r){return e.subarray(t,t+Math.min(r,e.length-t))},async exactly(r){if(r>e.length-t)throw new Error("Unexpected end of data");return e.subarray(t,t+r)},seek(r){t+=r},get pos(){return t}}}function o8(e){let t=0,r=0,n=0,i=new Uint8Array(0),o=async u=>{r=i.length-n;let s=[i.subarray(n)];for(;r<u;){let h=await e();if(h==null)break;r<0?h.length>r&&s.push(h.subarray(-r)):s.push(h),r+=h.length}i=new Uint8Array(s.reduce((h,y)=>h+y.length,0));let c=0;for(let h of s)i.set(h,c),c+=h.length;n=0};return{async upTo(u){return i.length-n<u&&await o(u),i.subarray(n,n+Math.min(i.length-n,u))},async exactly(u){if(i.length-n<u&&await o(u),i.length-n<u)throw new Error("Unexpected end of data");return i.subarray(n,n+u)},seek(u){t+=u,n+=u},get pos(){return t}}}function gi(e){let t=e[Symbol.asyncIterator]();async function r(){let n=await t.next();return n.done?null:n.value}return o8(r)}function s8(e,t){let r=0;return{async upTo(n){let i=await e.upTo(n);return i.length+r>t&&(i=i.subarray(0,t-r)),i},async exactly(n){let i=await e.exactly(n);if(i.length+r>t)throw new Error("Unexpected end of data");return i},seek(n){r+=n,e.seek(n)},get pos(){return e.pos}}}var wi=class{constructor(e,t){this._header=e,this._blocks=t,this._keys=t.map(r=>r.cid.toString())}get version(){return this._header.version}async getRoots(){return this._header.roots}async has(e){return this._keys.indexOf(e.toString())>-1}async get(e){let t=this._keys.indexOf(e.toString());return t>-1?this._blocks[t]:void 0}async*blocks(){for(let e of this._blocks)yield e}async*cids(){for(let e of this._blocks)yield e.cid}static async fromBytes(e){if(!(e instanceof Uint8Array))throw new TypeError("fromBytes() requires a Uint8Array");return ky(kr(e))}static async fromIterable(e){if(!e||typeof e[Symbol.asyncIterator]!="function")throw new TypeError("fromIterable() requires an async iterable");return ky(gi(e))}};async function ky(e){let t=mi(e),r=await t.header(),n=[];for await(let i of t.blocks())n.push(i);return new wi(r,n)}a();a();var oa=class{constructor(e,t,r){this._version=e,this._roots=t,this._iterable=r,this._decoded=!1}get version(){return this._version}async getRoots(){return this._roots}},Lr=class extends oa{[Symbol.asyncIterator](){if(this._decoded)throw new Error("Cannot decode more than once");if(!this._iterable)throw new Error("Block iterable not found");return this._decoded=!0,this._iterable[Symbol.asyncIterator]()}static async fromBytes(e){let{version:t,roots:r,iterator:n}=await Ry(e);return new Lr(t,r,n)}static async fromIterable(e){let{version:t,roots:r,iterator:n}=await Ny(e);return new Lr(t,r,n)}};async function Ry(e){if(!(e instanceof Uint8Array))throw new TypeError("fromBytes() requires a Uint8Array");return Py(kr(e))}async function Ny(e){if(!e||typeof e[Symbol.asyncIterator]!="function")throw new TypeError("fromIterable() requires an async iterable");return Py(gi(e))}async function Py(e){let t=mi(e),{version:r,roots:n}=await t.header();return{version:r,roots:n,iterator:t.blocks()}}a();q();a();var Yu=x(ke(),1);function Xu(e){let t=bn({version:1,roots:e}),r=Yu.default.encode(t.length),n=new Uint8Array(r.length+t.length);return n.set(r,0),n.set(t,r.length),n}function Fy(e){return{async setRoots(t){let r=Xu(t);await e.write(r)},async writeBlock(t){let{cid:r,bytes:n}=t;await e.write(new Uint8Array(Yu.default.encode(r.bytes.length+n.length))),await e.write(r.bytes),n.length&&await e.write(n)},async close(){await e.end()}}}a();function sa(){}function Uy(){let e=[],t=null,r=sa,n=!1,i=null,o=sa,u=()=>(t||(t=new Promise(h=>{r=()=>{t=null,r=sa,h()}})),t),s={write(h){e.push(h);let y=u();return o(),y},async end(){n=!0;let h=u();o(),await h}},c={async next(){let h=e.shift();return h?(e.length===0&&r(),{done:!1,value:h}):n?(r(),{done:!0,value:void 0}):(i||(i=new Promise(y=>{o=()=>(i=null,o=sa,y(c.next()))})),i)}};return{writer:s,iterator:c}}var Rr=class{constructor(e,t){this._encoder=t,this._mutex=t.setRoots(e),this._ended=!1}async put(e){if(!(e.bytes instanceof Uint8Array)||!e.cid)throw new TypeError("Can only write {cid, bytes} objects");if(this._ended)throw new Error("Already closed");let t=E.asCID(e.cid);if(!t)throw new TypeError("Can only write {cid, bytes} objects");return this._mutex=this._mutex.then(()=>this._encoder.writeBlock({cid:t,bytes:e.bytes})),this._mutex}async close(){if(this._ended)throw new Error("Already closed");return await this._mutex,this._ended=!0,this._encoder.close()}static create(e){e=a8(e);let{encoder:t,iterator:r}=$y(),n=new Rr(e,t),i=new aa(r);return{writer:n,out:i}}static createAppender(){let{encoder:e,iterator:t}=$y();e.setRoots=()=>Promise.resolve();let r=new Rr([],e),n=new aa(t);return{writer:r,out:n}}static async updateRootsInBytes(e,t){let r=kr(e);await na(r);let n=Xu(t);if(Number(r.pos)!==n.length)throw new Error(`updateRoots() can only overwrite a header of the same length (old header is ${r.pos} bytes, new header is ${n.length} bytes)`);return e.set(n,0),e}},aa=class{constructor(e){this._iterator=e}[Symbol.asyncIterator](){if(this._iterating)throw new Error("Multiple iterator not supported");return this._iterating=!0,this._iterator}};function $y(){let e=Uy(),{writer:t,iterator:r}=e;return{encoder:Fy(t),iterator:r}}function a8(e){if(e===void 0)return[];if(!Array.isArray(e)){let r=E.asCID(e);if(!r)throw new TypeError("roots must be a single CID or an array of CIDs");return[r]}let t=[];for(let r of e){let n=E.asCID(r);if(!n)throw new TypeError("roots must be a single CID or an array of CIDs");t.push(n)}return t}a();Ei();Ee();ir();xi();a();Ei();var ca=({enumerable:e=!0,configurable:t=!1}={})=>({enumerable:e,configurable:t,writable:!1}),nf=function*(e,t){if(e!=null&&!(e instanceof Uint8Array))for(let[r,n]of Object.entries(e)){let i=[...t,r];if(n!=null&&typeof n=="object")if(Array.isArray(n))for(let[o,u]of n.entries()){let s=[...i,o],c=E.asCID(u);c?yield[s.join("/"),c]:typeof u=="object"&&(yield*nf(u,s))}else{let o=E.asCID(n);o?yield[i.join("/"),o]:yield*nf(n,i)}}},of=function*(e,t){if(e!=null)for(let[r,n]of Object.entries(e)){let i=[...t,r];if(yield i.join("/"),n!=null&&!(n instanceof Uint8Array)&&typeof n=="object"&&!E.asCID(n))if(Array.isArray(n))for(let[o,u]of n.entries()){let s=[...i,o];yield s.join("/"),typeof u=="object"&&!E.asCID(u)&&(yield*of(u,s))}else yield*of(n,i)}},l8=(e,t)=>{let r=e;for(let[n,i]of t.entries()){if(r=r[i],r==null)throw new Error(`Object has no property at ${t.slice(0,n+1).map(u=>`[${JSON.stringify(u)}]`).join("")}`);let o=E.asCID(r);if(o)return{value:o,remaining:t.slice(n+1).join("/")}}return{value:r}},ua=class{constructor({cid:e,bytes:t,value:r}){if(!e||!t||typeof r>"u")throw new Error("Missing required argument");this.cid=e,this.bytes=t,this.value=r,this.asBlock=this,Object.defineProperties(this,{cid:ca(),bytes:ca(),value:ca(),asBlock:ca()})}links(){return nf(this.value,[])}tree(){return of(this.value,[])}get(e="/"){return l8(this.value,e.split("/").filter(Boolean))}},sf=async({value:e,codec:t,hasher:r})=>{if(typeof e>"u")throw new Error('Missing required argument "value"');if(!t||!r)throw new Error("Missing required argument: codec or hasher");let n=t.encode(e),i=await r.digest(n),o=E.create(1,t.code,i);return new ua({value:e,bytes:n,cid:o})},En=({bytes:e,cid:t,value:r,codec:n})=>{let i=r!==void 0?r:n&&n.decode(e);if(i===void 0)throw new Error('Missing required argument, must either provide "value" or "codec"');return new ua({cid:t,bytes:e,value:i})},qy=async({bytes:e,cid:t,hasher:r,codec:n})=>{if(!e)throw new Error('Missing required argument "bytes"');if(!r)throw new Error('Missing required argument "hasher"');let i=n.decode(e),o=await r.digest(e);if(!gn.equals(t.multihash.bytes,o.bytes))throw new Error("CID hash does not match bytes");return En({bytes:e,cid:t,value:i,codec:n})};a();function fa(e){return{all:e=e||new Map,on:function(t,r){var n=e.get(t);n?n.push(r):e.set(t,[r])},off:function(t,r){var n=e.get(t);n&&(r?n.splice(n.indexOf(r)>>>0,1):e.set(t,[]))},emit:function(t,r){var n=e.get(t);n&&n.slice().map(function(i){i(r)}),(n=e.get("*"))&&n.slice().map(function(i){i(t,r)})}}}var{isBinary:d8}=gn,Ky=e=>d8(e)?sf({value:e,hasher:Mt,codec:st}):sf({value:e,hasher:Mt,codec:Ir}),Vy=({bytes:e,cid:t})=>{let r,n,{code:i}=t,o=t.multihash.code||G(t.multihash).code;if(o===18)r=Mt;else throw new Error("Unsupported hash function: "+o);if(i===113)n=Ir;else if(i===85)n=st;else throw new Error("Unsupported codec: "+i);return qy({bytes:e,cid:t,codec:n,hasher:r})},xn=class{constructor(){Object.assign(this,fa()),this.blocks=[]}static create(){return new this}static async load(e){let t=await wi.fromBytes(e),[r]=await t.getRoots();return{root:r,get:n=>t.get(n).then(i=>Vy(i)).then(({value:i})=>i)}}async add(e){let t=await Ky(e);return this.last=t,this.blocks.push(t),this.emit("size",this.size),t.cid}async get(e){let{cid:t,bytes:r,value:n}=await Vy(e);return{cid:t,bytes:r,value:n}}undo(){return this.blocks.pop()}async commit(){let e=this.last.cid,t=0,r=_o({roots:[e]});t+=r;for(let o of this.blocks)t+=Ju(o);let n=new Uint8Array(t),i=await Cy(n,{headerSize:r});i.addRoot(e);for(let o of this.blocks)i.write(o);return await i.close(),i.bytes}get size(){if(!(this!=null&&this.last))return 0;let e=this.last.cid,t=0;t+=_o({roots:[e]});for(let r of this.blocks)t+=Ju(r);return t}};a();a();a();a();var Do=p8;function p8(e,t,r){if(!e)return r;var n,i;if(Array.isArray(t)&&(n=t.slice(0)),typeof t=="string"&&(n=t.split(".")),typeof t=="symbol"&&(n=[t]),!Array.isArray(n))throw new Error("props arg must be an array, a string or a symbol");for(;n.length;)if(i=n.shift(),!e||(e=e[i],e===void 0))return r;return e}var u0=x(at(),1),Fn=x(ve(),1);a();a();a();q();a();a();a();var ct=(e=21)=>crypto.getRandomValues(new Uint8Array(e)).reduce((t,r)=>(r&=63,r<36?t+=r.toString(36):r<62?t+=(r-26).toString(36).toUpperCase():r>62?t+="-":t+="_",t),"");W();we();var or="/",dm=new TextEncoder().encode(or),wa=dm[0],M=class{constructor(e,t){if(typeof e=="string")this._buf=N(e);else if(e instanceof Uint8Array)this._buf=e;else throw new Error("Invalid key, should be String of Uint8Array");if(t==null&&(t=!0),t&&this.clean(),this._buf.byteLength===0||this._buf[0]!==wa)throw new Error("Invalid key")}toString(e="utf8"){return A(this._buf,e)}uint8Array(){return this._buf}get[Symbol.toStringTag](){return`Key(${this.toString()})`}static withNamespaces(e){return new M(e.join(or))}static random(){return new M(ct().replace(/-/g,""))}static asKey(e){return e instanceof Uint8Array||typeof e=="string"?new M(e):typeof e.uint8Array=="function"?new M(e.uint8Array()):null}clean(){if((this._buf==null||this._buf.byteLength===0)&&(this._buf=dm),this._buf[0]!==wa){let e=new Uint8Array(this._buf.byteLength+1);e.fill(wa,0,1),e.set(this._buf,1),this._buf=e}for(;this._buf.byteLength>1&&this._buf[this._buf.byteLength-1]===wa;)this._buf=this._buf.subarray(0,-1)}less(e){let t=this.list(),r=e.list();for(let n=0;n<t.length;n++){if(r.length<n+1)return!1;let i=t[n],o=r[n];if(i<o)return!0;if(i>o)return!1}return t.length<r.length}reverse(){return M.withNamespaces(this.list().slice().reverse())}namespaces(){return this.list()}baseNamespace(){let e=this.namespaces();return e[e.length-1]}list(){return this.toString().split(or).slice(1)}type(){return Y8(this.baseNamespace())}name(){return X8(this.baseNamespace())}instance(e){return new M(this.toString()+":"+e)}path(){let e=this.parent().toString();return e.endsWith(or)||(e+=or),e+=this.type(),new M(e)}parent(){let e=this.list();return e.length===1?new M(or):new M(e.slice(0,-1).join(or))}child(e){return this.toString()===or?e:e.toString()===or?this:new M(this.toString()+e.toString(),!1)}isAncestorOf(e){return e.toString()===this.toString()?!1:e.toString().startsWith(this.toString())}isDecendantOf(e){return e.toString()===this.toString()?!1:this.toString().startsWith(e.toString())}isTopLevel(){return this.list().length===1}concat(...e){return M.withNamespaces([...this.namespaces(),...Z8(e.map(t=>t.namespaces()))])}};function Y8(e){let t=e.split(":");return t.length<2?"":t.slice(0,-1).join(":")}function X8(e){let t=e.split(":");return t[t.length-1]}function Z8(e){return[].concat(...e)}var mm=x(at(),1),gm=x(xf(),1);xe();ir();Ee();var t_=(0,mm.default)("ipfs:repo:migrator:migration-8");function wm(e){return e.child?wm(e.child):e}function r_(e){try{let t=C.decode(`b${e.toString().toLowerCase().slice(1)}`),r=E.decode(t).multihash.bytes,n=C.encode(r).slice(1).toUpperCase();return new M(`/${n}`,!1)}catch{return e}}function n_(e){try{let t=C.decode(`b${e.toString().toLowerCase().slice(1)}`),r=G(t),n=C.encode(E.createV1(ot,r).bytes).slice(1);return new M(`/${n.toUpperCase()}`,!1)}catch{return e}}async function ym(e,t,r){let n=e.blocks;await n.open();let i=wm(n),o=await(0,gm.default)(i.queryKeys({filters:[u=>r(u).toString()!==u.toString()]}));try{let u=0;for await(let s of i.query({})){let c=r(s.key);c.toString()!==s.key.toString()&&(u+=1,t_(`Migrating Block from ${s.key} to ${c}`,await i.has(s.key)),await i.delete(s.key),await i.put(c,s.value),t(u/o*100,`Migrated Block from ${s.key} to ${c}`))}}finally{await n.close()}}var bm={version:8,description:"Transforms key names into base32 encoding and converts Block store to use bare multihashes encoded as base32",migrate:(e,t=()=>{})=>ym(e,t,r_),revert:(e,t=()=>{})=>ym(e,t,n_)};a();q();a();q();a();var i_=new TextDecoder;function vf(e,t){let r=0;for(let n=0;;n+=7){if(n>=64)throw new Error("protobuf: varint overflow");if(t>=e.length)throw new Error("protobuf: unexpected end of data");let i=e[t++];if(r+=n<28?(i&127)<<n:(i&127)*2**n,i<128)break}return[r,t]}function ba(e,t){let r;[r,t]=vf(e,t);let n=t+r;if(r<0||n<0)throw new Error("protobuf: invalid length");if(n>e.length)throw new Error("protobuf: unexpected end of data");return[e.subarray(t,n),n]}function Em(e,t){let r;return[r,t]=vf(e,t),[r&7,r>>3,t]}function o_(e){let t={},r=e.length,n=0;for(;n<r;){let i,o;if([i,o,n]=Em(e,n),o===1){if(t.Hash)throw new Error("protobuf: (PBLink) duplicate Hash section");if(i!==2)throw new Error(`protobuf: (PBLink) wrong wireType (${i}) for Hash`);if(t.Name!==void 0)throw new Error("protobuf: (PBLink) invalid order, found Name before Hash");if(t.Tsize!==void 0)throw new Error("protobuf: (PBLink) invalid order, found Tsize before Hash");[t.Hash,n]=ba(e,n)}else if(o===2){if(t.Name!==void 0)throw new Error("protobuf: (PBLink) duplicate Name section");if(i!==2)throw new Error(`protobuf: (PBLink) wrong wireType (${i}) for Name`);if(t.Tsize!==void 0)throw new Error("protobuf: (PBLink) invalid order, found Tsize before Name");let u;[u,n]=ba(e,n),t.Name=i_.decode(u)}else if(o===3){if(t.Tsize!==void 0)throw new Error("protobuf: (PBLink) duplicate Tsize section");if(i!==0)throw new Error(`protobuf: (PBLink) wrong wireType (${i}) for Tsize`);[t.Tsize,n]=vf(e,n)}else throw new Error(`protobuf: (PBLink) invalid fieldNumber, expected 1, 2 or 3, got ${o}`)}if(n>r)throw new Error("protobuf: (PBLink) unexpected end of data");return t}function xm(e){let t=e.length,r=0,n,i=!1,o;for(;r<t;){let s,c;if([s,c,r]=Em(e,r),s!==2)throw new Error(`protobuf: (PBNode) invalid wireType, expected 2, got ${s}`);if(c===1){if(o)throw new Error("protobuf: (PBNode) duplicate Data section");[o,r]=ba(e,r),n&&(i=!0)}else if(c===2){if(i)throw new Error("protobuf: (PBNode) duplicate Links section");n||(n=[]);let h;[h,r]=ba(e,r),n.push(o_(h))}else throw new Error(`protobuf: (PBNode) invalid fieldNumber, expected 1 or 2, got ${c}`)}if(r>t)throw new Error("protobuf: (PBNode) unexpected end of data");let u={};return o&&(u.Data=o),u.Links=n||[],u}a();var _m=new TextEncoder,vm=2**32,s_=2**31;function a_(e,t){let r=t.length;if(typeof e.Tsize=="number"){if(e.Tsize<0)throw new Error("Tsize cannot be negative");if(!Number.isSafeInteger(e.Tsize))throw new Error("Tsize too large for encoding");r=Io(t,r,e.Tsize)-1,t[r]=24}if(typeof e.Name=="string"){let n=_m.encode(e.Name);r-=n.length,t.set(n,r),r=Io(t,r,n.length)-1,t[r]=18}return e.Hash&&(r-=e.Hash.length,t.set(e.Hash,r),r=Io(t,r,e.Hash.length)-1,t[r]=10),t.length-r}function Dm(e){let t=u_(e),r=new Uint8Array(t),n=t;if(e.Data&&(n-=e.Data.length,r.set(e.Data,n),n=Io(r,n,e.Data.length)-1,r[n]=10),e.Links)for(let i=e.Links.length-1;i>=0;i--){let o=a_(e.Links[i],r.subarray(0,n));n-=o,n=Io(r,n,o)-1,r[n]=18}return r}function c_(e){let t=0;if(e.Hash){let r=e.Hash.length;t+=1+r+Ai(r)}if(typeof e.Name=="string"){let r=_m.encode(e.Name).length;t+=1+r+Ai(r)}return typeof e.Tsize=="number"&&(t+=1+Ai(e.Tsize)),t}function u_(e){let t=0;if(e.Data){let r=e.Data.length;t+=1+r+Ai(r)}if(e.Links)for(let r of e.Links){let n=c_(r);t+=1+n+Ai(n)}return t}function Io(e,t,r){t-=Ai(r);let n=t;for(;r>=s_;)e[t++]=r&127|128,r/=128;for(;r>=128;)e[t++]=r&127|128,r>>>=7;return e[t]=r,n}function Ai(e){return e%2===0&&e++,Math.floor((f_(e)+6)/7)}function f_(e){let t=0;return e>=vm&&(e=Math.floor(e/vm),t=32),e>=1<<16&&(e>>>=16,t+=16),e>=1<<8&&(e>>>=8,t+=8),t+l_[e]}var l_=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8];a();q();var h_=["Data","Links"],d_=["Hash","Name","Tsize"],Sm=new TextEncoder;function p_(e,t){if(e===t)return 0;let r=e.Name?Sm.encode(e.Name):[],n=t.Name?Sm.encode(t.Name):[],i=r.length,o=n.length;for(let u=0,s=Math.min(i,o);u<s;++u)if(r[u]!==n[u]){i=r[u],o=n[u];break}return i<o?-1:o<i?1:0}function Am(e,t){return!Object.keys(e).some(r=>!t.includes(r))}function Tm(e){if(!e||typeof e!="object"||Array.isArray(e))throw new TypeError("Invalid DAG-PB form");if(!Am(e,h_))throw new TypeError("Invalid DAG-PB form (extraneous properties)");if(e.Data!==void 0&&!(e.Data instanceof Uint8Array))throw new TypeError("Invalid DAG-PB form (Data must be a Uint8Array)");if(!Array.isArray(e.Links))throw new TypeError("Invalid DAG-PB form (Links must be an array)");for(let t=0;t<e.Links.length;t++){let r=e.Links[t];if(!r||typeof r!="object"||Array.isArray(r))throw new TypeError("Invalid DAG-PB form (bad link object)");if(!Am(r,d_))throw new TypeError("Invalid DAG-PB form (extraneous properties on link object)");if(!r.Hash)throw new TypeError("Invalid DAG-PB form (link must have a Hash)");if(r.Hash.asCID!==r.Hash)throw new TypeError("Invalid DAG-PB form (link Hash must be a CID)");if(r.Name!==void 0&&typeof r.Name!="string")throw new TypeError("Invalid DAG-PB form (link Name must be a string)");if(r.Tsize!==void 0&&(typeof r.Tsize!="number"||r.Tsize%1!==0))throw new TypeError("Invalid DAG-PB form (link Tsize must be an integer)");if(t>0&&p_(r,e.Links[t-1])===-1)throw new TypeError("Invalid DAG-PB form (links must be sorted by Name bytes)")}}var xt=112;function Oo(e){Tm(e);let t={};return e.Links&&(t.Links=e.Links.map(r=>{let n={};return r.Hash&&(n.Hash=r.Hash.bytes),r.Name!==void 0&&(n.Name=r.Name),r.Tsize!==void 0&&(n.Tsize=r.Tsize),n})),e.Data&&(t.Data=e.Data),Dm(t)}function Bo(e){let t=xm(e),r={};return t.Data&&(r.Data=t.Data),t.Links&&(r.Links=t.Links.map(n=>{let i={};try{i.Hash=E.decode(n.Hash)}catch{}if(!i.Hash)throw new Error("Invalid Hash field found in link, expected CID");return n.Name!==void 0&&(i.Name=n.Name),n.Tsize!==void 0&&(i.Tsize=n.Tsize),i})),r}a();q();a();var An=x(Ur(),1),Dg=An.default.Reader,D_=An.default.Writer;An.default.util;var Sa=An.default.roots.default||(An.default.roots.default={}),Sg=Sa.ipfs=(()=>{let e={};return e.pin=function(){let t={};return t.Set=function(){function r(n){if(n)for(var i=Object.keys(n),o=0;o<i.length;++o)n[i[o]]!=null&&(this[i[o]]=n[i[o]])}return r.prototype.version=0,r.prototype.fanout=0,r.prototype.seed=0,r.encode=function(n,i){return i||(i=D_.create()),n.version!=null&&Object.hasOwnProperty.call(n,"version")&&i.uint32(8).uint32(n.version),n.fanout!=null&&Object.hasOwnProperty.call(n,"fanout")&&i.uint32(16).uint32(n.fanout),n.seed!=null&&Object.hasOwnProperty.call(n,"seed")&&i.uint32(29).fixed32(n.seed),i},r.decode=function(n,i){n instanceof Dg||(n=Dg.create(n));for(var o=i===void 0?n.len:n.pos+i,u=new Sa.ipfs.pin.Set;n.pos<o;){var s=n.uint32();switch(s>>>3){case 1:u.version=n.uint32();break;case 2:u.fanout=n.uint32();break;case 3:u.seed=n.fixed32();break;default:n.skipType(s&7);break}}return u},r.fromObject=function(n){if(n instanceof Sa.ipfs.pin.Set)return n;var i=new Sa.ipfs.pin.Set;return n.version!=null&&(i.version=n.version>>>0),n.fanout!=null&&(i.fanout=n.fanout>>>0),n.seed!=null&&(i.seed=n.seed>>>0),i},r.toObject=function(n,i){i||(i={});var o={};return i.defaults&&(o.version=0,o.fanout=0,o.seed=0),n.version!=null&&n.hasOwnProperty("version")&&(o.version=n.version),n.fanout!=null&&n.hasOwnProperty("fanout")&&(o.fanout=n.fanout),n.seed!=null&&n.hasOwnProperty("seed")&&(o.seed=n.seed),o},r.prototype.toJSON=function(){return this.constructor.toObject(this,An.default.util.toJSONOptions)},r}(),t}(),e})(),Og=x(Tg(),1),Ca=x(ke(),1);a();xe();q();var No=new M("/local/pins"),Ta=256,Cg=8192,Ff=E.parse("QmdfTbBqBPQ7VNxZEYEj14VmRuZBkqFbiwReogJgS1zR1n"),Tn={direct:"direct",recursive:"recursive"};function Uf(e){return new M(`/${C.encode(e.multihash.bytes).toUpperCase().substring(1)}`)}$r();a();function Ig(e,t){for(let r=0;r<e.byteLength;r++){if(e[r]<t[r])return-1;if(e[r]>t[r])return 1}return e.byteLength>t.byteLength?1:e.byteLength<t.byteLength?-1:0}W();we();xi();var Mf=Sg.pin.Set;function S_(e){let t=e.Data;if(!t)throw new Error("No data present");let r=Ca.default.decode(t),n=Ca.default.decode.bytes;if(n<=0)throw new Error("Invalid Set header length");if(n+r>t.length)throw new Error("Impossibly large set header length");let i=t.slice(n,r+n),o=Mf.toObject(Mf.decode(i),{defaults:!1,arrays:!0,longs:Number,objects:!1});if(o.version!==1)throw new Error(`Unsupported Set version: ${o.version}`);if(o.fanout>e.Links.length)throw new Error("Impossibly large fanout");return{header:o,data:t.slice(r+n)}}function A_(e,t){let r=new Uint8Array(4);new DataView(r.buffer).setUint32(0,e,!0);let n=N(t.toString()),i=Y([r,n],r.byteLength+n.byteLength);return(0,Og.default)(A(i))}async function*Bg(e,t){let r=S_(t),n=0;for(let i of t.Links){if(n<r.header.fanout){let o=i.Hash;if(!Ff.equals(o)){let u=await e.get(o),s=Bo(u);yield*Bg(e,s)}}else yield i.Hash;n++}}async function*Po(e,t,r){let n=t.Links.find(u=>u.Name===r);if(!n)throw new Error("No link found with name "+r);let i=await e.get(n.Hash),o=Bo(i);yield*Bg(e,o)}function T_(e,t){return r(t,0);async function r(n,i){let o=Mf.encode({version:1,fanout:Ta,seed:i}).finish(),u=Ca.default.encode(o.length),s=Y([u,o]),c=[];for(let y=0;y<Ta;y++)c.push({Name:"",Tsize:1,Hash:Ff});if(n.length<=Cg){let y=n.map(S=>({link:{Name:"",Tsize:1,Hash:S.key},data:S.data||new Uint8Array})).sort((S,d)=>Ig(S.link.Hash.bytes,d.link.Hash.bytes)),w=c.concat(y.map(S=>S.link));return{Data:Y([s,...y.map(S=>S.data)]),Links:w}}else{let y=n.reduce((S,d)=>{let k=A_(i,d.key)%Ta;return S[k]=k in S?S[k].concat([d]):[d],S},[]),w=0;for(let S of y){let d=await r(S,i+1);await h(d,w),w++}return{Data:s,Links:c}}async function h(y,w){let S=Oo(y),d=await Mt.digest(S),k=E.createV0(d);await e.put(k,S);let g=y.Links.reduce((m,B)=>m+(B.Tsize||0),0)+S.length;c[w]={Name:"",Tsize:g,Hash:k}}}}async function jf(e,t,r){let n=await T_(e,r.map(c=>({key:c}))),i=Oo(n),o=await Mt.digest(i),u=E.createV0(o);await e.put(u,i);let s=n.Links.reduce((c,h)=>c+h.Tsize,0)+i.length;return{Name:t,Tsize:s,Hash:u}}var Ia=x(xf(),1);xi();Ee();xe();async function I_(e,t,r,n){if(!await t.has(No))return;let i=await t.get(No),o=E.decode(i),u=await e.get(o),s=Bo(u),c=0,h=await(0,Ia.default)(Po(e,s,Tn.recursive))+await(0,Ia.default)(Po(e,s,Tn.direct));for await(let y of Po(e,s,Tn.recursive)){c++;let w={depth:1/0};y.version!==0&&(w.version=y.version),y.code!==xt&&(w.codec=y.code),await r.put(Uf(y),nr(w)),n(c/h*100,`Migrated recursive pin ${y}`)}for await(let y of Po(e,s,Tn.direct)){c++;let w={depth:0};y.version!==0&&(w.version=y.version),y.code!==xt&&(w.codec=y.code),await r.put(Uf(y),nr(w)),n(c/h*100,`Migrated direct pin ${y}`)}await e.delete(o),await t.delete(No)}async function O_(e,t,r,n){let i=[],o=[],u=0,s=await(0,Ia.default)(r.queryKeys({}));for await(let{key:S,value:d}of r.query({})){u++;let k=nt(d),g=E.create(k.version||0,k.codec||xt,G(C.decode("b"+S.toString().toLowerCase().split("/").pop())));k.depth===0?(n(u/s*100,`Reverted direct pin ${g}`),o.push(g)):(n(u/s*100,`Reverted recursive pin ${g}`),i.push(g))}n(100,"Updating pin root");let c={Links:[await jf(e,Tn.direct,o),await jf(e,Tn.recursive,i)]},h=Oo(c),y=await Mt.digest(h),w=E.createV0(y);await e.put(w,h),await t.put(No,w.bytes)}async function kg(e,t,r){let n=e.blocks,i=e.datastore,o=e.pins;await n.open(),await i.open(),await o.open();try{await r(n,i,o,t)}finally{await o.close(),await i.close(),await n.close()}}var Lg={version:9,description:"Migrates pins to datastore",migrate:(e,t=()=>{})=>kg(e,t,I_),revert:(e,t=()=>{})=>kg(e,t,O_)};a();a();var ft={};H(ft,{abortedError:()=>B_,dbDeleteFailedError:()=>qf,dbOpenFailedError:()=>zf,dbWriteFailedError:()=>Vf,notFoundError:()=>qt});a();var Ci=x(ve(),1);function zf(e){return e=e||new Error("Cannot open database"),(0,Ci.default)(e,"ERR_DB_OPEN_FAILED")}function qf(e){return e=e||new Error("Delete failed"),(0,Ci.default)(e,"ERR_DB_DELETE_FAILED")}function Vf(e){return e=e||new Error("Write failed"),(0,Ci.default)(e,"ERR_DB_WRITE_FAILED")}function qt(e){return e=e||new Error("Not Found"),(0,Ci.default)(e,"ERR_NOT_FOUND")}function B_(e){return e=e||new Error("Aborted"),(0,Ci.default)(e,"ERR_ABORTED")}var Rg=new M("/config"),Fo=new M("/version");function Uo(e){let t=e;for(;t.db||t.child;)if(t=t.db||t.child,t.type==="level-js"||t.constructor.name==="Level")return t}async function k_(e,t,r){let n=await t(e);if(n)return n;let i=Uo(r);return i?new Promise((o,u)=>{let s=i.store("readonly").get(e.toString());s.transaction.onabort=()=>{u(s.transaction.error)},s.transaction.oncomplete=()=>{o(Boolean(s.result))}}):!1}async function L_(e,t,r,n){if(await r(e))return t(e);let i=Uo(n);if(!i)throw qt();return new Promise((o,u)=>{let s=i.store("readonly").get(e.toString());s.transaction.onabort=()=>{u(s.transaction.error)},s.transaction.oncomplete=()=>{if(s.result)return o(s.result);u(qt())}})}function Oa(e){let t=e.get.bind(e),r=e.has.bind(e);return e.get=n=>L_(n,t,r,e),e.has=n=>k_(n,r,e),e}function Kf(e){return{...e,root:Oa(e.root),datastore:Oa(e.datastore),pins:Oa(e.pins),keys:Oa(e.keys)}}we();W();async function R_(e,t,r=()=>{}){let n=Uo(t);if(!n){r(`${e} did not need an upgrade`);return}r(`Upgrading ${e}`),await Ug(n,(i,o)=>[{type:"del",key:i},{type:"put",key:N(i),value:o}])}async function N_(e,t,r=()=>{}){let n=Uo(t);if(!n){r(`${e} did not need a downgrade`);return}r(`Downgrading ${e}`),await Ug(n,(i,o)=>[{type:"del",key:i},{type:"put",key:A(i),value:o}])}function Pg(e){return e.child?Pg(e.child):e}async function Ng(e,t,r){let n=Object.entries(e).map(([u,s])=>({key:u,backend:Pg(s)})).filter(({key:u,backend:s})=>s.constructor.name==="LevelDatastore").map(({key:u,backend:s})=>({name:u,store:s}));t(0,`Migrating ${n.length} dbs`);let i=0,o=u=>{t(Math.round(i/n.length*100),u)};for(let{name:u,store:s}of n){await s.open();try{await r(u,s,o)}finally{i++,await s.close()}}t(100,`Migrated ${n.length} dbs`)}var Fg={version:10,description:"Migrates datastore-level keys to binary",migrate:(e,t=()=>{})=>Ng(e,t,R_),revert:(e,t=()=>{})=>Ng(e,t,N_)};function Ug(e,t){function r(n,i){let o=e.store("readwrite"),u=o.transaction,s=0,c;u.onabort=()=>i(c||u.error||new Error("aborted by user")),u.oncomplete=()=>i();function h(){let y=n[s++],w=y.key,S;try{S=y.type==="del"?o.delete(w):o.put(y.value,w)}catch(d){c=d,u.abort();return}s<n.length&&(S.onsuccess=h)}h()}return new Promise((n,i)=>{let o=e.iterator(),u=c=>c;o._deserializeKey=o._deserializeValue=u,s();function s(){let c=(h,y,w)=>{if(h||y===void 0){let S=d=>{if(d){i(d);return}n()};o.end(S);return}r(t(y,w),s)};o.next(c)}})}a();var Mr=new M("/local/filesroot");async function P_(e,t=()=>{}){if(t(100,"Migrating MFS root to repo datastore"),await e.root.open(),await e.datastore.open(),await e.root.has(Mr)){let r=await e.root.get(Mr);await e.datastore.put(Mr,r),await e.root.delete(Mr)}await e.datastore.close(),await e.root.close(),t(100,"Stored MFS root in repo datastore")}async function F_(e,t=()=>{}){if(t(100,"Migrating MFS root to repo root datastore"),await e.root.open(),await e.datastore.open(),await e.datastore.has(Mr)){let r=await e.datastore.get(Mr);await e.root.put(Mr,r),await e.datastore.delete(Mr)}await e.datastore.close(),await e.root.close(),t(100,"Stored MFS root in repo root datastore")}var $g={version:11,description:"Store mfs root in the datastore",migrate:P_,revert:F_};a();var cl=x(Ur(),1);a();var Cn=x(Ur(),1),Mg=Cn.default.Reader,U_=Cn.default.Writer,$_=Cn.default.util,Ba=Cn.default.roots.default||(Cn.default.roots.default={}),Wf=Ba.Protocols=(()=>{function e(t){if(this.protocols=[],t)for(var r=Object.keys(t),n=0;n<r.length;++n)t[r[n]]!=null&&(this[r[n]]=t[r[n]])}return e.prototype.protocols=$_.emptyArray,e.encode=function(t,r){if(r||(r=U_.create()),t.protocols!=null&&t.protocols.length)for(var n=0;n<t.protocols.length;++n)r.uint32(10).string(t.protocols[n]);return r},e.decode=function(t,r){t instanceof Mg||(t=Mg.create(t));for(var n=r===void 0?t.len:t.pos+r,i=new Ba.Protocols;t.pos<n;){var o=t.uint32();switch(o>>>3){case 1:i.protocols&&i.protocols.length||(i.protocols=[]),i.protocols.push(t.string());break;default:t.skipType(o&7);break}}return i},e.fromObject=function(t){if(t instanceof Ba.Protocols)return t;var r=new Ba.Protocols;if(t.protocols){if(!Array.isArray(t.protocols))throw TypeError(".Protocols.protocols: array expected");r.protocols=[];for(var n=0;n<t.protocols.length;++n)r.protocols[n]=String(t.protocols[n])}return r},e.toObject=function(t,r){r||(r={});var n={};if((r.arrays||r.defaults)&&(n.protocols=[]),t.protocols&&t.protocols.length){n.protocols=[];for(var i=0;i<t.protocols.length;++i)n.protocols[i]=t.protocols[i]}return n},e.prototype.toJSON=function(){return this.constructor.toObject(this,Cn.default.util.toJSONOptions)},e})();a();var sr=x(Ur(),1),Ii=sr.default.Reader,Hf=sr.default.Writer,J=sr.default.util,pe=sr.default.roots.default||(sr.default.roots.default={}),Gf=pe.Addresses=(()=>{function e(t){if(this.addrs=[],t)for(var r=Object.keys(t),n=0;n<r.length;++n)t[r[n]]!=null&&(this[r[n]]=t[r[n]])}return e.prototype.addrs=J.emptyArray,e.prototype.certifiedRecord=null,e.encode=function(t,r){if(r||(r=Hf.create()),t.addrs!=null&&t.addrs.length)for(var n=0;n<t.addrs.length;++n)pe.Addresses.Address.encode(t.addrs[n],r.uint32(10).fork()).ldelim();return t.certifiedRecord!=null&&Object.hasOwnProperty.call(t,"certifiedRecord")&&pe.Addresses.CertifiedRecord.encode(t.certifiedRecord,r.uint32(18).fork()).ldelim(),r},e.decode=function(t,r){t instanceof Ii||(t=Ii.create(t));for(var n=r===void 0?t.len:t.pos+r,i=new pe.Addresses;t.pos<n;){var o=t.uint32();switch(o>>>3){case 1:i.addrs&&i.addrs.length||(i.addrs=[]),i.addrs.push(pe.Addresses.Address.decode(t,t.uint32()));break;case 2:i.certifiedRecord=pe.Addresses.CertifiedRecord.decode(t,t.uint32());break;default:t.skipType(o&7);break}}return i},e.fromObject=function(t){if(t instanceof pe.Addresses)return t;var r=new pe.Addresses;if(t.addrs){if(!Array.isArray(t.addrs))throw TypeError(".Addresses.addrs: array expected");r.addrs=[];for(var n=0;n<t.addrs.length;++n){if(typeof t.addrs[n]!="object")throw TypeError(".Addresses.addrs: object expected");r.addrs[n]=pe.Addresses.Address.fromObject(t.addrs[n])}}if(t.certifiedRecord!=null){if(typeof t.certifiedRecord!="object")throw TypeError(".Addresses.certifiedRecord: object expected");r.certifiedRecord=pe.Addresses.CertifiedRecord.fromObject(t.certifiedRecord)}return r},e.toObject=function(t,r){r||(r={});var n={};if((r.arrays||r.defaults)&&(n.addrs=[]),r.defaults&&(n.certifiedRecord=null),t.addrs&&t.addrs.length){n.addrs=[];for(var i=0;i<t.addrs.length;++i)n.addrs[i]=pe.Addresses.Address.toObject(t.addrs[i],r)}return t.certifiedRecord!=null&&t.hasOwnProperty("certifiedRecord")&&(n.certifiedRecord=pe.Addresses.CertifiedRecord.toObject(t.certifiedRecord,r)),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,sr.default.util.toJSONOptions)},e.Address=function(){function t(n){if(n)for(var i=Object.keys(n),o=0;o<i.length;++o)n[i[o]]!=null&&(this[i[o]]=n[i[o]])}t.prototype.multiaddr=J.newBuffer([]),t.prototype.isCertified=null;let r;return Object.defineProperty(t.prototype,"_isCertified",{get:J.oneOfGetter(r=["isCertified"]),set:J.oneOfSetter(r)}),t.encode=function(n,i){return i||(i=Hf.create()),n.multiaddr!=null&&Object.hasOwnProperty.call(n,"multiaddr")&&i.uint32(10).bytes(n.multiaddr),n.isCertified!=null&&Object.hasOwnProperty.call(n,"isCertified")&&i.uint32(16).bool(n.isCertified),i},t.decode=function(n,i){n instanceof Ii||(n=Ii.create(n));for(var o=i===void 0?n.len:n.pos+i,u=new pe.Addresses.Address;n.pos<o;){var s=n.uint32();switch(s>>>3){case 1:u.multiaddr=n.bytes();break;case 2:u.isCertified=n.bool();break;default:n.skipType(s&7);break}}return u},t.fromObject=function(n){if(n instanceof pe.Addresses.Address)return n;var i=new pe.Addresses.Address;return n.multiaddr!=null&&(typeof n.multiaddr=="string"?J.base64.decode(n.multiaddr,i.multiaddr=J.newBuffer(J.base64.length(n.multiaddr)),0):n.multiaddr.length&&(i.multiaddr=n.multiaddr)),n.isCertified!=null&&(i.isCertified=Boolean(n.isCertified)),i},t.toObject=function(n,i){i||(i={});var o={};return i.defaults&&(i.bytes===String?o.multiaddr="":(o.multiaddr=[],i.bytes!==Array&&(o.multiaddr=J.newBuffer(o.multiaddr)))),n.multiaddr!=null&&n.hasOwnProperty("multiaddr")&&(o.multiaddr=i.bytes===String?J.base64.encode(n.multiaddr,0,n.multiaddr.length):i.bytes===Array?Array.prototype.slice.call(n.multiaddr):n.multiaddr),n.isCertified!=null&&n.hasOwnProperty("isCertified")&&(o.isCertified=n.isCertified,i.oneofs&&(o._isCertified="isCertified")),o},t.prototype.toJSON=function(){return this.constructor.toObject(this,sr.default.util.toJSONOptions)},t}(),e.CertifiedRecord=function(){function t(r){if(r)for(var n=Object.keys(r),i=0;i<n.length;++i)r[n[i]]!=null&&(this[n[i]]=r[n[i]])}return t.prototype.seq=J.Long?J.Long.fromBits(0,0,!0):0,t.prototype.raw=J.newBuffer([]),t.encode=function(r,n){return n||(n=Hf.create()),r.seq!=null&&Object.hasOwnProperty.call(r,"seq")&&n.uint32(8).uint64(r.seq),r.raw!=null&&Object.hasOwnProperty.call(r,"raw")&&n.uint32(18).bytes(r.raw),n},t.decode=function(r,n){r instanceof Ii||(r=Ii.create(r));for(var i=n===void 0?r.len:r.pos+n,o=new pe.Addresses.CertifiedRecord;r.pos<i;){var u=r.uint32();switch(u>>>3){case 1:o.seq=r.uint64();break;case 2:o.raw=r.bytes();break;default:r.skipType(u&7);break}}return o},t.fromObject=function(r){if(r instanceof pe.Addresses.CertifiedRecord)return r;var n=new pe.Addresses.CertifiedRecord;return r.seq!=null&&(J.Long?(n.seq=J.Long.fromValue(r.seq)).unsigned=!0:typeof r.seq=="string"?n.seq=parseInt(r.seq,10):typeof r.seq=="number"?n.seq=r.seq:typeof r.seq=="object"&&(n.seq=new J.LongBits(r.seq.low>>>0,r.seq.high>>>0).toNumber(!0))),r.raw!=null&&(typeof r.raw=="string"?J.base64.decode(r.raw,n.raw=J.newBuffer(J.base64.length(r.raw)),0):r.raw.length&&(n.raw=r.raw)),n},t.toObject=function(r,n){n||(n={});var i={};if(n.defaults){if(J.Long){var o=new J.Long(0,0,!0);i.seq=n.longs===String?o.toString():n.longs===Number?o.toNumber():o}else i.seq=n.longs===String?"0":0;n.bytes===String?i.raw="":(i.raw=[],n.bytes!==Array&&(i.raw=J.newBuffer(i.raw)))}return r.seq!=null&&r.hasOwnProperty("seq")&&(typeof r.seq=="number"?i.seq=n.longs===String?String(r.seq):r.seq:i.seq=n.longs===String?J.Long.prototype.toString.call(r.seq):n.longs===Number?new J.LongBits(r.seq.low>>>0,r.seq.high>>>0).toNumber(!0):r.seq),r.raw!=null&&r.hasOwnProperty("raw")&&(i.raw=n.bytes===String?J.base64.encode(r.raw,0,r.raw.length):n.bytes===Array?Array.prototype.slice.call(r.raw):r.raw),i},t.prototype.toJSON=function(){return this.constructor.toObject(this,sr.default.util.toJSONOptions)},t}(),e})();a();var ar=x(Ur(),1),Oi=ar.default.Reader,Jf=ar.default.Writer,j=ar.default.util,se=ar.default.roots.default||(ar.default.roots.default={}),Qf=se.Peer=(()=>{function e(r){if(this.addresses=[],this.protocols=[],this.metadata=[],r)for(var n=Object.keys(r),i=0;i<n.length;++i)r[n[i]]!=null&&(this[n[i]]=r[n[i]])}e.prototype.addresses=j.emptyArray,e.prototype.protocols=j.emptyArray,e.prototype.metadata=j.emptyArray,e.prototype.pubKey=null,e.prototype.peerRecordEnvelope=null;let t;return Object.defineProperty(e.prototype,"_pubKey",{get:j.oneOfGetter(t=["pubKey"]),set:j.oneOfSetter(t)}),Object.defineProperty(e.prototype,"_peerRecordEnvelope",{get:j.oneOfGetter(t=["peerRecordEnvelope"]),set:j.oneOfSetter(t)}),e.encode=function(r,n){if(n||(n=Jf.create()),r.addresses!=null&&r.addresses.length)for(var i=0;i<r.addresses.length;++i)se.Address.encode(r.addresses[i],n.uint32(10).fork()).ldelim();if(r.protocols!=null&&r.protocols.length)for(var i=0;i<r.protocols.length;++i)n.uint32(18).string(r.protocols[i]);if(r.metadata!=null&&r.metadata.length)for(var i=0;i<r.metadata.length;++i)se.Metadata.encode(r.metadata[i],n.uint32(26).fork()).ldelim();return r.pubKey!=null&&Object.hasOwnProperty.call(r,"pubKey")&&n.uint32(34).bytes(r.pubKey),r.peerRecordEnvelope!=null&&Object.hasOwnProperty.call(r,"peerRecordEnvelope")&&n.uint32(42).bytes(r.peerRecordEnvelope),n},e.decode=function(r,n){r instanceof Oi||(r=Oi.create(r));for(var i=n===void 0?r.len:r.pos+n,o=new se.Peer;r.pos<i;){var u=r.uint32();switch(u>>>3){case 1:o.addresses&&o.addresses.length||(o.addresses=[]),o.addresses.push(se.Address.decode(r,r.uint32()));break;case 2:o.protocols&&o.protocols.length||(o.protocols=[]),o.protocols.push(r.string());break;case 3:o.metadata&&o.metadata.length||(o.metadata=[]),o.metadata.push(se.Metadata.decode(r,r.uint32()));break;case 4:o.pubKey=r.bytes();break;case 5:o.peerRecordEnvelope=r.bytes();break;default:r.skipType(u&7);break}}return o},e.fromObject=function(r){if(r instanceof se.Peer)return r;var n=new se.Peer;if(r.addresses){if(!Array.isArray(r.addresses))throw TypeError(".Peer.addresses: array expected");n.addresses=[];for(var i=0;i<r.addresses.length;++i){if(typeof r.addresses[i]!="object")throw TypeError(".Peer.addresses: object expected");n.addresses[i]=se.Address.fromObject(r.addresses[i])}}if(r.protocols){if(!Array.isArray(r.protocols))throw TypeError(".Peer.protocols: array expected");n.protocols=[];for(var i=0;i<r.protocols.length;++i)n.protocols[i]=String(r.protocols[i])}if(r.metadata){if(!Array.isArray(r.metadata))throw TypeError(".Peer.metadata: array expected");n.metadata=[];for(var i=0;i<r.metadata.length;++i){if(typeof r.metadata[i]!="object")throw TypeError(".Peer.metadata: object expected");n.metadata[i]=se.Metadata.fromObject(r.metadata[i])}}return r.pubKey!=null&&(typeof r.pubKey=="string"?j.base64.decode(r.pubKey,n.pubKey=j.newBuffer(j.base64.length(r.pubKey)),0):r.pubKey.length&&(n.pubKey=r.pubKey)),r.peerRecordEnvelope!=null&&(typeof r.peerRecordEnvelope=="string"?j.base64.decode(r.peerRecordEnvelope,n.peerRecordEnvelope=j.newBuffer(j.base64.length(r.peerRecordEnvelope)),0):r.peerRecordEnvelope.length&&(n.peerRecordEnvelope=r.peerRecordEnvelope)),n},e.toObject=function(r,n){n||(n={});var i={};if((n.arrays||n.defaults)&&(i.addresses=[],i.protocols=[],i.metadata=[]),r.addresses&&r.addresses.length){i.addresses=[];for(var o=0;o<r.addresses.length;++o)i.addresses[o]=se.Address.toObject(r.addresses[o],n)}if(r.protocols&&r.protocols.length){i.protocols=[];for(var o=0;o<r.protocols.length;++o)i.protocols[o]=r.protocols[o]}if(r.metadata&&r.metadata.length){i.metadata=[];for(var o=0;o<r.metadata.length;++o)i.metadata[o]=se.Metadata.toObject(r.metadata[o],n)}return r.pubKey!=null&&r.hasOwnProperty("pubKey")&&(i.pubKey=n.bytes===String?j.base64.encode(r.pubKey,0,r.pubKey.length):n.bytes===Array?Array.prototype.slice.call(r.pubKey):r.pubKey,n.oneofs&&(i._pubKey="pubKey")),r.peerRecordEnvelope!=null&&r.hasOwnProperty("peerRecordEnvelope")&&(i.peerRecordEnvelope=n.bytes===String?j.base64.encode(r.peerRecordEnvelope,0,r.peerRecordEnvelope.length):n.bytes===Array?Array.prototype.slice.call(r.peerRecordEnvelope):r.peerRecordEnvelope,n.oneofs&&(i._peerRecordEnvelope="peerRecordEnvelope")),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,ar.default.util.toJSONOptions)},e})();se.Address=(()=>{function e(r){if(r)for(var n=Object.keys(r),i=0;i<n.length;++i)r[n[i]]!=null&&(this[n[i]]=r[n[i]])}e.prototype.multiaddr=j.newBuffer([]),e.prototype.isCertified=null;let t;return Object.defineProperty(e.prototype,"_isCertified",{get:j.oneOfGetter(t=["isCertified"]),set:j.oneOfSetter(t)}),e.encode=function(r,n){return n||(n=Jf.create()),r.multiaddr!=null&&Object.hasOwnProperty.call(r,"multiaddr")&&n.uint32(10).bytes(r.multiaddr),r.isCertified!=null&&Object.hasOwnProperty.call(r,"isCertified")&&n.uint32(16).bool(r.isCertified),n},e.decode=function(r,n){r instanceof Oi||(r=Oi.create(r));for(var i=n===void 0?r.len:r.pos+n,o=new se.Address;r.pos<i;){var u=r.uint32();switch(u>>>3){case 1:o.multiaddr=r.bytes();break;case 2:o.isCertified=r.bool();break;default:r.skipType(u&7);break}}return o},e.fromObject=function(r){if(r instanceof se.Address)return r;var n=new se.Address;return r.multiaddr!=null&&(typeof r.multiaddr=="string"?j.base64.decode(r.multiaddr,n.multiaddr=j.newBuffer(j.base64.length(r.multiaddr)),0):r.multiaddr.length&&(n.multiaddr=r.multiaddr)),r.isCertified!=null&&(n.isCertified=Boolean(r.isCertified)),n},e.toObject=function(r,n){n||(n={});var i={};return n.defaults&&(n.bytes===String?i.multiaddr="":(i.multiaddr=[],n.bytes!==Array&&(i.multiaddr=j.newBuffer(i.multiaddr)))),r.multiaddr!=null&&r.hasOwnProperty("multiaddr")&&(i.multiaddr=n.bytes===String?j.base64.encode(r.multiaddr,0,r.multiaddr.length):n.bytes===Array?Array.prototype.slice.call(r.multiaddr):r.multiaddr),r.isCertified!=null&&r.hasOwnProperty("isCertified")&&(i.isCertified=r.isCertified,n.oneofs&&(i._isCertified="isCertified")),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,ar.default.util.toJSONOptions)},e})();se.Metadata=(()=>{function e(t){if(t)for(var r=Object.keys(t),n=0;n<r.length;++n)t[r[n]]!=null&&(this[r[n]]=t[r[n]])}return e.prototype.key="",e.prototype.value=j.newBuffer([]),e.encode=function(t,r){return r||(r=Jf.create()),t.key!=null&&Object.hasOwnProperty.call(t,"key")&&r.uint32(10).string(t.key),t.value!=null&&Object.hasOwnProperty.call(t,"value")&&r.uint32(18).bytes(t.value),r},e.decode=function(t,r){t instanceof Oi||(t=Oi.create(t));for(var n=r===void 0?t.len:t.pos+r,i=new se.Metadata;t.pos<n;){var o=t.uint32();switch(o>>>3){case 1:i.key=t.string();break;case 2:i.value=t.bytes();break;default:t.skipType(o&7);break}}return i},e.fromObject=function(t){if(t instanceof se.Metadata)return t;var r=new se.Metadata;return t.key!=null&&(r.key=String(t.key)),t.value!=null&&(typeof t.value=="string"?j.base64.decode(t.value,r.value=j.newBuffer(j.base64.length(t.value)),0):t.value.length&&(r.value=t.value)),r},e.toObject=function(t,r){r||(r={});var n={};return r.defaults&&(n.key="",r.bytes===String?n.value="":(n.value=[],r.bytes!==Array&&(n.value=j.newBuffer(n.value)))),t.key!=null&&t.hasOwnProperty("key")&&(n.key=t.key),t.value!=null&&t.hasOwnProperty("value")&&(n.value=r.bytes===String?j.base64.encode(t.value,0,t.value.length):r.bytes===Array?Array.prototype.slice.call(t.value):t.value),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,ar.default.util.toJSONOptions)},e})();a();var In=x(Ur(),1),jg=In.default.Reader,M_=In.default.Writer,Q=In.default.util,ka=In.default.roots.default||(In.default.roots.default={}),zg=ka.Envelope=(()=>{function e(t){if(t)for(var r=Object.keys(t),n=0;n<r.length;++n)t[r[n]]!=null&&(this[r[n]]=t[r[n]])}return e.prototype.publicKey=Q.newBuffer([]),e.prototype.payloadType=Q.newBuffer([]),e.prototype.payload=Q.newBuffer([]),e.prototype.signature=Q.newBuffer([]),e.encode=function(t,r){return r||(r=M_.create()),t.publicKey!=null&&Object.hasOwnProperty.call(t,"publicKey")&&r.uint32(10).bytes(t.publicKey),t.payloadType!=null&&Object.hasOwnProperty.call(t,"payloadType")&&r.uint32(18).bytes(t.payloadType),t.payload!=null&&Object.hasOwnProperty.call(t,"payload")&&r.uint32(26).bytes(t.payload),t.signature!=null&&Object.hasOwnProperty.call(t,"signature")&&r.uint32(42).bytes(t.signature),r},e.decode=function(t,r){t instanceof jg||(t=jg.create(t));for(var n=r===void 0?t.len:t.pos+r,i=new ka.Envelope;t.pos<n;){var o=t.uint32();switch(o>>>3){case 1:i.publicKey=t.bytes();break;case 2:i.payloadType=t.bytes();break;case 3:i.payload=t.bytes();break;case 5:i.signature=t.bytes();break;default:t.skipType(o&7);break}}return i},e.fromObject=function(t){if(t instanceof ka.Envelope)return t;var r=new ka.Envelope;return t.publicKey!=null&&(typeof t.publicKey=="string"?Q.base64.decode(t.publicKey,r.publicKey=Q.newBuffer(Q.base64.length(t.publicKey)),0):t.publicKey.length&&(r.publicKey=t.publicKey)),t.payloadType!=null&&(typeof t.payloadType=="string"?Q.base64.decode(t.payloadType,r.payloadType=Q.newBuffer(Q.base64.length(t.payloadType)),0):t.payloadType.length&&(r.payloadType=t.payloadType)),t.payload!=null&&(typeof t.payload=="string"?Q.base64.decode(t.payload,r.payload=Q.newBuffer(Q.base64.length(t.payload)),0):t.payload.length&&(r.payload=t.payload)),t.signature!=null&&(typeof t.signature=="string"?Q.base64.decode(t.signature,r.signature=Q.newBuffer(Q.base64.length(t.signature)),0):t.signature.length&&(r.signature=t.signature)),r},e.toObject=function(t,r){r||(r={});var n={};return r.defaults&&(r.bytes===String?n.publicKey="":(n.publicKey=[],r.bytes!==Array&&(n.publicKey=Q.newBuffer(n.publicKey))),r.bytes===String?n.payloadType="":(n.payloadType=[],r.bytes!==Array&&(n.payloadType=Q.newBuffer(n.payloadType))),r.bytes===String?n.payload="":(n.payload=[],r.bytes!==Array&&(n.payload=Q.newBuffer(n.payload))),r.bytes===String?n.signature="":(n.signature=[],r.bytes!==Array&&(n.signature=Q.newBuffer(n.signature)))),t.publicKey!=null&&t.hasOwnProperty("publicKey")&&(n.publicKey=r.bytes===String?Q.base64.encode(t.publicKey,0,t.publicKey.length):r.bytes===Array?Array.prototype.slice.call(t.publicKey):t.publicKey),t.payloadType!=null&&t.hasOwnProperty("payloadType")&&(n.payloadType=r.bytes===String?Q.base64.encode(t.payloadType,0,t.payloadType.length):r.bytes===Array?Array.prototype.slice.call(t.payloadType):t.payloadType),t.payload!=null&&t.hasOwnProperty("payload")&&(n.payload=r.bytes===String?Q.base64.encode(t.payload,0,t.payload.length):r.bytes===Array?Array.prototype.slice.call(t.payload):t.payload),t.signature!=null&&t.hasOwnProperty("signature")&&(n.signature=r.bytes===String?Q.base64.encode(t.signature,0,t.signature.length):r.bytes===Array?Array.prototype.slice.call(t.signature):t.signature),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,In.default.util.toJSONOptions)},e})();a();var jr=x(Ur(),1),La=jr.default.Reader,qg=jr.default.Writer,te=jr.default.util,Dt=jr.default.roots.default||(jr.default.roots.default={}),Vg=Dt.PeerRecord=(()=>{function e(t){if(this.addresses=[],t)for(var r=Object.keys(t),n=0;n<r.length;++n)t[r[n]]!=null&&(this[r[n]]=t[r[n]])}return e.prototype.peerId=te.newBuffer([]),e.prototype.seq=te.Long?te.Long.fromBits(0,0,!0):0,e.prototype.addresses=te.emptyArray,e.encode=function(t,r){if(r||(r=qg.create()),t.peerId!=null&&Object.hasOwnProperty.call(t,"peerId")&&r.uint32(10).bytes(t.peerId),t.seq!=null&&Object.hasOwnProperty.call(t,"seq")&&r.uint32(16).uint64(t.seq),t.addresses!=null&&t.addresses.length)for(var n=0;n<t.addresses.length;++n)Dt.PeerRecord.AddressInfo.encode(t.addresses[n],r.uint32(26).fork()).ldelim();return r},e.decode=function(t,r){t instanceof La||(t=La.create(t));for(var n=r===void 0?t.len:t.pos+r,i=new Dt.PeerRecord;t.pos<n;){var o=t.uint32();switch(o>>>3){case 1:i.peerId=t.bytes();break;case 2:i.seq=t.uint64();break;case 3:i.addresses&&i.addresses.length||(i.addresses=[]),i.addresses.push(Dt.PeerRecord.AddressInfo.decode(t,t.uint32()));break;default:t.skipType(o&7);break}}return i},e.fromObject=function(t){if(t instanceof Dt.PeerRecord)return t;var r=new Dt.PeerRecord;if(t.peerId!=null&&(typeof t.peerId=="string"?te.base64.decode(t.peerId,r.peerId=te.newBuffer(te.base64.length(t.peerId)),0):t.peerId.length&&(r.peerId=t.peerId)),t.seq!=null&&(te.Long?(r.seq=te.Long.fromValue(t.seq)).unsigned=!0:typeof t.seq=="string"?r.seq=parseInt(t.seq,10):typeof t.seq=="number"?r.seq=t.seq:typeof t.seq=="object"&&(r.seq=new te.LongBits(t.seq.low>>>0,t.seq.high>>>0).toNumber(!0))),t.addresses){if(!Array.isArray(t.addresses))throw TypeError(".PeerRecord.addresses: array expected");r.addresses=[];for(var n=0;n<t.addresses.length;++n){if(typeof t.addresses[n]!="object")throw TypeError(".PeerRecord.addresses: object expected");r.addresses[n]=Dt.PeerRecord.AddressInfo.fromObject(t.addresses[n])}}return r},e.toObject=function(t,r){r||(r={});var n={};if((r.arrays||r.defaults)&&(n.addresses=[]),r.defaults)if(r.bytes===String?n.peerId="":(n.peerId=[],r.bytes!==Array&&(n.peerId=te.newBuffer(n.peerId))),te.Long){var i=new te.Long(0,0,!0);n.seq=r.longs===String?i.toString():r.longs===Number?i.toNumber():i}else n.seq=r.longs===String?"0":0;if(t.peerId!=null&&t.hasOwnProperty("peerId")&&(n.peerId=r.bytes===String?te.base64.encode(t.peerId,0,t.peerId.length):r.bytes===Array?Array.prototype.slice.call(t.peerId):t.peerId),t.seq!=null&&t.hasOwnProperty("seq")&&(typeof t.seq=="number"?n.seq=r.longs===String?String(t.seq):t.seq:n.seq=r.longs===String?te.Long.prototype.toString.call(t.seq):r.longs===Number?new te.LongBits(t.seq.low>>>0,t.seq.high>>>0).toNumber(!0):t.seq),t.addresses&&t.addresses.length){n.addresses=[];for(var o=0;o<t.addresses.length;++o)n.addresses[o]=Dt.PeerRecord.AddressInfo.toObject(t.addresses[o],r)}return n},e.prototype.toJSON=function(){return this.constructor.toObject(this,jr.default.util.toJSONOptions)},e.AddressInfo=function(){function t(r){if(r)for(var n=Object.keys(r),i=0;i<n.length;++i)r[n[i]]!=null&&(this[n[i]]=r[n[i]])}return t.prototype.multiaddr=te.newBuffer([]),t.encode=function(r,n){return n||(n=qg.create()),r.multiaddr!=null&&Object.hasOwnProperty.call(r,"multiaddr")&&n.uint32(10).bytes(r.multiaddr),n},t.decode=function(r,n){r instanceof La||(r=La.create(r));for(var i=n===void 0?r.len:r.pos+n,o=new Dt.PeerRecord.AddressInfo;r.pos<i;){var u=r.uint32();switch(u>>>3){case 1:o.multiaddr=r.bytes();break;default:r.skipType(u&7);break}}return o},t.fromObject=function(r){if(r instanceof Dt.PeerRecord.AddressInfo)return r;var n=new Dt.PeerRecord.AddressInfo;return r.multiaddr!=null&&(typeof r.multiaddr=="string"?te.base64.decode(r.multiaddr,n.multiaddr=te.newBuffer(te.base64.length(r.multiaddr)),0):r.multiaddr.length&&(n.multiaddr=r.multiaddr)),n},t.toObject=function(r,n){n||(n={});var i={};return n.defaults&&(n.bytes===String?i.multiaddr="":(i.multiaddr=[],n.bytes!==Array&&(i.multiaddr=te.newBuffer(i.multiaddr)))),r.multiaddr!=null&&r.hasOwnProperty("multiaddr")&&(i.multiaddr=n.bytes===String?te.base64.encode(r.multiaddr,0,r.multiaddr.length):n.bytes===Array?Array.prototype.slice.call(r.multiaddr):r.multiaddr),i},t.prototype.toJSON=function(){return this.constructor.toObject(this,jr.default.util.toJSONOptions)},t}(),e})(),al=x(Tw(),1);cl.default.util.Long=void 0;cl.default.configure();async function hD(e,t=()=>{}){t(0,"Storing each peerstore key under a single datastore key"),await e.datastore.open();let r={},n=[];for await(let{key:i,value:o}of e.datastore.query({prefix:"/peers"})){n.push(i);let u=i.toString(),[s,c,h,y,w]=u.split("/");if(c==="peers"&&!!["protos","addrs","metadata","keys"].includes(h)&&!!y)if(r[y]=r[y]||{addresses:[],protocols:[],metadata:[]},h==="protos"){let S=Wf.decode(o);r[y].protocols=S.protocols.sort()}else if(h==="addrs"){let S=Gf.decode(o);r[y].addresses=S.addrs.sort((d,k)=>new al.Multiaddr(d.multiaddr).toString().localeCompare(new al.Multiaddr(k.multiaddr).toString())),S.certifiedRecord&&S.certifiedRecord.raw&&(r[y].peerRecordEnvelope=S.certifiedRecord.raw)}else h==="metadata"?r[y].metadata.push({key:w,value:o}):h==="keys"&&(r[y].pubKey=o)}t(33,"Read peer data from store");for(let i of n)await e.datastore.delete(i);t(66,"Removed existing peer data from store");for(let i of Object.keys(r)){let o=r[i];o.metadata=o.metadata.sort((s,c)=>s.key.localeCompare(c.key));let u=Qf.encode(o).finish();await e.datastore.put(new M(`/peers/${i}`),u)}await e.datastore.close(),t(100,"Stored each peerstore key under a single datastore key")}async function dD(e,t=()=>{}){t(0,"Storing each peerstore key under a multiple datastore keys"),await e.datastore.open();let r={},n=[];for await(let{key:i,value:o}of e.datastore.query({prefix:"/peers"})){n.push(i);let u=i.toString(),[s,c,h]=u.split("/");r[h]=Qf.decode(o)}t(33,"Read peer data from store");for(let i of n)await e.datastore.delete(i);t(66,"Removed existing peer data from store");for(let[i,o]of Object.entries(r)){if(o.protocols&&o.protocols.length>0&&await e.datastore.put(new M(`/peers/protos/${i}`),Wf.encode({protocols:o.protocols}).finish()),o.addresses&&o.addresses.length>0){let u=o.peerRecordEnvelope,s;if(u){let c=zg.decode(u),h=Vg.decode(c.payload);s={raw:u,seq:h.seq}}await e.datastore.put(new M(`/peers/addrs/${i}`),Gf.encode({addrs:o.addresses,certifiedRecord:s}).finish())}if(o.metadata&&o.metadata.length>0)for(let{key:u,value:s}of o.metadata)await e.datastore.put(new M(`/peers/metadata/${i}/${u}`),s);o.pubKey&&await e.datastore.put(new M(`/peers/keys/${i}`),o.pubKey)}await e.datastore.close(),t(100,"Stored each peerstore key under multiple datastore keys")}var Cw={version:12,description:"Store each peerstore peer under a single datastore key",migrate:hD,revert:dD},On={description:"Empty migration.",migrate:()=>{},revert:()=>{},empty:!0},za=[Object.assign({version:1},On),Object.assign({version:2},On),Object.assign({version:3},On),Object.assign({version:4},On),Object.assign({version:5},On),Object.assign({version:6},On),Object.assign({version:7},On),bm,Lg,Fg,$g,Cw];a();a();var Iw=x(at(),1),ul={};H(ul,{InvalidValueError:()=>Pi,MissingRepoOptionsError:()=>Vt,NonReversibleMigrationError:()=>Ri,NotInitializedRepoError:()=>qr,RequiredParameterError:()=>Ni});a();var Ri=class extends Error{constructor(e){super(e),this.name="NonReversibleMigrationError",this.code=Ri.code,this.message=e}};Ri.code="ERR_NON_REVERSIBLE_MIGRATION";var qr=class extends Error{constructor(e){super(e),this.name="NotInitializedRepoError",this.code=qr.code,this.message=e}};qr.code="ERR_NOT_INITIALIZED_REPO";var Ni=class extends Error{constructor(e){super(e),this.name="RequiredParameterError",this.code=Ni.code,this.message=e}};Ni.code="ERR_REQUIRED_PARAMETER";var Pi=class extends Error{constructor(e){super(e),this.name="InvalidValueError",this.code=Pi.code,this.message=e}};Pi.code="ERR_INVALID_VALUE";var Vt=class extends Error{constructor(e){super(e),this.name="MissingRepoOptionsError",this.code=Vt.code,this.message=e}};Vt.code="ERR_MISSING_REPO_OPTIONS";var fl=(0,Iw.default)("ipfs:repo:migrator:repo:init");async function Ow(e){if(!e)throw new Vt("Please pass repo options when trying to open a repo");let t=e.root;try{await t.open();let r=await t.has(Fo),n=await t.has(Rg);return!r||!n?(fl(`Version entry present: ${r}`),fl(`Config entry present: ${n}`),!1):!0}catch(r){return fl("While checking if repo is initialized error was thrown: "+r.message),!1}finally{if(t!==void 0)try{await t.close()}catch{}}}we();W();async function ll(e){if(!await Ow(e))throw new qr("Repo is not initialized!");let t=e.root;await t.open();try{return parseInt(A(await t.get(Fo)))}finally{await t.close()}}async function qo(e,t){if(!t)throw new Vt("Please pass repo options when trying to open a repo");let r=t.root;await r.open(),await r.put(Fo,N(String(e))),await r.close()}var Bw=x(at(),1),Tt=(0,Bw.default)("ipfs:repo:migrator");function yD(e){return e=e||za,!Array.isArray(e)||e.length===0?0:e[e.length-1].version}async function kw(e,t,r,n,{ignoreLock:i=!1,onProgress:o,isDryRun:u=!1,migrations:s}){if(s=s||za,!e)throw new ht.RequiredParameterError("Path argument is required!");if(!r)throw new ht.RequiredParameterError("repoOptions argument is required!");if(!n)throw new ht.RequiredParameterError("toVersion argument is required!");if(!Number.isInteger(n)||n<=0)throw new ht.InvalidValueError("Version has to be positive integer!");t=Kf(t);let c=await ll(t);if(c===n){Tt("Nothing to migrate.");return}if(c>n)throw new ht.InvalidValueError(`Current repo's version (${c}) is higher then toVersion (${n}), you probably wanted to revert it?`);Rw(s,c,n);let h;!u&&!i&&(h=await r.repoLock.lock(e));try{for(let y of s){if(n!==void 0&&y.version>n)break;if(!(y.version<=c)){Tt(`Migrating version ${y.version}`);try{if(!u){let w=()=>{};o&&(w=(S,d)=>o(y.version,S.toFixed(2),d)),await y.migrate(t,w)}}catch(w){let S=y.version-1;throw Tt(`An exception was raised during execution of migration. Setting the repo's version to last successfully migrated version: ${S}`),await qo(S,t),new Error(`During migration to version ${y.version} exception was raised: ${w.stack||w.message||w}`)}Tt(`Migrating to version ${y.version} finished`)}}u||await qo(n||yD(s),t),Tt("Repo successfully migrated",n!==void 0?`to version ${n}!`:"to latest version!")}finally{!u&&!i&&h&&await h.close()}}async function Lw(e,t,r,n,{ignoreLock:i=!1,onProgress:o,isDryRun:u=!1,migrations:s}){if(s=s||za,!e)throw new ht.RequiredParameterError("Path argument is required!");if(!r)throw new ht.RequiredParameterError("repoOptions argument is required!");if(!n)throw new ht.RequiredParameterError("When reverting migrations, you have to specify to which version to revert!");if(!Number.isInteger(n)||n<=0)throw new ht.InvalidValueError("Version has to be positive integer!");t=Kf(t);let c=await ll(t);if(c===n){Tt("Nothing to revert.");return}if(c<n)throw new ht.InvalidValueError(`Current repo's version (${c}) is lower then toVersion (${n}), you probably wanted to migrate it?`);Rw(s,n,c,!0);let h;!u&&!i&&(h=await r.repoLock.lock(e)),Tt(`Reverting from version ${c} to ${n}`);try{let y=s.slice().reverse();for(let w of y){if(w.version<=n)break;if(!(w.version>c)){Tt(`Reverting migration version ${w.version}`);try{if(!u){let S=()=>{};o&&(S=(d,k)=>o(w.version,d.toFixed(2),k)),await w.revert(t,S)}}catch(S){let d=w.version;throw Tt(`An exception was raised during execution of migration. Setting the repo's version to last successfully reverted version: ${d}`),await qo(d,t),S.message=`During reversion to version ${w.version} exception was raised: ${S.message}`,S}Tt(`Reverting to version ${w.version} finished`)}}u||await qo(n,t),Tt(`All migrations successfully reverted to version ${n}!`)}finally{!u&&!i&&h&&await h.close()}}function Rw(e,t,r,n=!1){let i=0;for(let o of e){if(o.version>r)break;if(o.version>t){if(n&&!o.revert)throw new ht.NonReversibleMigrationError(`It is not possible to revert to version ${t} because migration version ${o.version} is not reversible. Cancelling reversion.`);i++}}if(i!==r-t)throw new ht.InvalidValueError(`The ipfs-repo-migrations package does not have all migration to migrate from version ${t} to ${r}`)}var ht=ul,f0=x(Fw(),1);a();var Ww=x(Kw(),1),Hw=Ww.default;a();a();a();W();we();var cr="/",Gw=new TextEncoder().encode(cr),Wa=Gw[0],K=class{constructor(e,t){if(typeof e=="string")this._buf=N(e);else if(e instanceof Uint8Array)this._buf=e;else throw new Error("Invalid key, should be String of Uint8Array");if(t==null&&(t=!0),t&&this.clean(),this._buf.byteLength===0||this._buf[0]!==Wa)throw new Error("Invalid key")}toString(e="utf8"){return A(this._buf,e)}uint8Array(){return this._buf}get[Symbol.toStringTag](){return`Key(${this.toString()})`}static withNamespaces(e){return new K(e.join(cr))}static random(){return new K(ct().replace(/-/g,""))}static asKey(e){return e instanceof Uint8Array||typeof e=="string"?new K(e):typeof e.uint8Array=="function"?new K(e.uint8Array()):null}clean(){if((this._buf==null||this._buf.byteLength===0)&&(this._buf=Gw),this._buf[0]!==Wa){let e=new Uint8Array(this._buf.byteLength+1);e.fill(Wa,0,1),e.set(this._buf,1),this._buf=e}for(;this._buf.byteLength>1&&this._buf[this._buf.byteLength-1]===Wa;)this._buf=this._buf.subarray(0,-1)}less(e){let t=this.list(),r=e.list();for(let n=0;n<t.length;n++){if(r.length<n+1)return!1;let i=t[n],o=r[n];if(i<o)return!0;if(i>o)return!1}return t.length<r.length}reverse(){return K.withNamespaces(this.list().slice().reverse())}namespaces(){return this.list()}baseNamespace(){let e=this.namespaces();return e[e.length-1]}list(){return this.toString().split(cr).slice(1)}type(){return TD(this.baseNamespace())}name(){return CD(this.baseNamespace())}instance(e){return new K(this.toString()+":"+e)}path(){let e=this.parent().toString();return e.endsWith(cr)||(e+=cr),e+=this.type(),new K(e)}parent(){let e=this.list();return e.length===1?new K(cr):new K(e.slice(0,-1).join(cr))}child(e){return this.toString()===cr?e:e.toString()===cr?this:new K(this.toString()+e.toString(),!1)}isAncestorOf(e){return e.toString()===this.toString()?!1:e.toString().startsWith(this.toString())}isDecendantOf(e){return e.toString()===this.toString()?!1:this.toString().startsWith(e.toString())}isTopLevel(){return this.list().length===1}concat(...e){return K.withNamespaces([...this.namespaces(),...ID(e.map(t=>t.namespaces()))])}};function TD(e){let t=e.split(":");return t.length<2?"":t.slice(0,-1).join(":")}function CD(e){let t=e.split(":");return t[t.length-1]}function ID(e){return[].concat(...e)}var Xw=x(at(),1);W();we();a();a();var Bn=class extends Error{constructor(e){super(e),this.name="LockExistsError",this.code=Bn.code}};Bn.code="ERR_LOCK_EXISTS";var Ke=class extends Error{constructor(e){super(e),this.name="NotFoundError",this.code=Ke.code}};Ke.code="ERR_NOT_FOUND";var kn=class extends Error{constructor(e){super(e),this.name="InvalidRepoVersionError",this.code=kn.code}};kn.code="ERR_INVALID_REPO_VERSION";var Vo="ERR_REPO_NOT_INITIALIZED",Jw="ERR_REPO_ALREADY_OPEN",Qw="ERR_REPO_ALREADY_CLOSED";async function Ha(e,t,r){let n=await t(e);if(n)return n;let i=Yw(r);return i?new Promise((o,u)=>{let s=i.store("readonly").get(e.toString());s.transaction.onabort=()=>{u(s.transaction.error)},s.transaction.oncomplete=()=>{o(Boolean(s.result))}}):!1}async function Ga(e,t,r,n){if(await r(e))return t(e);let i=Yw(n);if(!i)throw new Ke;return new Promise((o,u)=>{let s=i.store("readonly").get(e.toString());s.transaction.onabort=()=>{u(s.transaction.error)},s.transaction.oncomplete=()=>{if(s.result)return o(s.result);u(new Ke)}})}function Yw(e){let t=e;for(;t.db||t.child;)if(t=t.db||t.child,t.type==="level-js"||t.constructor.name==="Level")return t}var BD=(0,Xw.default)("ipfs:repo:version"),dl=new K("version");function Zw(e){return{async exists(){return Ha(dl,e.has.bind(e),e)},async get(){let t=await Ga(dl,e.get.bind(e),e.has.bind(e),e);return parseInt(A(t),10)},set(t){return e.put(dl,N(String(t)))},async check(t){let r=await this.get();return BD("comparing version: %s and %s",r,t),r===t||r===6&&t===7||t===6&&r===7}}}a();a();var fb=x(tb(),1);a();var Wo=class extends Error{constructor(e){super(e),this.name="TimeoutError"}},yl=class extends Error{constructor(e){super(),this.name="AbortError",this.message=e}},rb=e=>globalThis.DOMException===void 0?new yl(e):new DOMException(e),nb=e=>{let t=e.reason===void 0?rb("This operation was aborted."):e.reason;return t instanceof Error?t:rb(t)};function ml(e,t,r,n){let i,o=new Promise((u,s)=>{if(typeof t!="number"||Math.sign(t)!==1)throw new TypeError(`Expected \`milliseconds\` to be a positive number, got \`${t}\``);if(t===Number.POSITIVE_INFINITY){u(e);return}if(n={customTimers:{setTimeout,clearTimeout},...n},n.signal){let{signal:c}=n;c.aborted&&s(nb(c)),c.addEventListener("abort",()=>{s(nb(c))})}i=n.customTimers.setTimeout.call(void 0,()=>{if(typeof r=="function"){try{u(r())}catch(y){s(y)}return}let c=typeof r=="string"?r:`Promise timed out after ${t} milliseconds`,h=r instanceof Error?r:new Wo(c);typeof e.cancel=="function"&&e.cancel(),s(h)},t),(async()=>{try{u(await e)}catch(c){s(c)}finally{n.customTimers.clearTimeout.call(void 0,i)}})()});return o.clear=()=>{clearTimeout(i),i=void 0},o}a();a();function gl(e,t,r){let n=0,i=e.length;for(;i>0;){let o=Math.trunc(i/2),u=n+o;r(e[u],t)<=0?(n=++u,i-=o+1):i=o}return n}var Ln=function(e,t,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(e):n?n.value:t.get(e)},ur,Ho=class{constructor(){ur.set(this,[])}enqueue(e,t){t={priority:0,...t};let r={priority:t.priority,run:e};if(this.size&&Ln(this,ur,"f")[this.size-1].priority>=t.priority){Ln(this,ur,"f").push(r);return}let n=gl(Ln(this,ur,"f"),r,(i,o)=>o.priority-i.priority);Ln(this,ur,"f").splice(n,0,r)}dequeue(){let e=Ln(this,ur,"f").shift();return e==null?void 0:e.run}filter(e){return Ln(this,ur,"f").filter(t=>t.priority===e.priority).map(t=>t.run)}get size(){return Ln(this,ur,"f").length}};ur=new WeakMap;var X=function(e,t,r,n,i){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?i.call(e,r):i?i.value=r:t.set(e,r),r},D=function(e,t,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(e):n?n.value:t.get(e)},oe,Jo,Qo,Wr,tc,Yo,Qa,Ct,Go,We,Ya,He,Xo,Kr,Xa,ib,ob,ub,sb,ab,cb,Za,wl,bl,rc,ec,RD=new Wo,El=class extends Error{},Kt=class extends fb.default{constructor(e){var t,r,n,i;if(super(),oe.add(this),Jo.set(this,void 0),Qo.set(this,void 0),Wr.set(this,0),tc.set(this,void 0),Yo.set(this,void 0),Qa.set(this,0),Ct.set(this,void 0),Go.set(this,void 0),We.set(this,void 0),Ya.set(this,void 0),He.set(this,0),Xo.set(this,void 0),Kr.set(this,void 0),Xa.set(this,void 0),Object.defineProperty(this,"timeout",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),e={carryoverConcurrencyCount:!1,intervalCap:Number.POSITIVE_INFINITY,interval:0,concurrency:Number.POSITIVE_INFINITY,autoStart:!0,queueClass:Ho,...e},!(typeof e.intervalCap=="number"&&e.intervalCap>=1))throw new TypeError(`Expected \`intervalCap\` to be a number from 1 and up, got \`${(r=(t=e.intervalCap)===null||t===void 0?void 0:t.toString())!==null&&r!==void 0?r:""}\` (${typeof e.intervalCap})`);if(e.interval===void 0||!(Number.isFinite(e.interval)&&e.interval>=0))throw new TypeError(`Expected \`interval\` to be a finite number >= 0, got \`${(i=(n=e.interval)===null||n===void 0?void 0:n.toString())!==null&&i!==void 0?i:""}\` (${typeof e.interval})`);X(this,Jo,e.carryoverConcurrencyCount,"f"),X(this,Qo,e.intervalCap===Number.POSITIVE_INFINITY||e.interval===0,"f"),X(this,tc,e.intervalCap,"f"),X(this,Yo,e.interval,"f"),X(this,We,new e.queueClass,"f"),X(this,Ya,e.queueClass,"f"),this.concurrency=e.concurrency,this.timeout=e.timeout,X(this,Xa,e.throwOnTimeout===!0,"f"),X(this,Kr,e.autoStart===!1,"f")}get concurrency(){return D(this,Xo,"f")}set concurrency(e){if(!(typeof e=="number"&&e>=1))throw new TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${e}\` (${typeof e})`);X(this,Xo,e,"f"),D(this,oe,"m",rc).call(this)}async add(e,t={}){return new Promise((r,n)=>{let i=async()=>{var o,u,s;X(this,He,(u=D(this,He,"f"),u++,u),"f"),X(this,Wr,(s=D(this,Wr,"f"),s++,s),"f");try{if(!((o=t.signal)===null||o===void 0)&&o.aborted){n(new El("The task was aborted."));return}let c=await(this.timeout===void 0&&t.timeout===void 0?e({signal:t.signal}):ml(Promise.resolve(e({signal:t.signal})),t.timeout===void 0?this.timeout:t.timeout,()=>{(t.throwOnTimeout===void 0?D(this,Xa,"f"):t.throwOnTimeout)&&n(RD)}));r(c),this.emit("completed",c)}catch(c){n(c),this.emit("error",c)}D(this,oe,"m",ub).call(this)};D(this,We,"f").enqueue(i,t),D(this,oe,"m",Za).call(this),this.emit("add")})}async addAll(e,t){return Promise.all(e.map(async r=>this.add(r,t)))}start(){return D(this,Kr,"f")?(X(this,Kr,!1,"f"),D(this,oe,"m",rc).call(this),this):this}pause(){X(this,Kr,!0,"f")}clear(){X(this,We,new(D(this,Ya,"f")),"f")}async onEmpty(){D(this,We,"f").size!==0&&await D(this,oe,"m",ec).call(this,"empty")}async onSizeLessThan(e){D(this,We,"f").size<e||await D(this,oe,"m",ec).call(this,"next",()=>D(this,We,"f").size<e)}async onIdle(){D(this,He,"f")===0&&D(this,We,"f").size===0||await D(this,oe,"m",ec).call(this,"idle")}get size(){return D(this,We,"f").size}sizeBy(e){return D(this,We,"f").filter(e).length}get pending(){return D(this,He,"f")}get isPaused(){return D(this,Kr,"f")}};Jo=new WeakMap,Qo=new WeakMap,Wr=new WeakMap,tc=new WeakMap,Yo=new WeakMap,Qa=new WeakMap,Ct=new WeakMap,Go=new WeakMap,We=new WeakMap,Ya=new WeakMap,He=new WeakMap,Xo=new WeakMap,Kr=new WeakMap,Xa=new WeakMap,oe=new WeakSet,ib=function(){return D(this,Qo,"f")||D(this,Wr,"f")<D(this,tc,"f")},ob=function(){return D(this,He,"f")<D(this,Xo,"f")},ub=function(){var e;X(this,He,(e=D(this,He,"f"),e--,e),"f"),D(this,oe,"m",Za).call(this),this.emit("next")},sb=function(){this.emit("empty"),D(this,He,"f")===0&&this.emit("idle")},ab=function(){D(this,oe,"m",bl).call(this),D(this,oe,"m",wl).call(this),X(this,Go,void 0,"f")},cb=function(){let e=Date.now();if(D(this,Ct,"f")===void 0){let t=D(this,Qa,"f")-e;if(t<0)X(this,Wr,D(this,Jo,"f")?D(this,He,"f"):0,"f");else return D(this,Go,"f")===void 0&&X(this,Go,setTimeout(()=>{D(this,oe,"m",ab).call(this)},t),"f"),!0}return!1},Za=function(){if(D(this,We,"f").size===0)return D(this,Ct,"f")&&clearInterval(D(this,Ct,"f")),X(this,Ct,void 0,"f"),D(this,oe,"m",sb).call(this),!1;if(!D(this,Kr,"f")){let e=!D(this,oe,"a",cb);if(D(this,oe,"a",ib)&&D(this,oe,"a",ob)){let t=D(this,We,"f").dequeue();return t?(this.emit("active"),t(),e&&D(this,oe,"m",wl).call(this),!0):!1}}return!1},wl=function(){D(this,Qo,"f")||D(this,Ct,"f")!==void 0||(X(this,Ct,setInterval(()=>{D(this,oe,"m",bl).call(this)},D(this,Yo,"f")),"f"),X(this,Qa,Date.now()+D(this,Yo,"f"),"f"))},bl=function(){D(this,Wr,"f")===0&&D(this,He,"f")===0&&D(this,Ct,"f")&&(clearInterval(D(this,Ct,"f")),X(this,Ct,void 0,"f")),X(this,Wr,D(this,Jo,"f")?D(this,He,"f"):0,"f"),D(this,oe,"m",rc).call(this)},rc=function(){for(;D(this,oe,"m",Za).call(this););},ec=async function(e,t){return new Promise(r=>{let n=()=>{t&&!t()||(this.off(e,n),r())};this.on(e,n)})};a();var hb=ND;function ND(e,t,r){var n,i;if(Array.isArray(t)&&(n=t.slice(0)),typeof t=="string"&&(n=t.split(".")),typeof t=="symbol"&&(n=[t]),!Array.isArray(n))throw new Error("props arg must be an array, a string or a symbol");if(i=n.pop(),!i)return!1;lb(i);for(var o;o=n.shift();)if(lb(o),typeof e[o]>"u"&&(e[o]={}),e=e[o],!e||typeof e!="object")return!1;return e[i]=r,!0}function lb(e){if(e=="__proto__"||e=="constructor"||e=="prototype")throw new Error("setting of prototype values not supported")}var nc=x(ve(),1);W();we();var PD=Kt.default?Kt.default:Kt,xl=new K("config");function db(e){let t=new PD({concurrency:1}),r={async getAll(o={}){let u=await Ga(xl,e.get.bind(e),e.has.bind(e),e);return JSON.parse(A(u))},async get(o,u={}){if(o==null)throw new Ke(`Key ${o} does not exist in config`);let s=await this.getAll(u),c=Do(s,o);if(c===void 0)throw new Ke(`Key ${o} does not exist in config`);return c},set(o,u,s={}){if(typeof o!="string"&&!(o instanceof String))throw(0,nc.default)(new Error("Invalid key type: "+typeof o),"ERR_INVALID_KEY");if(u===void 0||u instanceof Uint8Array)throw(0,nc.default)(new Error("Invalid value type: "+typeof u),"ERR_INVALID_VALUE");return t.add(()=>n({key:o,value:u},s.signal))},replace(o,u={}){if(!o||o instanceof Uint8Array)throw(0,nc.default)(new Error("Invalid value type: "+typeof o),"ERR_INVALID_VALUE");return t.add(()=>n({key:void 0,value:o},u.signal))},async exists(){return Ha(xl,e.has.bind(e),e)}};return r;async function n(o,u){if(u&&u.aborted)return;let s=o.key,c=o.value;if(s){let h=await r.getAll();return typeof h=="object"&&h!==null&&hb(h,s,c),i(h)}return i(c)}function i(o){let u=N(JSON.stringify(o,null,2));return e.put(xl,u)}}a();a();a();a();function Zo(e){if(typeof e!="object"||e===null)return!1;let t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)}function vl(e,t={}){if(!Zo(e)&&!Array.isArray(e))throw new TypeError("Expected a plain object or array");let{deep:r,compare:n}=t,i=[],o=[],u=c=>{let h=i.indexOf(c);if(h!==-1)return o[h];let y=[];return i.push(c),o.push(y),y.push(...c.map(w=>Array.isArray(w)?u(w):Zo(w)?s(w):w)),y},s=c=>{let h=i.indexOf(c);if(h!==-1)return o[h];let y={},w=Object.keys(c).sort(n);i.push(c),o.push(y);for(let S of w){let d=c[S],k;r&&Array.isArray(d)?k=u(d):k=r&&Zo(d)?s(d):d,Object.defineProperty(y,S,{...Object.getOwnPropertyDescriptor(c,S),value:k})}return y};return Array.isArray(e)?r?u(e):e.slice():s(e)}W();we();var _l=new K("datastore_spec");function pb(e){return{exists(){return e.has(_l)},async get(){let t=await e.get(_l);return JSON.parse(A(t))},async set(t){return e.put(_l,N(JSON.stringify(vl(t,{deep:!0}))))}}}a();we();var Dl=new K("api");function yb(e){return{async get(){let t=await e.get(Dl);return t&&t.toString()},set(t){return e.put(Dl,N(t.toString()))},delete(){return e.delete(Dl)}}}a();var bb=x(Rn(),1);a();a();var ic=class{constructor(e){if(!(e>0)||(e-1&e)!==0)throw new Error("Max size for a FixedFIFO should be a power of two");this.buffer=new Array(e),this.mask=e-1,this.top=0,this.btm=0,this.next=null}push(e){return this.buffer[this.top]!==void 0?!1:(this.buffer[this.top]=e,this.top=this.top+1&this.mask,!0)}shift(){let e=this.buffer[this.btm];if(e!==void 0)return this.buffer[this.btm]=void 0,this.btm=this.btm+1&this.mask,e}isEmpty(){return this.buffer[this.btm]===void 0}},$i=class{constructor(e={}){var t;this.hwm=(t=e.splitLimit)!=null?t:16,this.head=new ic(this.hwm),this.tail=this.head,this.size=0}calculateSize(e){return(e==null?void 0:e.byteLength)!=null?e.byteLength:1}push(e){if((e==null?void 0:e.value)!=null&&(this.size+=this.calculateSize(e.value)),!this.head.push(e)){let t=this.head;this.head=t.next=new ic(2*this.head.buffer.length),this.head.push(e)}}shift(){let e=this.tail.shift();if(e===void 0&&this.tail.next!=null){let t=this.tail.next;this.tail.next=null,this.tail=t,e=this.tail.shift()}return(e==null?void 0:e.value)!=null&&(this.size-=this.calculateSize(e.value)),e}isEmpty(){return this.head.isEmpty()}};function gb(e={}){return UD(t=>{let r=t.shift();if(r==null)return{done:!0};if(r.error!=null)throw r.error;return{done:r.done===!0,value:r.value}},e)}function UD(e,t){t=t!=null?t:{};let r=t.onEnd,n=new $i,i,o,u,s=async()=>n.isEmpty()?u?{done:!0}:await new Promise((g,m)=>{o=B=>{o=null,n.push(B);try{g(e(n))}catch(O){m(O)}return i}}):e(n),c=g=>o!=null?o(g):(n.push(g),i),h=g=>(n=new $i,o!=null?o({error:g}):(n.push({error:g}),i)),y=g=>{if(u)return i;if((t==null?void 0:t.objectMode)!==!0&&(g==null?void 0:g.byteLength)==null)throw new Error("objectMode was not true but tried to push non-Uint8Array value");return c({done:!1,value:g})},w=g=>u?i:(u=!0,g!=null?h(g):c({done:!0})),S=()=>(n=new $i,w(),{done:!0}),d=g=>(w(g),{done:!0});if(i={[Symbol.asyncIterator](){return this},next:s,return:S,throw:d,push:y,end:w,get readableLength(){return n.size}},r==null)return i;let k=i;return i={[Symbol.asyncIterator](){return this},next(){return k.next()},throw(g){return k.throw(g),r!=null&&(r(g),r=void 0),{done:!0}},return(){return k.return(),r!=null&&(r(),r=void 0),{done:!0}},push:y,end(g){return k.end(g),r!=null&&(r(g),r=void 0),i},get readableLength(){return k.readableLength}},i}var Eb=x(Nn(),1);q();var xb=x(ve(),1);pa();function vb(e){return{open(){return e.open()},close(){return e.close()},query(t,r){return e.query(t,r)},queryKeys(t,r){return e.queryKeys(t,r)},async get(t,r){let n=Hr(t);return n.isIdentity?Promise.resolve(n.digest):e.get(t,r)},async*getMany(t,r){for await(let n of t)yield this.get(n,r)},async put(t,r,n){let{isIdentity:i}=Hr(t);i||await e.put(t,r,n)},async*putMany(t,r){let n=gb({objectMode:!0});(globalThis.process&&globalThis.process.nextTick?globalThis.process.nextTick:globalThis.setImmediate||globalThis.setTimeout)(async()=>{try{await(0,Eb.default)(e.putMany(async function*(){for await(let{key:i,value:o}of t)Hr(i).isIdentity||(yield{key:i,value:o}),n.push({key:i,value:o})}())),n.end()}catch(i){n.end(i)}}),yield*n},has(t,r){let{isIdentity:n}=Hr(t);return n?Promise.resolve(!0):e.has(t,r)},delete(t,r){let{isIdentity:n}=Hr(t);return n?Promise.resolve():e.delete(t,r)},deleteMany(t,r){return e.deleteMany((0,bb.default)(t,n=>!Hr(n).isIdentity),r)},batch(){let t=e.batch();return{put(r,n){let{isIdentity:i}=Hr(r);i||t.put(r,n)},delete(r){let{isIdentity:n}=Hr(r);n||t.delete(r)},commit:r=>t.commit(r)}}}}function Hr(e){let t=E.asCID(e);if(t==null)throw(0,xb.default)(new Error("Not a valid cid"),"ERR_INVALID_CID");return t.multihash.code!==Si.code?{isIdentity:!1}:{isIdentity:!0,digest:t.multihash.digest}}a();a();var _b=x(at(),1),Db=(0,_b.default)("ipfs:repo:lock:memory"),Sb="repo.lock",es={};async function MD(e){let t=e+"/"+Sb;if(Db("locking %s",t),es[t]===!0)throw new Bn(`Lock already being held for file: ${t}`);return es[t]=!0,{async close(){es[t]&&delete es[t]}}}async function jD(e){let t=e+"/"+Sb;return Db(`checking lock: ${t}`),Boolean(es[t])}var oc={lock:MD,locked:jD},Ab={autoMigrate:!0,onMigrationProgress:()=>{},repoOwner:!0,repoLock:oc};a();var Sl={Spec:{type:"mount",mounts:[{mountpoint:"/blocks",type:"measure",prefix:"flatfs.datastore",child:{type:"flatfs",path:"blocks",sync:!0,shardFunc:"/repo/flatfs/shard/v1/next-to-last/2"}},{mountpoint:"/",type:"measure",prefix:"leveldb.datastore",child:{type:"levelds",path:"datastore",compression:"none"}}]}};a();q();var Ob=x(ve(),1),Bb=x(at(),1),Cl=x(Al(),1);a();Ei();ir();var Cb=x(ve(),1);xe();Ee();function ts(e){let t=E.asCID(e);if(t==null)throw(0,Cb.default)(new Error("Not a valid cid"),"ERR_INVALID_CID");let r=C.encode(t.multihash.bytes);return new K("/"+r.slice(1).toUpperCase(),!1)}function Tl(e){return G(C.decode(`b${e.toString().toLowerCase().substring(1)}`))}a();var Ib=x(at(),1),qD=(0,Ib.default)("ipfs:repo:utils:walk-dag");async function*Mi(e,t,r,n){try{let i=await t.get(e,n),o=await r(e.code),u=En({bytes:i,cid:e,codec:o});for(let[,s]of u.links())yield s,yield*Mi(s,t,r,n)}catch(i){throw qD("Could not walk DAG for CID",e.toString(),i),i}}a();var Pe={direct:"direct",recursive:"recursive",indirect:"indirect",all:"all"};a();var rs=class extends Map{constructor(e={}){if(super(),!(e.maxSize&&e.maxSize>0))throw new TypeError("`maxSize` must be a number greater than 0");if(typeof e.maxAge=="number"&&e.maxAge===0)throw new TypeError("`maxAge` must be a number greater than 0");this.maxSize=e.maxSize,this.maxAge=e.maxAge||Number.POSITIVE_INFINITY,this.onEviction=e.onEviction,this.cache=new Map,this.oldCache=new Map,this._size=0}_emitEvictions(e){if(typeof this.onEviction=="function")for(let[t,r]of e)this.onEviction(t,r.value)}_deleteIfExpired(e,t){return typeof t.expiry=="number"&&t.expiry<=Date.now()?(typeof this.onEviction=="function"&&this.onEviction(e,t.value),this.delete(e)):!1}_getOrDeleteIfExpired(e,t){if(this._deleteIfExpired(e,t)===!1)return t.value}_getItemValue(e,t){return t.expiry?this._getOrDeleteIfExpired(e,t):t.value}_peek(e,t){let r=t.get(e);return this._getItemValue(e,r)}_set(e,t){this.cache.set(e,t),this._size++,this._size>=this.maxSize&&(this._size=0,this._emitEvictions(this.oldCache),this.oldCache=this.cache,this.cache=new Map)}_moveToRecent(e,t){this.oldCache.delete(e),this._set(e,t)}*_entriesAscending(){for(let e of this.oldCache){let[t,r]=e;this.cache.has(t)||this._deleteIfExpired(t,r)===!1&&(yield e)}for(let e of this.cache){let[t,r]=e;this._deleteIfExpired(t,r)===!1&&(yield e)}}get(e){if(this.cache.has(e)){let t=this.cache.get(e);return this._getItemValue(e,t)}if(this.oldCache.has(e)){let t=this.oldCache.get(e);if(this._deleteIfExpired(e,t)===!1)return this._moveToRecent(e,t),t.value}}set(e,t,{maxAge:r=this.maxAge}={}){let n=typeof r=="number"&&r!==Number.POSITIVE_INFINITY?Date.now()+r:void 0;this.cache.has(e)?this.cache.set(e,{value:t,expiry:n}):this._set(e,{value:t,expiry:n})}has(e){return this.cache.has(e)?!this._deleteIfExpired(e,this.cache.get(e)):this.oldCache.has(e)?!this._deleteIfExpired(e,this.oldCache.get(e)):!1}peek(e){if(this.cache.has(e))return this._peek(e,this.cache);if(this.oldCache.has(e))return this._peek(e,this.oldCache)}delete(e){let t=this.cache.delete(e);return t&&this._size--,this.oldCache.delete(e)||t}clear(){this.cache.clear(),this.oldCache.clear(),this._size=0}resize(e){if(!(e&&e>0))throw new TypeError("`maxSize` must be a number greater than 0");let t=[...this._entriesAscending()],r=t.length-e;r<0?(this.cache=new Map(t),this.oldCache=new Map,this._size=t.length):(r>0&&this._emitEvictions(t.slice(0,r)),this.oldCache=new Map(t.slice(r)),this.cache=new Map,this._size=0),this.maxSize=e}*keys(){for(let[e]of this)yield e}*values(){for(let[,e]of this)yield e}*[Symbol.iterator](){for(let e of this.cache){let[t,r]=e;this._deleteIfExpired(t,r)===!1&&(yield[t,r.value])}for(let e of this.oldCache){let[t,r]=e;this.cache.has(t)||this._deleteIfExpired(t,r)===!1&&(yield[t,r.value])}}*entriesDescending(){let e=[...this.cache];for(let t=e.length-1;t>=0;--t){let r=e[t],[n,i]=r;this._deleteIfExpired(n,i)===!1&&(yield[n,i.value])}e=[...this.oldCache];for(let t=e.length-1;t>=0;--t){let r=e[t],[n,i]=r;this.cache.has(n)||this._deleteIfExpired(n,i)===!1&&(yield[n,i.value])}}*entriesAscending(){for(let[e,t]of this._entriesAscending())yield[e,t.value]}get size(){if(!this._size)return this.oldCache.size;let e=0;for(let t of this.oldCache.keys())this.cache.has(t)||e++;return Math.min(this._size+e,this.maxSize)}entries(){return this.entriesAscending()}forEach(e,t=this){for(let[r,n]of this.entriesAscending())e.call(t,n,r,this)}get[Symbol.toStringTag](){return JSON.stringify([...this.entriesAscending()])}},VD=2048;function KD(e){let t=`Invalid type '${e}', must be one of {direct, indirect, recursive, all}`;return(0,Ob.default)(new Error(t),"ERR_INVALID_PIN_TYPE")}var sc=class{constructor({pinstore:e,blockstore:t,loadCodec:r}){this.pinstore=e,this.blockstore=t,this.loadCodec=r,this.log=(0,Bb.default)("ipfs:repo:pin"),this.directPins=new Set,this.recursivePins=new Set}async pinDirectly(e,t={}){await this.blockstore.get(e,t);let r={depth:0};return e.version!==0&&(r.version=e.version),e.code!==xt&&(r.codec=e.code),t.metadata&&(r.metadata=t.metadata),this.pinstore.put(ts(e),nr(r))}unpin(e,t){return this.pinstore.delete(ts(e),t)}async pinRecursively(e,t={}){await this.fetchCompleteDag(e,t);let r={depth:1/0};e.version!==0&&(r.version=e.version),e.code!==xt&&(r.codec=e.code),t.metadata&&(r.metadata=t.metadata),await this.pinstore.put(ts(e),nr(r))}async*directKeys(e){for await(let t of this.pinstore.query({filters:[r=>nt(r.value).depth===0]})){let r=nt(t.value),n=r.version||0,i=r.codec!=null?r.codec:xt,o=Tl(t.key);yield{cid:E.create(n,i,o),metadata:r.metadata}}}async*recursiveKeys(e){for await(let t of this.pinstore.query({filters:[r=>nt(r.value).depth===1/0]})){let r=nt(t.value),n=r.version||0,i=r.codec!=null?r.codec:xt,o=Tl(t.key);yield{cid:E.create(n,i,o),metadata:r.metadata}}}async*indirectKeys(e){for await(let{cid:t}of this.recursiveKeys())for await(let r of Mi(t,this.blockstore,this.loadCodec,e)){let n=[Pe.recursive];(await this.isPinnedWithType(r,n)).pinned||(yield r)}}async isPinnedWithType(e,t,r){Array.isArray(t)||(t=[t]);let n=t.includes(Pe.all),i=t.includes(Pe.direct),o=t.includes(Pe.recursive),u=t.includes(Pe.indirect);if(o||i||n){let h=await(0,Cl.default)(this.pinstore.query({prefix:ts(e).toString(),filters:[y=>{if(n)return!0;let w=nt(y.value);return t.includes(w.depth===0?Pe.direct:Pe.recursive)}],limit:1}));if(h){let y=nt(h.value);return{cid:e,pinned:!0,reason:y.depth===0?Pe.direct:Pe.recursive,metadata:y.metadata}}}let s=this;async function*c(h,y){for await(let{cid:w}of y)for await(let S of Mi(w,s.blockstore,s.loadCodec))if(S.equals(h)){yield w;return}}if(n||u){let h=await(0,Cl.default)(c(e,this.recursiveKeys()));if(h)return{cid:e,pinned:!0,reason:Pe.indirect,parent:h}}return{cid:e,pinned:!1}}async fetchCompleteDag(e,t={}){var i;let r=new rs({maxSize:(i=t.cidCacheMaxSize)!=null?i:VD}),n=async(o,u)=>{if(r.has(o.toString()))return;r.set(o.toString(),!0);let s=await this.blockstore.get(o,u),c=await this.loadCodec(o.code),h=En({bytes:s,cid:o,codec:c});await Promise.all([...h.links()].map(([,y])=>n(y,u)))};await n(e,t)}static checkPinType(e){if(typeof e!="string"||!Object.keys(Pe).includes(e))throw KD(e);return!0}};a();var Rb=x(ji(),1),Nb=x(ve(),1);function Pb(e,t){return{open(){return t.open()},close(){return t.close()},query(r,n){return t.query(r,n)},queryKeys(r,n){return t.queryKeys(r,n)},async get(r,n){return t.get(r,n)},async*getMany(r,n){yield*t.getMany(r,n)},async put(r,n,i){await t.put(r,n,i)},async*putMany(r,n){yield*t.putMany(r,n)},has(r,n){return t.has(r,n)},async delete(r,n){return await Lb(r,e),t.delete(r,n)},deleteMany(r,n){return t.deleteMany((0,Rb.default)(r,async i=>(await Lb(i,e),i)),n)},batch(){return t.batch()}}}async function Lb(e,t){let{pinned:r,reason:n}=await t.isPinnedWithType(e,Pe.all);if(r)throw(0,Nb.default)(new Error(`pinned: ${n}`),"ERR_BLOCK_PINNED")}a();a();var Il=class extends Error{constructor(e){super(e),this.name="TimeoutError"}},Ol=class extends Error{constructor(e){super(),this.name="AbortError",this.message=e}},Fb=e=>globalThis.DOMException===void 0?new Ol(e):new DOMException(e),Ub=e=>{let t=e.reason===void 0?Fb("This operation was aborted."):e.reason;return t instanceof Error?t:Fb(t)};function Bl(e,t){let{milliseconds:r,fallback:n,message:i,customTimers:o={setTimeout,clearTimeout}}=t,u,s=new Promise((c,h)=>{if(typeof r!="number"||Math.sign(r)!==1)throw new TypeError(`Expected \`milliseconds\` to be a positive number, got \`${r}\``);if(r===Number.POSITIVE_INFINITY){c(e);return}if(t.signal){let{signal:y}=t;y.aborted&&h(Ub(y)),y.addEventListener("abort",()=>{h(Ub(y))})}u=o.setTimeout.call(void 0,()=>{if(n){try{c(n())}catch(S){h(S)}return}let y=typeof i=="string"?i:`Promise timed out after ${r} milliseconds`,w=i instanceof Error?i:new Il(y);typeof e.cancel=="function"&&e.cancel(),h(w)},r),(async()=>{try{c(await e)}catch(y){h(y)}finally{o.clearTimeout.call(void 0,u)}})()});return s.clear=()=>{o.clearTimeout.call(void 0,u),u=void 0},s}a();a();var $b=(e=21)=>crypto.getRandomValues(new Uint8Array(e)).reduce((t,r)=>(r&=63,r<36?t+=r.toString(36):r<62?t+=(r-26).toString(36).toUpperCase():r>62?t+="-":t+="_",t),"");a();var kl="lock:worker:request-read",Ll="lock:worker:release-read",Rl="lock:master:grant-read",Nl="lock:worker:request-write",Pl="lock:worker:release-write",Fl="lock:master:grant-write";a();var Gr={},zi=e=>{e.addEventListener("message",t=>{zi.dispatchEvent("message",e,t)}),e.port!=null&&e.port.addEventListener("message",t=>{zi.dispatchEvent("message",e,t)})};zi.addEventListener=(e,t)=>{Gr[e]==null&&(Gr[e]=[]),Gr[e].push(t)};zi.removeEventListener=(e,t)=>{Gr[e]!=null&&(Gr[e]=Gr[e].filter(r=>r===t))};zi.dispatchEvent=function(e,t,r){Gr[e]!=null&&Gr[e].forEach(n=>n(t,r))};var Ul=zi,Mb=(e,t,r,n,i)=>(o,u)=>{if(u.data.type!==r)return;let s={type:u.data.type,name:u.data.name,identifier:u.data.identifier};e.dispatchEvent(new MessageEvent(t,{data:{name:s.name,handler:async()=>(o.postMessage({type:i,name:s.name,identifier:s.identifier}),await new Promise(c=>{let h=y=>{if(y==null||y.data==null)return;let w={type:y.data.type,name:y.data.name,identifier:y.data.identifier};w.type===n&&w.identifier===s.identifier&&(o.removeEventListener("message",h),c())};o.addEventListener("message",h)}))}}))},jb=(e,t,r,n)=>async()=>{let i=$b();return globalThis.postMessage({type:t,identifier:i,name:e}),await new Promise(o=>{let u=s=>{if(s==null||s.data==null)return;let c={type:s.data.type,identifier:s.data.identifier};c.type===r&&c.identifier===i&&(globalThis.removeEventListener("message",u),o(()=>{globalThis.postMessage({type:n,identifier:i,name:e})}))};globalThis.addEventListener("message",u)})},HD={singleProcess:!1},zb=e=>{if(e=Object.assign({},HD,e),Boolean(globalThis.document)||e.singleProcess){let t=new EventTarget;return Ul.addEventListener("message",Mb(t,"requestReadLock",kl,Ll,Rl)),Ul.addEventListener("message",Mb(t,"requestWriteLock",Nl,Pl,Fl)),t}return{isWorker:!0,readLock:t=>jb(t,kl,Rl,Ll),writeLock:t=>jb(t,Nl,Fl,Pl)}},Pn={},Jr;async function $l(e,t){let r,n=new Promise(i=>{r=i});return e.add(async()=>await Bl((async()=>await new Promise(i=>{r(()=>{i()})}))(),{milliseconds:t.timeout})),await n}var GD=(e,t)=>{if(Jr.isWorker===!0)return{readLock:Jr.readLock(e,t),writeLock:Jr.writeLock(e,t)};let r=new Kt({concurrency:1}),n;return{async readLock(){if(n!=null)return await $l(n,t);n=new Kt({concurrency:t.concurrency,autoStart:!1});let i=n,o=$l(n,t);return r.add(async()=>(i.start(),await i.onIdle().then(()=>{n===i&&(n=null)}))),await o},async writeLock(){return n=null,await $l(r,t)}}},JD={name:"lock",concurrency:1/0,timeout:846e5,singleProcess:!1};function Ml(e){let t=Object.assign({},JD,e);return Jr==null&&(Jr=zb(t),Jr.isWorker!==!0&&(Jr.addEventListener("requestReadLock",r=>{Pn[r.data.name]!=null&&Pn[r.data.name].readLock().then(async n=>await r.data.handler().finally(()=>n()))}),Jr.addEventListener("requestWriteLock",async r=>{Pn[r.data.name]!=null&&Pn[r.data.name].writeLock().then(async n=>await r.data.handler().finally(()=>n()))}))),Pn[t.name]==null&&(Pn[t.name]=GD(t.name,t)),Pn[t.name]}a();q();var i0=x(at(),1),o0=x(Wb(),1);a();a();a();var ac=class{constructor(e){if(!(e>0)||(e-1&e)!==0)throw new Error("Max size for a FixedFIFO should be a power of two");this.buffer=new Array(e),this.mask=e-1,this.top=0,this.btm=0,this.next=null}push(e){return this.buffer[this.top]!==void 0?!1:(this.buffer[this.top]=e,this.top=this.top+1&this.mask,!0)}shift(){let e=this.buffer[this.btm];if(e!==void 0)return this.buffer[this.btm]=void 0,this.btm=this.btm+1&this.mask,e}isEmpty(){return this.buffer[this.btm]===void 0}},qi=class{constructor(e={}){var t;this.hwm=(t=e.splitLimit)!=null?t:16,this.head=new ac(this.hwm),this.tail=this.head,this.size=0}calculateSize(e){return(e==null?void 0:e.byteLength)!=null?e.byteLength:1}push(e){if((e==null?void 0:e.value)!=null&&(this.size+=this.calculateSize(e.value)),!this.head.push(e)){let t=this.head;this.head=t.next=new ac(2*this.head.buffer.length),this.head.push(e)}}shift(){let e=this.tail.shift();if(e===void 0&&this.tail.next!=null){let t=this.tail.next;this.tail.next=null,this.tail=t,e=this.tail.shift()}return(e==null?void 0:e.value)!=null&&(this.size-=this.calculateSize(e.value)),e}isEmpty(){return this.head.isEmpty()}};function Hb(e={}){return ZD(t=>{let r=t.shift();if(r==null)return{done:!0};if(r.error!=null)throw r.error;return{done:r.done===!0,value:r.value}},e)}function ZD(e,t){t=t!=null?t:{};let r=t.onEnd,n=new qi,i,o,u,s=async()=>n.isEmpty()?u?{done:!0}:await new Promise((g,m)=>{o=B=>{o=null,n.push(B);try{g(e(n))}catch(O){m(O)}return i}}):e(n),c=g=>o!=null?o(g):(n.push(g),i),h=g=>(n=new qi,o!=null?o({error:g}):(n.push({error:g}),i)),y=g=>{if(u)return i;if((t==null?void 0:t.objectMode)!==!0&&(g==null?void 0:g.byteLength)==null)throw new Error("objectMode was not true but tried to push non-Uint8Array value");return c({done:!1,value:g})},w=g=>u?i:(u=!0,g!=null?h(g):c({done:!0})),S=()=>(n=new qi,w(),{done:!0}),d=g=>(w(g),{done:!0});if(i={[Symbol.asyncIterator](){return this},next:s,return:S,throw:d,push:y,end:w,get readableLength(){return n.size}},r==null)return i;let k=i;return i={[Symbol.asyncIterator](){return this},next(){return k.next()},throw(g){return k.throw(g),r!=null&&(r(g),r=void 0),{done:!0}},return(){return k.return(),r!=null&&(r(),r=void 0),{done:!0}},push:y,end(g){return k.end(g),r!=null&&(r(g),r=void 0),i},get readableLength(){return k.readableLength}},i}var r0=x(cc(),1),rS=(...e)=>{let t;for(;e.length>0;)t=e.shift()(t);return t},n0=e=>e!=null&&(typeof e[Symbol.asyncIterator]=="function"||typeof e[Symbol.iterator]=="function"||typeof e.next=="function"),zl=e=>e!=null&&typeof e.sink=="function"&&n0(e.source),nS=e=>t=>{let r=e.sink(t);if(r.then!=null){let n=Hb({objectMode:!0});return r.then(()=>{n.end()},i=>{n.end(i)}),(0,r0.default)(n,async function*(){yield*e.source,n.end()}())}return e.source};function ql(e,...t){if(zl(e)){let n=e;e=()=>n.source}else if(n0(e)){let n=e;e=()=>n}let r=[e,...t];if(r.length>1&&zl(r[r.length-1])&&(r[r.length-1]=r[r.length-1].sink),r.length>2)for(let n=1;n<r.length-1;n++)zl(r[n])&&(r[n]=nS(r[n]));return rS(...r)}var Vl=x(cc(),1),uc=x(ji(),1),s0=x(Rn(),1);xe();var ns=(0,i0.default)("ipfs:repo:gc"),iS=qt().code,oS=256,sS=new K("/local/filesroot");function a0({gcLock:e,pins:t,blockstore:r,root:n,loadCodec:i}){async function*o(){let u=Date.now();ns("Creating set of marked blocks");let s=await e.writeLock();try{let c=await aS({pins:t,blockstore:r,root:n,loadCodec:i}),h=r.queryKeys({});yield*cS({blockstore:r},c,h),ns(`Complete (${Date.now()-u}ms)`)}finally{s()}}return o}async function aS({pins:e,blockstore:t,loadCodec:r,root:n}){let i=async function*(){let s;try{s=await n.get(sS)}catch(h){if(h.code===iS){ns("No blocks in MFS");return}throw h}let c=E.decode(s);yield c,yield*Mi(c,t,r)}(),o=(0,Vl.default)((0,uc.default)(e.recursiveKeys(),({cid:s})=>s),e.indirectKeys(),(0,uc.default)(e.directKeys(),({cid:s})=>s),i),u=new Set;for await(let s of(0,Vl.default)(o,i))u.add(C.encode(s.multihash.bytes));return u}async function*cS({blockstore:e},t,r){let n=0,i=0;yield*ql((0,o0.default)((0,uc.default)(r,async o=>async function(){n++;try{let u=C.encode(o.multihash.bytes);if(t.has(u))return null;try{await e.delete(o),i++}catch(s){return{err:new Error(`Could not delete block with CID ${o}: ${s.message}`)}}return{cid:o}}catch(u){let s=`Could delete block with CID ${o}`;return ns(s,u),{err:new Error(s+`: ${u.message}`)}}}),oS),o=>(0,s0.default)(o,Boolean)),ns(`Marked set has ${t.size} unique blocks. Blockstore has ${n} blocks. Deleted ${i} blocks.`)}var Fe=(0,u0.default)("ipfs:repo"),uS=Number.MAX_SAFE_INTEGER,fS="repoAutoMigrate",Wl=class{constructor(e,t,r,n){if(typeof e!="string")throw new Error("missing repo path");if(typeof t!="function")throw new Error("missing codec loader");this.options=Hw(Ab,n),this.closed=!0,this.path=e,this.root=r.root,this.datastore=r.datastore,this.keys=r.keys;let i=r.blocks,o=r.pins;this.pins=new sc({pinstore:o,blockstore:i,loadCodec:t});let u=Pb(this.pins,i);this.blocks=vb(u),this.version=Zw(this.root),this.config=db(this.root),this.spec=pb(this.root),this.apiAddr=yb(this.root),this.gcLock=Ml({name:e,singleProcess:this.options.repoOwner!==!1}),this.gc=a0({gcLock:this.gcLock,pins:this.pins,blockstore:this.blocks,root:this.root,loadCodec:t})}async init(e){Fe("initializing at: %s",this.path),await this._openRoot(),await this.config.replace(lS(e)),await this.spec.set(hS(e)),await this.version.set(12)}async isInitialized(){if(!this.closed)return!0;try{return await this._openRoot(),await this._checkInitialized(),await this.root.close(),!0}catch{return!1}}async open(){if(!this.closed)throw(0,Fn.default)(new Error("repo is already open"),Jw);Fe("opening at: %s",this.path);try{if(await this._openRoot(),await this._checkInitialized(),this._lockfile=await this._openLock(),Fe("acquired repo.lock"),!await this.version.check(12))if(await this._isAutoMigrationEnabled())await this._migrate(12,{root:this.root,datastore:this.datastore,pins:this.pins.pinstore,blocks:this.pins.blockstore,keys:this.keys});else throw new kn("Incompatible repo versions. Automatic migrations disabled. Please migrate the repo manually.");Fe("creating datastore"),await this.datastore.open(),Fe("creating blocks"),await this.blocks.open(),Fe("creating keystore"),await this.keys.open(),Fe("creating pins"),await this.pins.pinstore.open(),this.closed=!1,Fe("all opened")}catch(e){if(this._lockfile)try{await this._closeLock(),this._lockfile=null}catch(t){Fe("error removing lock",t)}throw e}}async _openRoot(){try{await this.root.open()}catch(e){if(e.message!=="Already open")throw e}}async _openLock(){let e=await this.options.repoLock.lock(this.path);if(typeof e.close!="function")throw(0,Fn.default)(new Error("Locks must have a close method"),"ERR_NO_CLOSE_FUNCTION");return e}_closeLock(){return this._lockfile&&this._lockfile.close()}async _checkInitialized(){Fe("init check");let e;try{[e]=await Promise.all([this.config.exists(),this.spec.exists(),this.version.exists()])}catch(t){throw t.code==="ERR_NOT_FOUND"?(0,Fn.default)(new Error("repo is not initialized yet"),Vo,{path:this.path}):t}if(!e)throw(0,Fn.default)(new Error("repo is not initialized yet"),Vo,{path:this.path})}async close(){if(this.closed)throw(0,Fn.default)(new Error("repo is already closed"),Qw);Fe("closing at: %s",this.path);try{await this.apiAddr.delete()}catch(e){if(e.code!==Vo&&!e.message.startsWith("ENOENT"))throw e}await Promise.all([this.root,this.blocks,this.keys,this.datastore,this.pins.pinstore].map(e=>e&&e.close())),Fe("unlocking"),this.closed=!0,await this._closeLock()}exists(){return this.version.exists()}async stat(){if(this.datastore&&this.keys){let[e,t,r,n,i]=await Promise.all([this._storageMaxStat(),this._blockStat(),this.version.get(),c0(this.datastore),c0(this.keys)]),o=t.size+n+i;return{repoPath:this.path,storageMax:e,version:r,numObjects:t.count,repoSize:o}}throw(0,Fn.default)(new Error("repo is not initialized yet"),Vo,{path:this.path})}async _isAutoMigrationEnabled(){if(this.options.autoMigrate!==void 0)return this.options.autoMigrate;let e;try{e=await this.config.get(fS)}catch(t){if(t.code===Ke.code)e=!0;else throw t}return e}async _migrate(e,t){return await this.version.get()>e?(Fe(`reverting to version ${e}`),Lw(this.path,t,this.options,e,{ignoreLock:!0,onProgress:this.options.onMigrationProgress})):(Fe(`migrating to version ${e}`),kw(this.path,t,this.options,e,{ignoreLock:!0,onProgress:this.options.onMigrationProgress}))}async _storageMaxStat(){try{let e=await this.config.get("Datastore.StorageMax");return BigInt((0,f0.default)(e))}catch{return BigInt(uS)}}async _blockStat(){let e=BigInt(0),t=BigInt(0);if(this.blocks)for await(let{key:r,value:n}of this.blocks.query({}))e+=BigInt(1),t+=BigInt(n.byteLength),t+=BigInt(r.bytes.byteLength);return{count:e,size:t}}};async function c0(e){let t=BigInt(0);for await(let r of e.query({}))t+=BigInt(r.value.byteLength),t+=BigInt(r.key.uint8Array().byteLength);return t}function fc(e,t,r,n){return new Wl(e,t,r,n)}function lS(e){return e.Datastore=Object.assign({},Sl,Do(e,"datastore")),e}function hS(e){let t={...Sl.Spec,...Do(e,"Datastore.Spec")};return{type:t.type,mounts:t.mounts.map(r=>({mountpoint:r.mountpoint,type:r.child.type,path:r.child.path,shardFunc:r.child.shardFunc}))}}a();a();a();W();we();var fr="/",l0=new TextEncoder().encode(fr),lc=l0[0],ye=class{constructor(e,t){if(typeof e=="string")this._buf=N(e);else if(e instanceof Uint8Array)this._buf=e;else throw new Error("Invalid key, should be String of Uint8Array");if(t==null&&(t=!0),t&&this.clean(),this._buf.byteLength===0||this._buf[0]!==lc)throw new Error("Invalid key")}toString(e="utf8"){return A(this._buf,e)}uint8Array(){return this._buf}get[Symbol.toStringTag](){return`Key(${this.toString()})`}static withNamespaces(e){return new ye(e.join(fr))}static random(){return new ye(ct().replace(/-/g,""))}static asKey(e){return e instanceof Uint8Array||typeof e=="string"?new ye(e):typeof e.uint8Array=="function"?new ye(e.uint8Array()):null}clean(){if((this._buf==null||this._buf.byteLength===0)&&(this._buf=l0),this._buf[0]!==lc){let e=new Uint8Array(this._buf.byteLength+1);e.fill(lc,0,1),e.set(this._buf,1),this._buf=e}for(;this._buf.byteLength>1&&this._buf[this._buf.byteLength-1]===lc;)this._buf=this._buf.subarray(0,-1)}less(e){let t=this.list(),r=e.list();for(let n=0;n<t.length;n++){if(r.length<n+1)return!1;let i=t[n],o=r[n];if(i<o)return!0;if(i>o)return!1}return t.length<r.length}reverse(){return ye.withNamespaces(this.list().slice().reverse())}namespaces(){return this.list()}baseNamespace(){let e=this.namespaces();return e[e.length-1]}list(){return this.toString().split(fr).slice(1)}type(){return dS(this.baseNamespace())}name(){return pS(this.baseNamespace())}instance(e){return new ye(this.toString()+":"+e)}path(){let e=this.parent().toString();return e.endsWith(fr)||(e+=fr),e+=this.type(),new ye(e)}parent(){let e=this.list();return e.length===1?new ye(fr):new ye(e.slice(0,-1).join(fr))}child(e){return this.toString()===fr?e:e.toString()===fr?this:new ye(this.toString()+e.toString(),!1)}isAncestorOf(e){return e.toString()===this.toString()?!1:e.toString().startsWith(this.toString())}isDecendantOf(e){return e.toString()===this.toString()?!1:this.toString().startsWith(e.toString())}isTopLevel(){return this.list().length===1}concat(...e){return ye.withNamespaces([...this.namespaces(),...yS(e.map(t=>t.namespaces()))])}};function dS(e){let t=e.split(":");return t.length<2?"":t.slice(0,-1).join(":")}function pS(e){let t=e.split(":");return t[t.length-1]}function yS(e){return[].concat(...e)}a();a();a();W();we();var lr="/",h0=new TextEncoder().encode(lr),hc=h0[0],Z=class{constructor(e,t){if(typeof e=="string")this._buf=N(e);else if(e instanceof Uint8Array)this._buf=e;else throw new Error("Invalid key, should be String of Uint8Array");if(t==null&&(t=!0),t&&this.clean(),this._buf.byteLength===0||this._buf[0]!==hc)throw new Error("Invalid key")}toString(e="utf8"){return A(this._buf,e)}uint8Array(){return this._buf}get[Symbol.toStringTag](){return`Key(${this.toString()})`}static withNamespaces(e){return new Z(e.join(lr))}static random(){return new Z(ct().replace(/-/g,""))}static asKey(e){return e instanceof Uint8Array||typeof e=="string"?new Z(e):typeof e.uint8Array=="function"?new Z(e.uint8Array()):null}clean(){if((this._buf==null||this._buf.byteLength===0)&&(this._buf=h0),this._buf[0]!==hc){let e=new Uint8Array(this._buf.byteLength+1);e.fill(hc,0,1),e.set(this._buf,1),this._buf=e}for(;this._buf.byteLength>1&&this._buf[this._buf.byteLength-1]===hc;)this._buf=this._buf.subarray(0,-1)}less(e){let t=this.list(),r=e.list();for(let n=0;n<t.length;n++){if(r.length<n+1)return!1;let i=t[n],o=r[n];if(i<o)return!0;if(i>o)return!1}return t.length<r.length}reverse(){return Z.withNamespaces(this.list().slice().reverse())}namespaces(){return this.list()}baseNamespace(){let e=this.namespaces();return e[e.length-1]}list(){return this.toString().split(lr).slice(1)}type(){return mS(this.baseNamespace())}name(){return gS(this.baseNamespace())}instance(e){return new Z(this.toString()+":"+e)}path(){let e=this.parent().toString();return e.endsWith(lr)||(e+=lr),e+=this.type(),new Z(e)}parent(){let e=this.list();return e.length===1?new Z(lr):new Z(e.slice(0,-1).join(lr))}child(e){return this.toString()===lr?e:e.toString()===lr?this:new Z(this.toString()+e.toString(),!1)}isAncestorOf(e){return e.toString()===this.toString()?!1:e.toString().startsWith(this.toString())}isDecendantOf(e){return e.toString()===this.toString()?!1:this.toString().startsWith(e.toString())}isTopLevel(){return this.list().length===1}concat(...e){return Z.withNamespaces([...this.namespaces(),...wS(e.map(t=>t.namespaces()))])}};function mS(e){let t=e.split(":");return t.length<2?"":t.slice(0,-1).join(":")}function gS(e){let t=e.split(":");return t[t.length-1]}function wS(e){return[].concat(...e)}a();var d0="SHARDING",p0="_README";a();a();var m0=x(is(),1),dc=(e,t)=>async function*(){yield*(await(0,m0.default)(e)).sort(t)}(),Hl=x(Nn(),1),Un=x(Rn(),1),Gl=x(os(),1),It=class{open(){return Promise.reject(new Error(".open is not implemented"))}close(){return Promise.reject(new Error(".close is not implemented"))}put(e,t,r){return Promise.reject(new Error(".put is not implemented"))}get(e,t){return Promise.reject(new Error(".get is not implemented"))}has(e,t){return Promise.reject(new Error(".has is not implemented"))}delete(e,t){return Promise.reject(new Error(".delete is not implemented"))}async*putMany(e,t={}){for await(let{key:r,value:n}of e)await this.put(r,n,t),yield{key:r,value:n}}async*getMany(e,t={}){for await(let r of e)yield this.get(r,t)}async*deleteMany(e,t={}){for await(let r of e)await this.delete(r,t),yield r}batch(){let e=[],t=[];return{put(r,n){e.push({key:r,value:n})},delete(r){t.push(r)},commit:async r=>{await(0,Hl.default)(this.putMany(e,r)),e=[],await(0,Hl.default)(this.deleteMany(t,r)),t=[]}}}async*_all(e,t){throw new Error("._all is not implemented")}async*_allKeys(e,t){throw new Error("._allKeys is not implemented")}query(e,t){let r=this._all(e,t);if(e.prefix!=null&&(r=(0,Un.default)(r,n=>n.key.toString().startsWith(e.prefix))),Array.isArray(e.filters)&&(r=e.filters.reduce((n,i)=>(0,Un.default)(n,i),r)),Array.isArray(e.orders)&&(r=e.orders.reduce((n,i)=>dc(n,i),r)),e.offset!=null){let n=0;r=(0,Un.default)(r,()=>n++>=e.offset)}return e.limit!=null&&(r=(0,Gl.default)(r,e.limit)),r}queryKeys(e,t){let r=this._allKeys(e,t);if(e.prefix!=null&&(r=(0,Un.default)(r,n=>n.toString().startsWith(e.prefix))),Array.isArray(e.filters)&&(r=e.filters.reduce((n,i)=>(0,Un.default)(n,i),r)),Array.isArray(e.orders)&&(r=e.orders.reduce((n,i)=>dc(n,i),r)),e.offset!=null){let n=0;r=(0,Un.default)(r,()=>n++>=e.offset)}return e.limit!=null&&(r=(0,Gl.default)(r,e.limit)),r}};a();var Qr=class extends It{constructor(){super(),this.data={}}open(){return Promise.resolve()}close(){return Promise.resolve()}async put(e,t){this.data[e.toString()]=t}async get(e){if(!await this.has(e))throw qt();return this.data[e.toString()]}async has(e){return this.data[e.toString()]!==void 0}async delete(e){delete this.data[e.toString()]}async*_all(){yield*Object.entries(this.data).map(([e,t])=>({key:new Z(e),value:t}))}async*_allKeys(){yield*Object.entries(this.data).map(([e])=>new Z(e))}};a();x(ji(),1);a();a();new Z(d0);new Z(p0);a();x(Rn(),1);x(os(),1);x(cc(),1);a();a();var Wt=x(at(),1);Le();xe();Ao();Wt.default.formatters.b=e=>e==null?"undefined":z.baseEncode(e);Wt.default.formatters.t=e=>e==null?"undefined":C.baseEncode(e);Wt.default.formatters.m=e=>e==null?"undefined":So.baseEncode(e);Wt.default.formatters.p=e=>e==null?"undefined":e.toString();Wt.default.formatters.c=e=>e==null?"undefined":e.toString();Wt.default.formatters.k=e=>e==null?"undefined":e.toString();function b0(e){return Object.assign((0,Wt.default)(e),{error:(0,Wt.default)(`${e}:error`),trace:(0,Wt.default)(`${e}:trace`)})}a();a();x(Nn(),1);b0("datastore:core:tiered");a();var As=x(Rn(),1),PE=x(ji(),1),Mh=x(os(),1),jh=x(x0(),1),FE=x(NE(),1),an=class extends It{constructor(e,t={}){super(),this.db=typeof e=="string"?new FE.Level(e,{...t,keyEncoding:"utf8",valueEncoding:"view"}):e,this.opts={createIfMissing:!0,compression:!1,...t}}async open(){try{await this.db.open(this.opts)}catch(e){throw ft.dbOpenFailedError(e)}}async put(e,t){try{await this.db.put(e.toString(),t)}catch(r){throw ft.dbWriteFailedError(r)}}async get(e){let t;try{t=await this.db.get(e.toString())}catch(r){throw r.notFound?ft.notFoundError(r):ft.dbWriteFailedError(r)}return t}async has(e){try{await this.db.get(e.toString())}catch(t){if(t.notFound)return!1;throw t}return!0}async delete(e){try{await this.db.del(e.toString())}catch(t){throw ft.dbDeleteFailedError(t)}}close(){return this.db&&this.db.close()}batch(){let e=[];return{put:(t,r)=>{e.push({type:"put",key:t.toString(),value:r})},delete:t=>{e.push({type:"del",key:t.toString()})},commit:()=>this.db.batch(e)}}query(e){let t=this._query({values:!0,prefix:e.prefix});Array.isArray(e.filters)&&(t=e.filters.reduce((i,o)=>(0,As.default)(i,o),t)),Array.isArray(e.orders)&&(t=e.orders.reduce((i,o)=>(0,jh.default)(i,o),t));let{offset:r,limit:n}=e;if(r){let i=0;t=(0,As.default)(t,()=>i++>=r)}return n&&(t=(0,Mh.default)(t,n)),t}queryKeys(e){let t=(0,PE.default)(this._query({values:!1,prefix:e.prefix}),({key:i})=>i);Array.isArray(e.filters)&&(t=e.filters.reduce((i,o)=>(0,As.default)(i,o),t)),Array.isArray(e.orders)&&(t=e.orders.reduce((i,o)=>(0,jh.default)(i,o),t));let{offset:r,limit:n}=e;if(r){let i=0;t=(0,As.default)(t,()=>i++>=r)}return n&&(t=(0,Mh.default)(t,n)),t}_query(e){let t={keys:!0,keyEncoding:"buffer",values:e.values};if(e.prefix!=null){let n=e.prefix.toString();t.gte=n,t.lt=n+"\xFF"}let r=this.db.iterator(t);if(r[Symbol.asyncIterator])return N3(r);if(r.next!=null&&r.end!=null)return P3(r);throw new Error("Level returned incompatible iterator")}};async function*N3(e){for await(let[t,r]of e)yield{key:new ye(t,!1),value:r};await e.close()}function P3(e){return{[Symbol.asyncIterator](){return{next:()=>new Promise((t,r)=>{e.next((n,i,o)=>{if(n)return r(n);if(i==null)return e.end(u=>{if(u)return r(u);t({done:!0,value:void 0})});t({done:!1,value:{key:new ye(i,!1),value:o}})})}),return:()=>new Promise((t,r)=>{e.end(n=>{if(n)return r(n);t({done:!0,value:void 0})})})}}}}a();var Kh=x(Nn(),1);a();a();var jc=class{constructor(e){if(!(e>0)||(e-1&e)!==0)throw new Error("Max size for a FixedFIFO should be a power of two");this.buffer=new Array(e),this.mask=e-1,this.top=0,this.btm=0,this.next=null}push(e){return this.buffer[this.top]!==void 0?!1:(this.buffer[this.top]=e,this.top=this.top+1&this.mask,!0)}shift(){let e=this.buffer[this.btm];if(e!==void 0)return this.buffer[this.btm]=void 0,this.btm=this.btm+1&this.mask,e}isEmpty(){return this.buffer[this.btm]===void 0}},to=class{constructor(e={}){var t;this.hwm=(t=e.splitLimit)!=null?t:16,this.head=new jc(this.hwm),this.tail=this.head,this.size=0}calculateSize(e){return(e==null?void 0:e.byteLength)!=null?e.byteLength:1}push(e){if((e==null?void 0:e.value)!=null&&(this.size+=this.calculateSize(e.value)),!this.head.push(e)){let t=this.head;this.head=t.next=new jc(2*this.head.buffer.length),this.head.push(e)}}shift(){let e=this.tail.shift();if(e===void 0&&this.tail.next!=null){let t=this.tail.next;this.tail.next=null,this.tail=t,e=this.tail.shift()}return(e==null?void 0:e.value)!=null&&(this.size-=this.calculateSize(e.value)),e}isEmpty(){return this.head.isEmpty()}};function zh(e={}){return F3(t=>{let r=t.shift();if(r==null)return{done:!0};if(r.error!=null)throw r.error;return{done:r.done===!0,value:r.value}},e)}function F3(e,t){t=t!=null?t:{};let r=t.onEnd,n=new to,i,o,u,s=async()=>n.isEmpty()?u?{done:!0}:await new Promise((g,m)=>{o=B=>{o=null,n.push(B);try{g(e(n))}catch(O){m(O)}return i}}):e(n),c=g=>o!=null?o(g):(n.push(g),i),h=g=>(n=new to,o!=null?o({error:g}):(n.push({error:g}),i)),y=g=>{if(u)return i;if((t==null?void 0:t.objectMode)!==!0&&(g==null?void 0:g.byteLength)==null)throw new Error("objectMode was not true but tried to push non-Uint8Array value");return c({done:!1,value:g})},w=g=>u?i:(u=!0,g!=null?h(g):c({done:!0})),S=()=>(n=new to,w(),{done:!0}),d=g=>(w(g),{done:!0});if(i={[Symbol.asyncIterator](){return this},next:s,return:S,throw:d,push:y,end:w,get readableLength(){return n.size}},r==null)return i;let k=i;return i={[Symbol.asyncIterator](){return this},next(){return k.next()},throw(g){return k.throw(g),r!=null&&(r(g),r=void 0),{done:!0}},return(){return k.return(),r!=null&&(r(),r=void 0),{done:!0}},push:y,end(g){return k.end(g),r!=null&&(r(g),r=void 0),i},get readableLength(){return k.readableLength}},i}a();W();we();var br="/",UE=new TextEncoder().encode(br),zc=UE[0],Ae=class{constructor(e,t){if(typeof e=="string")this._buf=N(e);else if(e instanceof Uint8Array)this._buf=e;else throw new Error("Invalid key, should be String of Uint8Array");if(t==null&&(t=!0),t&&this.clean(),this._buf.byteLength===0||this._buf[0]!==zc)throw new Error("Invalid key")}toString(e="utf8"){return A(this._buf,e)}uint8Array(){return this._buf}get[Symbol.toStringTag](){return`Key(${this.toString()})`}static withNamespaces(e){return new Ae(e.join(br))}static random(){return new Ae(ct().replace(/-/g,""))}static asKey(e){return e instanceof Uint8Array||typeof e=="string"?new Ae(e):typeof e.uint8Array=="function"?new Ae(e.uint8Array()):null}clean(){if((this._buf==null||this._buf.byteLength===0)&&(this._buf=UE),this._buf[0]!==zc){let e=new Uint8Array(this._buf.byteLength+1);e.fill(zc,0,1),e.set(this._buf,1),this._buf=e}for(;this._buf.byteLength>1&&this._buf[this._buf.byteLength-1]===zc;)this._buf=this._buf.subarray(0,-1)}less(e){let t=this.list(),r=e.list();for(let n=0;n<t.length;n++){if(r.length<n+1)return!1;let i=t[n],o=r[n];if(i<o)return!0;if(i>o)return!1}return t.length<r.length}reverse(){return Ae.withNamespaces(this.list().slice().reverse())}namespaces(){return this.list()}baseNamespace(){let e=this.namespaces();return e[e.length-1]}list(){return this.toString().split(br).slice(1)}type(){return U3(this.baseNamespace())}name(){return $3(this.baseNamespace())}instance(e){return new Ae(this.toString()+":"+e)}path(){let e=this.parent().toString();return e.endsWith(br)||(e+=br),e+=this.type(),new Ae(e)}parent(){let e=this.list();return e.length===1?new Ae(br):new Ae(e.slice(0,-1).join(br))}child(e){return this.toString()===br?e:e.toString()===br?this:new Ae(this.toString()+e.toString(),!1)}isAncestorOf(e){return e.toString()===this.toString()?!1:e.toString().startsWith(this.toString())}isDecendantOf(e){return e.toString()===this.toString()?!1:this.toString().startsWith(e.toString())}isTopLevel(){return this.list().length===1}concat(...e){return Ae.withNamespaces([...this.namespaces(),...M3(e.map(t=>t.namespaces()))])}};function U3(e){let t=e.split(":");return t.length<2?"":t.slice(0,-1).join(":")}function $3(e){let t=e.split(":");return t[t.length-1]}function M3(e){return[].concat(...e)}q();ir();Ee();xe();Le();var jE=x(ve(),1);a();var qh=x(Nn(),1),Zn=x(Rn(),1),Vh=x(os(),1),ME=x(is(),1),$E=(e,t)=>async function*(){yield*(await(0,ME.default)(e)).sort(t)}(),ro=class{open(){return Promise.reject(new Error(".open is not implemented"))}close(){return Promise.reject(new Error(".close is not implemented"))}put(e,t,r){return Promise.reject(new Error(".put is not implemented"))}get(e,t){return Promise.reject(new Error(".get is not implemented"))}has(e,t){return Promise.reject(new Error(".has is not implemented"))}delete(e,t){return Promise.reject(new Error(".delete is not implemented"))}async*putMany(e,t={}){for await(let{key:r,value:n}of e)await this.put(r,n,t),yield{key:r,value:n}}async*getMany(e,t={}){for await(let r of e)yield this.get(r,t)}async*deleteMany(e,t={}){for await(let r of e)await this.delete(r,t),yield r}batch(){let e=[],t=[];return{put(r,n){e.push({key:r,value:n})},delete(r){t.push(r)},commit:async r=>{await(0,qh.default)(this.putMany(e,r)),e=[],await(0,qh.default)(this.deleteMany(t,r)),t=[]}}}async*_all(e,t){throw new Error("._all is not implemented")}async*_allKeys(e,t){throw new Error("._allKeys is not implemented")}query(e,t){let r=this._all(e,t);if(e.prefix!=null&&(r=(0,Zn.default)(r,n=>n.key.toString().startsWith(e.prefix||""))),Array.isArray(e.filters)&&(r=e.filters.reduce((n,i)=>(0,Zn.default)(n,i),r)),Array.isArray(e.orders)&&(r=e.orders.reduce((n,i)=>$E(n,i),r)),e.offset!=null){let n=0;r=(0,Zn.default)(r,()=>n++>=(e.offset||0))}return e.limit!=null&&(r=(0,Vh.default)(r,e.limit)),r}queryKeys(e,t){let r=this._allKeys(e,t);if(e.prefix!=null&&(r=(0,Zn.default)(r,n=>n.toString().startsWith(e.prefix||""))),Array.isArray(e.filters)&&(r=e.filters.reduce((n,i)=>(0,Zn.default)(n,i),r)),Array.isArray(e.orders)&&(r=e.orders.reduce((n,i)=>$E(n,i),r)),e.offset!=null){let n=0;r=(0,Zn.default)(r,()=>n++>=e.offset)}return e.limit!=null&&(r=(0,Vh.default)(r,e.limit)),r}};function no(e){let t=E.asCID(e);if(!t)throw(0,jE.default)(new Error("Not a valid cid"),"ERR_INVALID_CID");return new Ae("/"+C.encode(t.multihash.bytes).slice(1).toUpperCase(),!1)}function cn(e){return E.createV1(ot,G(C.decode("b"+e.toString().slice(1).toLowerCase())))}function Wh(e){let t=e.substring(0,1);if(t==="/")return Wh(e.substring(1));let r;t.toLowerCase()==="b"?r=o=>C.decode(o.toLowerCase()).subarray(2):t.toLowerCase()==="c"?r=o=>Ku.decode(o.toLowerCase()).subarray(2):t==="z"?r=o=>z.decode(o).subarray(2):t==="Q"?r=o=>z.decode("z"+o):r=o=>C.decode("b"+o.toLowerCase()).subarray(2);let n;for(let o=1;o<e.length;o++)try{n=r(e.substring(0,o))}catch(u){if(u.message!=="Unexpected end of data")throw u}let i="/C";return n&&(i=`/${C.encode(n).slice(1,-1).toUpperCase()||"C"}`),i}function j3(e){return{...e,prefix:e.prefix?Wh(e.prefix):void 0,filters:e.filters?e.filters.map(t=>r=>t({key:cn(r.key),value:r.value})):void 0,orders:e.orders?e.orders.map(t=>(r,n)=>t({key:cn(r.key),value:r.value},{key:cn(n.key),value:n.value})):void 0}}function z3(e){return{...e,prefix:e.prefix?Wh(e.prefix):void 0,filters:e.filters?e.filters.map(t=>r=>t(cn(r))):void 0,orders:e.orders?e.orders.map(t=>(r,n)=>t(cn(r),cn(n))):void 0}}var qc=class extends ro{constructor(e){super(),this.child=e}open(){return this.child.open()}close(){return this.child.close()}async*query(e,t){for await(let{key:r,value:n}of this.child.query(j3(e),t))yield{key:cn(r),value:n}}async*queryKeys(e,t){for await(let r of this.child.queryKeys(z3(e),t))yield cn(r)}async get(e,t){return this.child.get(no(e),t)}async*getMany(e,t){for await(let r of e)yield this.get(r,t)}async put(e,t,r){await this.child.put(no(e),t,r)}async*putMany(e,t){let r=zh({objectMode:!0});(globalThis.process&&globalThis.process.nextTick?globalThis.process.nextTick:globalThis.setImmediate||globalThis.setTimeout)(async()=>{try{let n=this.child;await(0,Kh.default)(this.child.putMany(async function*(){for await(let i of e){let o=no(i.key);await n.has(o,t)||(yield{key:o,value:i.value}),r.push(i)}}())),r.end()}catch(n){r.end(n)}}),yield*r}has(e,t){return this.child.has(no(e),t)}delete(e,t){return this.child.delete(no(e),t)}deleteMany(e,t){let r=zh({objectMode:!0});return(0,Kh.default)(this.child.deleteMany(async function*(){for await(let n of e)yield no(n),r.push(n);r.end()}(),t)).catch(n=>{r.end(n)}),r}};function zE(e,t,r){let n=r.path||"ipfs";return fc(n,i=>t.getCodec(i),{root:new an(n,{prefix:"",version:2}),blocks:new qc(new an(`${n}/blocks`,{prefix:"",version:2})),datastore:new an(`${n}/datastore`,{prefix:"",version:2}),keys:new an(`${n}/keys`,{prefix:"",version:2}),pins:new an(`${n}/pins`,{prefix:"",version:2})},{autoMigrate:r.autoMigrate,onMigrationProgress:r.onMigrationProgress||e,repoLock:oc})}a();a();q();a();var ex=x(JE(),1),tx=x(YE(),1);a();var K3=/(-?(?:\d+\.?\d*|\d*\.?\d+)(?:e[-+]?\d+)?)\s*([\p{L}]*)/uig;L.nanosecond=L.ns=1/1e6;L.\u00B5s=L.\u03BCs=L.us=L.microsecond=1/1e3;L.millisecond=L.ms=L[""]=1;L.second=L.sec=L.s=L.ms*1e3;L.minute=L.min=L.m=L.s*60;L.hour=L.hr=L.h=L.m*60;L.day=L.d=L.h*24;L.week=L.wk=L.w=L.d*7;L.month=L.b=L.d*(365.25/12);L.year=L.yr=L.y=L.d*365.25;function L(e="",t="ms"){var r=null;return e=(e+"").replace(/(\d)[,_](\d)/g,"$1$2"),e.replace(K3,function(n,i,o){o=XE(o),o&&(r=(r||0)+parseFloat(i,10)*o)}),r&&r/(XE(t)||1)}function XE(e){return L[e]||L[e.toLowerCase().replace(/s$/,"")]}var ZE=L;a();var Er=class extends Error{constructor(e="request timed out"){super(e),this.name="TimeoutError",this.code=Er.code}};Er.code="ERR_TIMEOUT";function yt(e,t){return(...r)=>{let n=r[t!=null?t:r.length-1];if(!n||!n.timeout)return e(...r);let i=typeof n.timeout=="string"?ZE(n.timeout):n.timeout,o=new ex.TimeoutController(i);n.signal=(0,tx.anySignal)([n.signal,o.signal]);let u=e(...r),s=new Promise((y,w)=>{o.signal.addEventListener("abort",()=>{w(new Er)})}),c=Date.now(),h=()=>{if(o.signal.aborted)throw new Er;if(Date.now()-c>i)throw o.abort(),new Er};return u[Symbol.asyncIterator]?async function*(){let y=u[Symbol.asyncIterator]();try{for(;;){let{value:w,done:S}=await Promise.race([y.next(),s]);if(S)break;h(),yield w}}catch(w){throw h(),w}finally{o.clear(),y.return&&y.return()}}():(async()=>{try{let y=await Promise.race([u,s]);return h(),y}catch(y){throw h(),y}finally{o.clear()}})()}}a();var Qt=x(at(),1);Le();xe();Ao();Qt.default.formatters.b=e=>e==null?"undefined":z.baseEncode(e);Qt.default.formatters.t=e=>e==null?"undefined":C.baseEncode(e);Qt.default.formatters.m=e=>e==null?"undefined":So.baseEncode(e);Qt.default.formatters.p=e=>e==null?"undefined":e.toString();Qt.default.formatters.c=e=>e==null?"undefined":e.toString();Qt.default.formatters.k=e=>e==null?"undefined":e.toString();function Kc(e){return Object.assign((0,Qt.default)(e),{error:(0,Qt.default)(`${e}:error`),trace:(0,Qt.default)(`${e}:trace`)})}ir();gf();a();Le();var Jh=async({cid:e,load:t,seen:r})=>{r=r||new Set;let n=e.toString(z);if(r.has(n))return;let i=await t(e);if(r.add(n),i!==null)for(let[,o]of i.links())await Jh({cid:o,load:t,seen:r})},rx=Kc("ipfs:components:dag:import"),W3=[ot,mf];function nx({repo:e,preload:t,codecs:r}){async function*n(i,o={}){o.preload!==!1&&t(i);let u=E.asCID(i);if(!u)throw new Error(`Unexpected error converting CID type: ${i}`);rx(`Exporting ${u} as car`);let{writer:s,out:c}=await Rr.create([u]),h=null;(async()=>{try{let y=H3(e,s,{signal:o.signal,timeout:o.timeout},r);await Jh({cid:u,load:y})}catch(y){h=y}finally{s.close()}})();for await(let y of c){if(h)break;yield y}if(h)throw h}return yt(n)}function H3(e,t,r,n){return async i=>{let o=await n.getCodec(i.code);if(!o)throw new Error(`Can't decode links in block with codec 0x${i.code.toString(16)} to form complete DAG`);let u=await e.blocks.get(i,r);return rx(`Adding block ${i} to car`),await t.put({cid:i,bytes:u}),W3.includes(i.code)?null:En({bytes:u,cid:i,codec:o})}}a();var Xx=x(Al(),1),Zx=x(ox(),1);a();a();Le();xe();Ee();a();a();a();a();a();a();a();a();a();a();a();W();a();var Cs={},rd={},rA=[[4,32,"ip4"],[6,16,"tcp"],[33,16,"dccp"],[41,128,"ip6"],[42,-1,"ip6zone"],[53,-1,"dns",!0],[54,-1,"dns4",!0],[55,-1,"dns6",!0],[56,-1,"dnsaddr",!0],[132,16,"sctp"],[273,16,"udp"],[275,0,"p2p-webrtc-star"],[276,0,"p2p-webrtc-direct"],[277,0,"p2p-stardust"],[280,0,"webrtc"],[290,0,"p2p-circuit"],[301,0,"udt"],[302,0,"utp"],[400,-1,"unix",!1,!0],[421,-1,"ipfs"],[421,-1,"p2p"],[443,0,"https"],[444,96,"onion"],[445,296,"onion3"],[446,-1,"garlic64"],[460,0,"quic"],[465,0,"webtransport"],[466,-1,"certhash"],[477,0,"ws"],[478,0,"wss"],[479,0,"p2p-websocket-star"],[480,0,"http"],[777,-1,"memory"]];rA.forEach(e=>{let t=nA(...e);rd[t.code]=t,Cs[t.name]=t});function nA(e,t,r,n,i){return{code:e,size:t,name:r,resolvable:Boolean(n),path:Boolean(i)}}function ue(e){if(typeof e=="number"){if(rd[e]!=null)return rd[e];throw new Error(`no protocol with code: ${e}`)}else if(typeof e=="string"){if(Cs[e]!=null)return Cs[e];throw new Error(`no protocol with name: ${e}`)}throw new Error(`invalid protocol id type: ${typeof e}`)}q();xe();Le();To();Ee();x(ke(),1);W();we();$r();var nd=Object.values(_n).map(e=>e.decoder);(function(){let e=nd[0].or(nd[1]);return nd.slice(2).forEach(t=>e=e.or(t)),e})();x(ke(),1);$r();W();x(ke(),1);q();Le();x(ve(),1);W();Ma();ue("dns").code,ue("dns4").code,ue("dns6").code,ue("dnsaddr").code;ue("p2p").code,ue("ipfs").code;a();a();a();a();a();W();a();var Is={},hd={},AA=[[4,32,"ip4"],[6,16,"tcp"],[33,16,"dccp"],[41,128,"ip6"],[42,-1,"ip6zone"],[53,-1,"dns",!0],[54,-1,"dns4",!0],[55,-1,"dns6",!0],[56,-1,"dnsaddr",!0],[132,16,"sctp"],[273,16,"udp"],[275,0,"p2p-webrtc-star"],[276,0,"p2p-webrtc-direct"],[277,0,"p2p-stardust"],[280,0,"webrtc"],[290,0,"p2p-circuit"],[301,0,"udt"],[302,0,"utp"],[400,-1,"unix",!1,!0],[421,-1,"ipfs"],[421,-1,"p2p"],[443,0,"https"],[444,96,"onion"],[445,296,"onion3"],[446,-1,"garlic64"],[460,0,"quic"],[465,0,"webtransport"],[466,-1,"certhash"],[477,0,"ws"],[478,0,"wss"],[479,0,"p2p-websocket-star"],[480,0,"http"],[777,-1,"memory"]];AA.forEach(e=>{let t=TA(...e);hd[t.code]=t,Is[t.name]=t});function TA(e,t,r,n,i){return{code:e,size:t,name:r,resolvable:Boolean(n),path:Boolean(i)}}function fe(e){if(typeof e=="number"){if(hd[e]!=null)return hd[e];throw new Error(`no protocol with code: ${e}`)}else if(typeof e=="string"){if(Is[e]!=null)return Is[e];throw new Error(`no protocol with name: ${e}`)}throw new Error(`invalid protocol id type: ${typeof e}`)}q();xe();Le();To();Ee();x(ke(),1);W();we();$r();var dd=Object.values(_n).map(e=>e.decoder);(function(){let e=dd[0].or(dd[1]);return dd.slice(2).forEach(t=>e=e.or(t)),e})();x(ke(),1);$r();W();x(ke(),1);q();Le();x(ve(),1);W();Ma();fe("dns").code,fe("dns4").code,fe("dns6").code,fe("dnsaddr").code;fe("p2p").code,fe("ipfs").code;q();x(Gx(),1);W();q();a();W();we();var vr="/",Jx=new TextEncoder().encode(vr),iu=Jx[0],Ce=class{constructor(e,t){if(typeof e=="string")this._buf=N(e);else if(e instanceof Uint8Array)this._buf=e;else throw new Error("Invalid key, should be String of Uint8Array");if(t==null&&(t=!0),t&&this.clean(),this._buf.byteLength===0||this._buf[0]!==iu)throw new Error("Invalid key")}toString(e="utf8"){return A(this._buf,e)}uint8Array(){return this._buf}get[Symbol.toStringTag](){return`Key(${this.toString()})`}static withNamespaces(e){return new Ce(e.join(vr))}static random(){return new Ce(ct().replace(/-/g,""))}static asKey(e){return e instanceof Uint8Array||typeof e=="string"?new Ce(e):typeof e.uint8Array=="function"?new Ce(e.uint8Array()):null}clean(){if((this._buf==null||this._buf.byteLength===0)&&(this._buf=Jx),this._buf[0]!==iu){let e=new Uint8Array(this._buf.byteLength+1);e.fill(iu,0,1),e.set(this._buf,1),this._buf=e}for(;this._buf.byteLength>1&&this._buf[this._buf.byteLength-1]===iu;)this._buf=this._buf.subarray(0,-1)}less(e){let t=this.list(),r=e.list();for(let n=0;n<t.length;n++){if(r.length<n+1)return!1;let i=t[n],o=r[n];if(i<o)return!0;if(i>o)return!1}return t.length<r.length}reverse(){return Ce.withNamespaces(this.list().slice().reverse())}namespaces(){return this.list()}baseNamespace(){let e=this.namespaces();return e[e.length-1]}list(){return this.toString().split(vr).slice(1)}type(){return hT(this.baseNamespace())}name(){return dT(this.baseNamespace())}instance(e){return new Ce(this.toString()+":"+e)}path(){let e=this.parent().toString();return e.endsWith(vr)||(e+=vr),e+=this.type(),new Ce(e)}parent(){let e=this.list();return e.length===1?new Ce(vr):new Ce(e.slice(0,-1).join(vr))}child(e){return this.toString()===vr?e:e.toString()===vr?this:new Ce(this.toString()+e.toString(),!1)}isAncestorOf(e){return e.toString()===this.toString()?!1:e.toString().startsWith(this.toString())}isDecendantOf(e){return e.toString()===this.toString()?!1:this.toString().startsWith(e.toString())}isTopLevel(){return this.list().length===1}concat(...e){return Ce.withNamespaces([...this.namespaces(),...pT(e.map(t=>t.namespaces()))])}};function hT(e){let t=e.split(":");return t.length<2?"":t.slice(0,-1).join(":")}function dT(e){let t=e.split(":");return t[t.length-1]}function pT(e){return[].concat(...e)}var Td=x(ve(),1);a();q();var Ad=x(ve(),1),Qx="/ipfs/";function ou(e){if(e instanceof Uint8Array)try{e=E.decode(e)}catch(i){throw(0,Ad.default)(i,"ERR_INVALID_CID")}let t=E.asCID(e);if(t)return{cid:t,path:void 0};e=e.toString(),e.startsWith(Qx)&&(e=e.substring(Qx.length));let r=e.split("/"),n;try{t=E.parse(r.shift()||"")}catch(i){throw(0,Ad.default)(i,"ERR_INVALID_CID")}return r.length&&(n=`/${r.join("/")}`),{cid:t,path:n}}new Ce("/local/filesroot");var Yx=async function(e,t,r,n={}){let{cid:i,path:o}=ou(r);o&&(n.path=o);let u=i,s=n.path||"";if(s.startsWith("/")&&(s=s.substring(1)),n.path)try{for await(let{value:c,remainderPath:h}of su(i,n.path,t,e,{signal:n.signal})){if(!E.asCID(c))break;s=h,u=c}}catch(c){throw c.message.startsWith("Object has no property")&&(c.message=`no link named "${s.split("/")[0]}" under ${u}`,c.code="ERR_NO_LINK"),c}return{cid:u,remainderPath:s||""}},su=async function*(e,t,r,n,i){let o=async h=>{let y=await r.getCodec(h.code),w=await n.blocks.get(h,i);return y.decode(w)},u=t.split("/").filter(Boolean),s=await o(e),c=e;for(;u.length;){let h=u.shift();if(!h)throw(0,Td.default)(new Error(`Could not resolve path "${t}"`),"ERR_INVALID_PATH");if(e.code===xt&&Array.isArray(s.Links)){let y=s.Links.find(w=>w.Name===h);if(y){yield{value:y.Hash,remainderPath:u.join("/")},s=await o(y.Hash),c=y.Hash;continue}}if(Object.prototype.hasOwnProperty.call(s,h))s=s[h],yield{value:s,remainderPath:u.join("/")};else throw(0,Td.default)(new Error(`no link named "${h}" under ${c}`),"ERR_NO_LINK");E.asCID(s)&&(c=s,s=await o(s))}yield{value:s,remainderPath:""}},e1=x(ve(),1);function t1({codecs:e,repo:t,preload:r}){return yt(async function(n,i={}){if(i.preload!==!1&&r(n),i.path){let s=i.localResolve?await(0,Xx.default)(su(n,i.path,e,t,i)):await(0,Zx.default)(su(n,i.path,e,t,i));if(!s)throw(0,e1.default)(new Error("Not found"),"ERR_NOT_FOUND");return s}let o=await e.getCodec(n.code),u=await t.blocks.get(n,i);return{value:o.decode(u),remainderPath:""}})}a();var i1=x(n1(),1),o1=x(Nn(),1),s1=x(ji(),1),a1=Kc("ipfs:components:dag:import");function c1({repo:e}){async function*t(r,n={}){let i=await e.gcLock.readLock();try{let o={signal:n.signal,timeout:n.timeout},u=(0,i1.default)(r),{value:s,done:c}=await u.peek();if(c)return;s&&u.push(s);let h;s instanceof Uint8Array?h=[u]:h=u;for await(let y of h){let w=await mT(e,o,y);if(n.pinRoots!==!1)for(let S of w){let d="";try{await e.blocks.has(S)?(a1(`Pinning root ${S}`),await e.pins.pinRecursively(S)):d="blockstore: block not found"}catch(k){d=k.message}yield{root:{cid:S,pinErrorMsg:d}}}}}finally{i()}}return yt(t)}async function mT(e,t,r){let n=await Lr.fromIterable(r),i=await n.getRoots();return await(0,o1.default)(e.blocks.putMany((0,s1.default)(n,({cid:o,bytes:u})=>(a1(`Import block ${o}`),{key:o,value:u})),{signal:t.signal})),i}a();q();function u1({repo:e,codecs:t,hashers:r,preload:n}){async function i(o,u={}){let s=u.pin?await e.gcLock.readLock():null;try{let c=await t.getCodec(u.storeCodec||"dag-cbor");if(!c)throw new Error(`Unknown storeCodec ${u.storeCodec}, please configure additional BlockCodecs for this IPFS instance`);if(u.inputCodec){if(!(o instanceof Uint8Array))throw new Error("Can only inputCodec on raw bytes that can be decoded");let k=await t.getCodec(u.inputCodec);if(!k)throw new Error(`Unknown inputCodec ${u.inputCodec}, please configure additional BlockCodecs for this IPFS instance`);o=k.decode(o)}let h=u.version!=null?u.version:1,y=await r.getHasher(u.hashAlg||"sha2-256");if(!y)throw new Error(`Unknown hash algorithm ${u.hashAlg}, please configure additional MultihashHashers for this IPFS instance`);let w=c.encode(o),S=await y.digest(w),d=E.create(h,c.code,S);return await e.blocks.put(d,w,{signal:u.signal}),u.pin&&await e.pins.pinRecursively(d),u.preload!==!1&&n(d),d}finally{s&&s()}}return yt(i)}a();function f1({repo:e,codecs:t,preload:r}){async function n(i,o={}){let{cid:u}=ou(i);return o.preload!==!1&&r(u),Yx(e,t,i,o)}return yt(n)}var au=class{constructor({repo:e,codecs:t,hashers:r,preload:n}){this.export=nx({repo:e,preload:n,codecs:t}),this.get=t1({codecs:t,repo:e,preload:n}),this.import=c1({repo:e}),this.resolve=f1({repo:e,codecs:t,preload:n}),this.put=u1({repo:e,codecs:t,hashers:r,preload:n})}};ir();xi();pa();To();var Cd={};H(Cd,{code:()=>DT,decode:()=>CT,encode:()=>TT,name:()=>_T,toGeneral:()=>b1});a();a();a();Ao();function Rt(e){return da.encode(e).slice(1)}function mt(e){return da.decode(`u${e}`)}q();function l1(e){let[t,r,n]=e;return{payload:r,signatures:[{protected:t,signature:n}],link:E.decode(mt(r))}}function gT(e){let t={signature:mt(e.signature)};return e.header&&(t.header=e.header),e.protected&&(t.protected=mt(e.protected)),t}function h1(e){let t=mt(e.payload);try{E.decode(t)}catch{throw new Error("Not a valid DagJWS")}return{payload:t,signatures:e.signatures.map(gT)}}function wT(e){let t={signature:Rt(e.signature)};return e.header&&(t.header=e.header),e.protected&&(t.protected=Rt(e.protected)),t}function d1(e){let t={payload:Rt(e.payload),signatures:e.signatures.map(wT)};return t.link=E.decode(new Uint8Array(e.payload)),t}a();function p1(e){let[t,r,n,i,o]=e,u={ciphertext:i,iv:n,protected:t,tag:o};return r&&(u.recipients=[{encrypted_key:r}]),u}function ET(e){let t={};return e.encrypted_key&&(t.encrypted_key=mt(e.encrypted_key)),e.header&&(t.header=e.header),t}function y1(e){let t={ciphertext:mt(e.ciphertext),protected:mt(e.protected),iv:mt(e.iv),tag:mt(e.tag)};return e.aad&&(t.aad=mt(e.aad)),e.recipients&&(t.recipients=e.recipients.map(ET)),e.unprotected&&(t.unprotected=e.unprotected),t}function xT(e){let t={};return e.encrypted_key&&(t.encrypted_key=Rt(e.encrypted_key)),e.header&&(t.header=e.header),t}function m1(e){let t={ciphertext:Rt(e.ciphertext),protected:Rt(e.protected),iv:Rt(e.iv),tag:Rt(e.tag)};return e.aad&&(t.aad=Rt(e.aad)),e.recipients&&(t.recipients=e.recipients.map(xT)),e.unprotected&&(t.unprotected=e.unprotected),t}var _T="dag-jose",DT=133;function g1(e){return"payload"in e&&typeof e.payload=="string"&&"signatures"in e&&Array.isArray(e.signatures)}function ST(e){return"payload"in e&&e.payload instanceof Uint8Array&&"signatures"in e&&Array.isArray(e.signatures)}function AT(e){return"ciphertext"in e&&e.ciphertext instanceof Uint8Array&&"iv"in e&&e.iv instanceof Uint8Array&&"protected"in e&&e.protected instanceof Uint8Array&&"tag"in e&&e.tag instanceof Uint8Array}function w1(e){return"ciphertext"in e&&typeof e.ciphertext=="string"&&"iv"in e&&typeof e.iv=="string"&&"protected"in e&&typeof e.protected=="string"&&"tag"in e&&typeof e.tag=="string"}function b1(e){if(typeof e=="string"){let t=e.split(".");if(t.length===3)return l1(t);if(t.length===5)return p1(t);throw new Error("Not a valid JOSE string")}if(g1(e)||w1(e))return e;throw new Error("Not a valid unencoded JOSE object")}function TT(e){typeof e=="string"&&(e=b1(e));let t;if(g1(e))t=h1(e);else if(w1(e))t=y1(e);else throw new Error("Not a valid JOSE object");return new Uint8Array(bn(t))}function CT(e){let t;try{t=xo(e)}catch{throw new Error("Not a valid DAG-JOSE object")}if(ST(t))return d1(t);if(AT(t))return m1(t);throw new Error("Not a valid DAG-JOSE object")}a();var IT=e=>Promise.reject(new Error(`No codec found for "${e}"`)),cu=class{constructor(e){this._codecsByName={},this._codecsByCode={},this._loadCodec=e.loadCodec||IT;for(let t of e.codecs)this.addCodec(t)}addCodec(e){if(this._codecsByName[e.name]||this._codecsByCode[e.code])throw new Error(`Resolver already exists for codec "${e.name}"`);this._codecsByName[e.name]=e,this._codecsByCode[e.code]=e}removeCodec(e){delete this._codecsByName[e.name],delete this._codecsByCode[e.code]}async getCodec(e){let t=typeof e=="string"?this._codecsByName:this._codecsByCode;if(t[e])return t[e];let r=await this._loadCodec(e);return t[e]==null&&this.addCodec(r),r}listCodecs(){return Object.values(this._codecsByName)}};a();var OT=e=>Promise.reject(new Error(`No hasher found for "${e}"`)),uu=class{constructor(e){this._hashersByName={},this._hashersByCode={},this._loadHasher=e.loadHasher||OT;for(let t of e.hashers)this.addHasher(t)}addHasher(e){if(this._hashersByName[e.name]||this._hashersByCode[e.code])throw new Error(`Resolver already exists for codec "${e.name}"`);this._hashersByName[e.name]=e,this._hashersByCode[e.code]=e}removeHasher(e){delete this._hashersByName[e.name],delete this._hashersByCode[e.code]}async getHasher(e){let t=typeof e=="string"?this._hashersByName:this._hashersByCode;if(t[e])return t[e];let r=await this._loadHasher(e);return t[e]==null&&this.addHasher(r),r}listHashers(){return Object.values(this._hashersByName)}};a();async function*E1(e){let t=0;for(;t<e.length;)yield e[t++]}var _1=x(is(),1);Ei();a();xe();ir();q();Ee();a();var x1=x(ve(),1);function v1(e){return e=e||new Error("Not Found"),(0,x1.default)(e,"ERR_NOT_FOUND")}var fu=class extends ro{constructor(){super(),this.data={}}open(){return Promise.resolve()}close(){return Promise.resolve()}async put(e,t){this.data[C.encode(e.multihash.bytes)]=t}async get(e){if(!await this.has(e))throw v1();return this.data[C.encode(e.multihash.bytes)]}async has(e){return this.data[C.encode(e.multihash.bytes)]!==void 0}async delete(e){delete this.data[C.encode(e.multihash.bytes)]}async*_all(){yield*Object.entries(this.data).map(([e,t])=>({key:E.createV1(ot,G(C.decode(e))),value:t}))}async*_allKeys(){yield*Object.entries(this.data).map(([e])=>E.createV1(ot,G(C.decode(e))))}},Id=class extends au{constructor({repo:e,codecs:t,options:r}){let n=Object.values(cm);(r.ipld&&r.ipld.hashers?r.ipld.hashers:[]).forEach(o=>n.push(o));let i=new uu({hashers:n,loadHasher:r.ipld&&r.ipld.loadHasher});super({repo:e,codecs:t,hashers:i,preload:o=>{}}),Object.assign(this,fa()),this.repo=e,this.rootCID,this.tx={pending:xn.create(),checkSize:async o=>{let u=xn.create();return await u.add(o),u.size},getExistingTx:async()=>{let o={};try{let u=this.tx.pending.last;if(!u)return;o=(await this.tx.pending.get(u)).value}catch{}return o},addData:async o=>await this.tx.pending.add(o),addTag:async(o,u)=>await this.tx.add(o,u),add:async(o,u)=>{if(!u)return;u=Object.fromEntries(Object.entries(u).map(([S,d])=>d===void 0?[S,null]:[S,d]));let s=!1,c=await this.tx.getExistingTx();if(c&&c[o])s=c[o]?c[o]:!1;else if(this.rootCID)try{let S=(await this.get(this.rootCID)).value;s=S[o]?S[o]:!1}catch{}let h=await this.tx.pending.add(u),y=Object.assign({},c,{[o]:{obj:h,prev:s}}),w=await this.tx.pending.add(y);return this.emit("added",w),w},commit:async()=>{let o=await this.tx.getExistingTx(),u={};try{this.rootCID&&(u=(await this.get(this.rootCID)).value)}catch(h){console.log({error:h})}let s=Object.assign({},u,Object.fromEntries(Object.entries(o).filter(([h,y])=>y.obj&&y.hasOwnProperty("prev"))));this.rootCID=await this.tx.pending.add(s);let c=await this.tx.pending.commit();return await this.importBuffer(c),this.tx.pending=xn.create(),c}}}async latest(e){return(await this.get(this.rootCID,{path:`/${e}/obj`})).value}async importBuffers(e){let t;for(let r of e)t=await this.importBuffer(r);return t}async importBuffer(e){return D1(this,e)}};async function D1(e,t){let r=await E1([t]),[{root:n}]=await(0,_1.default)(e.import(r));return n.cid}async function kT(e={}){let t={name:Si.name,code:Si.code,encode:c=>c,decode:c=>c},r=Object.values(um);[Ir,Cd,t].concat(e.ipld&&e.ipld.codecs||[]).forEach(c=>r.push(c));let n=new cu({codecs:r,loadCodec:e.ipld&&e.ipld.loadCodec}),i=e.path||"ipfs",o;e!=null&&e.persist?o=zE(console.log,n,{path:i,autoMigrate:!0}):o=fc(i,c=>n.getCodec(c),{blocks:new fu,datastore:new Qr,root:new Qr,keys:new Qr,pins:new Qr},e);let u={};try{await o.init(u),await o.open()}catch(c){throw c}let s=await o.config.getAll();return new Id({repo:o,codecs:n,options:{...e,repoConfig:s}})}/*!
* The buffer module from node.js, for the browser.
*
* @author   Feross Aboukhadijeh <https://feross.org>
* @license  MIT
*//*!
 * bytes
 * Copyright(c) 2012-2014 TJ Holowaychuk
 * Copyright(c) 2015 Jed Watson
 * MIT Licensed
 *//*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> *//*! queue-microtask. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> *//*! run-parallel-limit. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */export{xn as Transaction,kT as createDagRepo,Ky as encode,D1 as importBuffer};
